{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/joseph/Code/lomav2/src/App.js\";\nimport React from 'react';\nimport \"tailwindcss/tailwind.css\";\nimport { SearchBar } from './Components/SearchBar';\nimport { Results } from './Components/Results';\nimport { Landing } from './Components/Landing';\nimport { LoadingPop } from './Components/LoadingPop';\nimport { PopUpListing } from './Components/PopUpListing';\nimport imagePlaceholder from './assets/gallery.png';\nimport { hotjar } from 'react-hotjar';\nconst appLoaded = Date.now();\n\nfunction getEbayAccessToken() {\n  if (Date.now() > this.state.ExpiryDate) {\n    console.log(\"this app does not have an access token, getting access token\");\n    var myHeaders = new Headers();\n    myHeaders.append(\"Authorization\", \"Basic Sm9zZXBoVW4tTG9tYS1QUkQtMTk5YWQwZDkwLWY0Y2QyYjg4OlBSRC05OWFkMGQ5MDRiYjEtZjYzMS00OGMyLTkwNTQtYTQ5Yg==\");\n    myHeaders.append(\"Content-Type\", \"application/x-www-form-urlencoded\");\n    myHeaders.append(\"Cookie\", \"ebay=%5Esbf%3D%23%5E; dp1=bu1p/QEBfX0BAX19AQA**6379634c^\");\n    var urlencoded = new URLSearchParams();\n    urlencoded.append(\"grant_type\", \"client_credentials\");\n    urlencoded.append(\"scope\", \"https://api.ebay.com/oauth/api_scope\");\n    var requestOptions = {\n      method: 'POST',\n      headers: myHeaders,\n      body: urlencoded,\n      redirect: 'follow'\n    };\n    fetch(\"https://loma-cors.herokuapp.com/https://api.ebay.com/identity/v1/oauth2/token\", requestOptions).then(response => response.json()).then(jsonresponse => {\n      this.setState({\n        AccessToken: jsonresponse.access_token,\n        ExpiryDate: Date.now() + jsonresponse.expires_in * 1000\n      });\n      let accessTokenSet = Date.now() - appLoaded;\n      console.log(`apiAccessToken = ${this.state.AccessToken}, took ${accessTokenSet} milliseconds`);\n    }).catch(error => console.log('error', error));\n  }\n}\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      Data: [],\n      AccessToken: \"none\",\n      ExpiryDate: 0,\n      resultsDisplay: \"⚡️ Trending ⚡️\",\n      searchTerm: \"\",\n      loading: false,\n      landing: true,\n      popUpListing: {\n        display: false,\n        listing: {}\n      },\n      depopData: {\n        data: [{\n          nothing: \"none\"\n        }],\n        status: 'unresolved'\n      },\n      gumtreeData: {\n        data: [{\n          nothing: \"none\"\n        }],\n        status: 'unresolved'\n      },\n      facebookData: {\n        data: [{\n          nothing: \"none\"\n        }],\n        status: 'unresolved'\n      }\n    };\n    this.handleChange = this.handleChange.bind(this);\n    this.setData = this.setData.bind(this);\n    this.toggleDisplay = this.toggleDisplay.bind(this);\n    this.reOrderDisplay = this.reOrderDisplay.bind(this);\n    this.togglePopUp = this.togglePopUp.bind(this);\n    this.changeActiveListing = this.changeActiveListing.bind(this);\n  }\n\n  componentDidMount() {\n    const appLoaded = Date.now(); ///////DATA CLEANERS\n\n    const isNull = property => {\n      if (property === null || property === undefined) {\n        return \" \";\n      } else {\n        return property;\n      }\n    };\n\n    const facebookPriceParsed = price => {\n      let rawPrice = price.substring(1);\n\n      if (!price || price === \"FREE\") {\n        return \"0\";\n      } else if (price === \"See listings near me\") {\n        return \"~\";\n      } else if (!rawPrice.includes(\"£\")) {\n        return rawPrice;\n      } else if (rawPrice.includes(\"£\")) {\n        return rawPrice.substring(0, rawPrice.indexOf(\"£\"));\n      }\n    };\n\n    const isPriceNull = price => {\n      if (price === undefined || price === null) {\n        return \"~\";\n      } else {\n        return price.substring(1);\n      }\n    };\n\n    const missingImagesFiltered = imageProp => {\n      if (imageProp === null || imageProp === undefined) {\n        return imagePlaceholder;\n      } else {\n        return imageProp;\n      }\n    }; //\n\n\n    const getDepopData = async () => {\n      console.log(\"getting depop data\");\n      const depop_url = \"https://api.apify.com/v2/datasets/ml97NZifdmN1EFUSb/items?clean=true&format=json\";\n      const depopResponse = await fetch(depop_url);\n      const depopData = await depopResponse.json();\n      const depopDataParsed = await depopData.map(listing => {\n        return {\n          title: isNull(listing.title),\n          price: isPriceNull(listing.price),\n          description: isNull(listing.description),\n          image: isNull(missingImagesFiltered(listing.image)),\n          url: isNull(listing.url),\n          site: \"depop\"\n        };\n      });\n      this.setState({\n        depopData: {\n          data: depopDataParsed,\n          status: 'resolved'\n        }\n      });\n      let depopDataSetTime = Date.now() - appLoaded;\n      console.log(\"depop data has been set, it took this many milliseconds: \" + depopDataSetTime);\n    }; ///\n\n\n    const getGumtreeData = async () => {\n      console.log(\"getting gumtree data\");\n      const gumtree_url = \"https://api.apify.com/v2/datasets/Dh5XzAb9fvidWw285/items?format=json&clean=1\";\n      const gumtreeResponse = await fetch(gumtree_url);\n      const gumtreeData = await gumtreeResponse.json();\n      const gumtreeDataParsed = await gumtreeData.map(listing => {\n        return {\n          title: listing.title,\n          price: listing.price.substring(1),\n          description: listing.description,\n          image: missingImagesFiltered(listing.image),\n          url: listing.url,\n          site: \"gumtree\"\n        };\n      });\n      this.setState({\n        gumtreeData: {\n          data: gumtreeDataParsed,\n          status: 'resolved'\n        }\n      });\n      let gumtreeDataSetTime = Date.now() - appLoaded;\n      console.log(\"gumtree data has been set, it took this many milliseconds: \" + gumtreeDataSetTime);\n    }; ///\n\n\n    const getFacebookData = async () => {\n      console.log(\"getting facebook data\");\n      const facebook_url = \"https://api.apify.com/v2/datasets/IitkxYE95yydtzFlk/items?clean=true&format=json\";\n      const facebookResponse = await fetch(facebook_url);\n      const facebookData = await facebookResponse.json();\n      const facebookDataParsed = facebookData.map(listing => {\n        return {\n          title: \"\" + isNull(listing.title),\n          price: \"\" + facebookPriceParsed(listing.price),\n          description: \"\" + isNull(listing.description),\n          image: \"\" + missingImagesFiltered(listing.image),\n          url: \"\" + isNull(listing.url),\n          site: \"facebook\"\n        };\n      });\n      this.setState({\n        facebookData: {\n          data: facebookDataParsed,\n          status: 'resolved'\n        }\n      });\n      let facebookDataSetTime = Date.now() - appLoaded;\n      console.log(\"facebook data has been set, it took this many milliseconds: \" + facebookDataSetTime);\n    }; ///////\n\n\n    getEbayAccessToken();\n    getDepopData();\n    getGumtreeData();\n    getFacebookData();\n    hotjar.initialize(2123002, 6);\n    console.log(\"access token\" + this.state.AccessToken);\n  } //COMPONENT MOUNT ENDS\n\n\n  toggleLanding() {\n    this.setState({\n      landing: true\n    });\n  }\n\n  toggleDisplay(sortOrder) {\n    this.setState({\n      resultsDisplay: sortOrder\n    });\n    console.log(sortOrder);\n    console.log(\"the display mode is now\" + this.state.resultsDisplay);\n    this.reOrderDisplay();\n  }\n\n  reOrderDisplay() {\n    /// functions\n    function shuffleArray(array) {\n      for (var i = array.length - 1; i > 0; i--) {\n        var j = Math.floor(Math.random() * (i + 1));\n        var temp = array[i];\n        array[i] = array[j];\n        array[j] = temp;\n      }\n\n      return array;\n    }\n\n    function lowest(a, b) {\n      if (Number(a.price) < Number(b.price)) {\n        return 1;\n      }\n\n      if (Number(a.price) > Number(b.price)) {\n        return -1;\n      }\n\n      return 0;\n    }\n\n    function highest(a, b) {\n      if (Number(a.price) < Number(b.price)) {\n        return -1;\n      }\n\n      if (Number(a.price) > Number(b.price)) {\n        return 1;\n      }\n\n      return 0;\n    }\n\n    if (this.state.Data) {\n      if (this.state.resultsDisplay === \"⚡️ Trending ⚡️\") {\n        this.setState({\n          Data: shuffleArray(this.state.Data)\n        });\n      } else if (this.state.resultsDisplay === \"Highest price first ▲\") {\n        this.setState({\n          Data: this.state.Data.sort(highest)\n        });\n      } else if (this.state.resultsDisplay === \"Lowest price first ▼\") {\n        this.setState({\n          Data: this.state.Data.sort(lowest)\n        });\n      } else {\n        this.setState({});\n      }\n    }\n  }\n\n  async setData(searchQuery) {\n    if (!searchQuery) {\n      alert(\"Tell me what to search! 😁\");\n      return;\n    }\n\n    console.time(\"complete search\");\n    this.setState({\n      searchTerm: searchQuery.toLowerCase(),\n      loading: true,\n      landing: false\n    });\n\n    if (Date.now() > this.state.ExpiryDate) {\n      console.log(\"this app does not have an access token! Getting access token\");\n      var myHeaders = new Headers();\n      myHeaders.append(\"Authorization\", \"Basic Sm9zZXBoVW4tTG9tYS1QUkQtMTk5YWQwZDkwLWY0Y2QyYjg4OlBSRC05OWFkMGQ5MDRiYjEtZjYzMS00OGMyLTkwNTQtYTQ5Yg==\");\n      myHeaders.append(\"Content-Type\", \"application/x-www-form-urlencoded\");\n      myHeaders.append(\"Cookie\", \"ebay=%5Esbf%3D%23%5E; dp1=bu1p/QEBfX0BAX19AQA**6379634c^\");\n      var urlencoded = new URLSearchParams();\n      urlencoded.append(\"grant_type\", \"client_credentials\");\n      urlencoded.append(\"scope\", \"https://api.ebay.com/oauth/api_scope\");\n      var requestOptions = {\n        method: 'POST',\n        headers: myHeaders,\n        body: urlencoded,\n        redirect: 'follow'\n      };\n      fetch(\"https://loma-cors.herokuapp.com/https://api.ebay.com/identity/v1/oauth2/token\", requestOptions).then(response => response.json()).then(jsonresponse => {\n        this.setState({\n          AccessToken: jsonresponse.access_token,\n          ExpiryDate: new Date().getTime() + jsonresponse.expires_in * 1000\n        });\n      }).catch(error => console.log('error', error));\n    } else {\n      console.log(\"this has an access token\" + this.state.AccessToken.substring(10, 25));\n    } // console.log(\"access token\" + this.state.AccessToken);\n    // let formattedExpiryDate = this.state.ExpiryDate * 1000;\n    //console.log(formattedExpiryDate.toUTCString())\n    /////////////////////DATA CLEANERS///////////////////////////\n\n\n    const isNull = property => {\n      if (property === null || property === undefined) {\n        return \" \";\n      } else {\n        return property;\n      }\n    };\n\n    const isPriceNull = price => {\n      if (price === undefined || price === null) {\n        return \"~\";\n      } else {\n        return price.substring(1);\n      }\n    };\n\n    const ebayPriceParsed = listing => {\n      if (listing.price.currency === \"USD\") {\n        return listing.price.convertedFromValue ? listing.price.convertedFromValue : listing.price.value;\n      } else {\n        return listing.price.value;\n      }\n    };\n\n    const facebookPriceParsed = price => {\n      let rawPrice = price.substring(1);\n\n      if (!price || price === \"FREE\") {\n        return \"0\";\n      } else if (price === \"See listings near me\") {\n        return \"~\";\n      } else if (!rawPrice.includes(\"£\")) {\n        return rawPrice;\n      } else if (rawPrice.includes(\"£\")) {\n        return rawPrice.substring(0, rawPrice.indexOf(\"£\"));\n      }\n    };\n\n    const missingImagesFiltered = imageProp => {\n      if (imageProp === null || imageProp === undefined) {\n        return imagePlaceholder;\n      } else {\n        return imageProp;\n      }\n    };\n\n    const tnmissingImagesFiltered = listing => {\n      if (!listing.photos) {\n        return imagePlaceholder;\n      } else {\n        return listing.photos[0].url;\n      }\n    };\n\n    const eBayMissingImagesFiltered = listing => {\n      if (!listing.hasOwnProperty(\"image\") || !listing.image.hasOwnProperty(\"imageUrl\")) {\n        return imagePlaceholder;\n      } else {\n        return listing.thumbnailImages[0].imageUrl;\n      }\n    }; /////END OF CLEANER FUNCTIONS\n    /////GET EBAY DATA\n\n\n    var ebayHeaders = new Headers();\n    ebayHeaders.append(\"Authorization\", `Bearer ${this.state.AccessToken}`);\n    ebayHeaders.append(\"Content-Type\", \"application/json\");\n    ebayHeaders.append(\"X-EBAY-C-MARKETPLACE-ID\", \"EBAY_US\");\n    ebayHeaders.append(\"X-EBAY-C-ENDUSERCTX\", \"affiliateCampaignId=<ePNCampaignId>,affiliateReferenceId=<referenceId>\");\n    var ebayrequestOptions = {\n      method: 'GET',\n      headers: ebayHeaders,\n      redirect: 'follow'\n    };\n    const ebayresponse = await fetch(`https://loma-cors.herokuapp.com/https://api.ebay.com/buy/browse/v1/item_summary/search?q=${searchQuery}&limit=200&filter=conditions:{UNSPECIFIED|USED},itemLocationCountry:GB&fieldgroups=EXTENDED`, ebayrequestOptions);\n    const jsonresponse = await ebayresponse.json();\n\n    const ebayDataParsed = () => {\n      if (jsonresponse.itemSummaries) {\n        return jsonresponse.itemSummaries.map(listing => {\n          return {\n            title: isNull(listing.title),\n            description: isNull(listing.shortDescription),\n            price: isNull(ebayPriceParsed(listing)),\n            image: eBayMissingImagesFiltered(listing),\n            url: isNull(listing.itemWebUrl),\n            site: \"ebay\"\n          };\n        });\n      } else {\n        return [];\n      }\n    };\n\n    this.setState(prevState => ({\n      Data: [...prevState.Data, ...ebayDataParsed()]\n    })); /////////////GET DEPOP DATA\n\n    if (this.state.depopData.status === \"unresolved\") {\n      const depop_url = \"https://api.apify.com/v2/datasets/ml97NZifdmN1EFUSb/items?clean=true&format=json\";\n      const depopResponse = await fetch(depop_url);\n      const depopData = await depopResponse.json();\n      const depopDataFiltered = depopData.filter(listing => {\n        if (isNull(listing.title).toLowerCase().includes(this.state.searchTerm)) {\n          return true;\n        } else if (isNull(listing.description).toLowerCase().includes(this.state.searchTerm)) {\n          return true;\n        } else {\n          return false;\n        }\n      }); // || isNull(listing.description).includes(this.state.searchTerm));\n\n      const depopDataParsed = depopDataFiltered.map(listing => {\n        return {\n          title: isNull(listing.title),\n          price: isPriceNull(listing.price),\n          description: isNull(listing.description),\n          image: isNull(missingImagesFiltered(listing.image)),\n          url: isNull(listing.url),\n          site: \"depop\"\n        };\n      });\n      this.setState({\n        depopData: {\n          data: depopDataParsed,\n          status: 'resolved'\n        }\n      });\n      this.setState(prevState => ({\n        Data: [...prevState.Data, ...depopDataParsed]\n      }));\n    } else if (this.state.depopData.status === \"resolved\") {\n      const depopDataFiltered = this.state.depopData.data.filter(listing => {\n        if (isNull(listing.title).toLowerCase().includes(this.state.searchTerm)) {\n          return true;\n        } else if (isNull(listing.description).toLowerCase().includes(this.state.searchTerm)) {\n          return true;\n        } else {\n          return false;\n        }\n      });\n      this.setState(prevState => ({\n        Data: [...prevState.Data, ...depopDataFiltered]\n      }));\n    }\n\n    if (this.state.gumtreeData.status === \"unresolved\") {\n      const gumtree_url = \"https://api.apify.com/v2/datasets/Dh5XzAb9fvidWw285/items?format=json&clean=1\";\n      const gumtreeResponse = await fetch(gumtree_url);\n      const gumtreeData = await gumtreeResponse.json();\n      const gumtreeDataFiltered = gumtreeData.filter(listing => listing.title.toLowerCase().includes(this.state.searchTerm) || listing.description.toLowerCase().includes(this.state.searchTerm));\n      const gumtreeDataParsed = gumtreeDataFiltered.map(listing => {\n        return {\n          title: listing.title,\n          price: listing.price.substring(1),\n          description: listing.description,\n          image: missingImagesFiltered(listing.image),\n          url: listing.url,\n          site: \"gumtree\"\n        };\n      });\n      this.setState({\n        depopData: {\n          data: gumtreeDataParsed,\n          status: 'resolved'\n        }\n      });\n      this.setState(prevState => ({\n        Data: [...prevState.Data, ...gumtreeDataParsed]\n      }));\n    } else {\n      const gumtreeDataFiltered = this.state.gumtreeData.data.filter(listing => {\n        if (isNull(listing.title).toLowerCase().includes(this.state.searchTerm)) {\n          return true;\n        } else if (isNull(listing.description).toLowerCase().includes(this.state.searchTerm)) {\n          return true;\n        } else {\n          return false;\n        }\n      });\n      this.setState(prevState => ({\n        Data: [...prevState.Data, ...gumtreeDataFiltered]\n      }));\n    }\n\n    if (this.state.facebookData.status === \"unresolved\") {\n      const facebook_url = \"https://api.apify.com/v2/datasets/IitkxYE95yydtzFlk/items?clean=true&format=json\";\n      const facebookResponse = await fetch(facebook_url);\n      const facebookData = await facebookResponse.json();\n      const facebookDataFiltered = facebookData.filter(listing => listing.title.toLowerCase().includes(searchQuery || listing.description.toLowerCase().includes(searchQuery)));\n      const facebookDataParsed = facebookDataFiltered.map(listing => {\n        return {\n          title: \"\" + isNull(listing.title),\n          price: \"\" + facebookPriceParsed(listing.price),\n          description: \"\" + isNull(listing.description),\n          image: \"\" + missingImagesFiltered(listing.image),\n          url: \"\" + isNull(listing.url),\n          site: \"facebook\"\n        };\n      });\n      this.setState({\n        facebookData: {\n          data: facebookDataParsed,\n          status: 'resolved'\n        }\n      });\n      this.setState(prevState => ({\n        Data: [...prevState.Data, ...facebookDataParsed]\n      }));\n    } else {\n      const facebookDataFiltered = this.state.facebookData.data.filter(listing => {\n        if (isNull(listing.title).toLowerCase().includes(this.state.searchTerm)) {\n          return true;\n        } else if (isNull(listing.description).toLowerCase().includes(this.state.searchTerm)) {\n          return true;\n        } else {\n          return false;\n        }\n      });\n      this.setState(prevState => ({\n        Data: [...prevState.Data, ...facebookDataFiltered]\n      }));\n    }\n\n    const etsyRaw = await fetch(`https://loma-cors.herokuapp.com/https://openapi.etsy.com/v2/listings/active?keywords=${searchQuery}&tags=vintage&limit=200&region=GB&api_key=sh1n3isgj6bax7eotlor7m4s&includes=Images`);\n    const etsyJson = await etsyRaw.json();\n    const etsyDataResults = etsyJson.results;\n    const etsyData = etsyDataResults.map(listing => {\n      return {\n        title: listing.title,\n        price: listing.price,\n        description: listing.description,\n        image: missingImagesFiltered(listing.Images[0].url_570xN),\n        url: listing.url,\n        site: \"etsy\"\n      };\n    });\n    this.setState(prevState => ({\n      Data: [...prevState.Data, ...etsyData]\n    }));\n    const trashnothingRaw = await fetch(`https://trashnothing.com/api/v1.2/posts/search?search=${searchQuery}&sort_by=relevance&types=offer&sources=trashnothing&per_page=50&page=4&device_pixel_ratio=1&latitude=51.507351&longitude=-0.127758&radius=200000&api_key=yr8sVaHEvbdkdunSFfPoDpqlwEjxIuqB3XhyFzx1`);\n    const tnJson = await trashnothingRaw.json();\n    const tnResults = tnJson.posts;\n    const trashNothingData = tnResults.map(listing => {\n      return {\n        title: listing.title,\n        price: 0,\n        description: listing.content,\n        image: tnmissingImagesFiltered(listing),\n        url: listing.url,\n        site: \"trashnothing\"\n      };\n    });\n    this.setState(prevState => ({\n      Data: [...prevState.Data, ...trashNothingData]\n    }));\n\n    function highest(a, b) {\n      if (Number(a.price) < Number(b.price)) {\n        return 1;\n      }\n\n      if (Number(a.price) > Number(b.price)) {\n        return -1;\n      }\n\n      return 0;\n    }\n\n    function lowest(a, b) {\n      if (Number(a.price) < Number(b.price)) {\n        return -1;\n      }\n\n      if (Number(a.price) > Number(b.price)) {\n        return 1;\n      }\n\n      return 0;\n    }\n\n    function shuffleArray(array) {\n      for (var i = array.length - 1; i > 0; i--) {\n        var j = Math.floor(Math.random() * (i + 1));\n        var temp = array[i];\n        array[i] = array[j];\n        array[j] = temp;\n      }\n\n      return array;\n    }\n\n    this.state.resultsDisplay === \"⚡️ Trending ⚡️\" ? this.setState(prevState => ({\n      Data: shuffleArray(prevState.Data),\n      loading: false\n    })) : this.state.resultsDisplay === \"Highest price first ▲\" ? this.setState(prevState => ({\n      Data: prevState.Data.sort(highest),\n      loading: false\n    })) : this.state.resultsDisplay === \"Lowest price first ▼\" ? this.setState(prevState => ({\n      Data: prevState.Data.sort(lowest),\n      loading: false\n    })) : this.setState(prevState => ({\n      Data: prevState.Data,\n      loading: false\n    }));\n    console.timeEnd(\"complete search\");\n  }\n\n  handleChange(searchQuery) {\n    this.setState({\n      searchTerm: searchQuery\n    });\n    this.setData(searchQuery);\n  }\n\n  togglePopUp(listing) {\n    if (this.state.popUpListing.display === true) {\n      this.setState({\n        popUpListing: {\n          display: false,\n          listing: {}\n        }\n      });\n    } else {\n      this.setState({\n        popUpListing: {\n          display: true,\n          listing: listing\n        }\n      });\n    }\n  }\n\n  changeActiveListing(listing, direction) {\n    let currentActiveListingIndex = this.state.Data.indexOf(listing);\n\n    if (direction === \"next\") {\n      this.setState(prevState => ({\n        popUpListing: {\n          display: true,\n          listing: prevState.Data[currentActiveListingIndex + 1]\n        }\n      }));\n    } else if (direction === \"previous\" && currentActiveListingIndex > 0) {\n      this.setState(prevState => ({\n        popUpListing: {\n          display: true,\n          listing: prevState.Data[currentActiveListingIndex - 1]\n        }\n      }));\n    } else {\n      return;\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"App w-100 h-full bg-white overflow-x-hidden z-0\",\n      children: [this.state.popUpListing.display ? /*#__PURE__*/_jsxDEV(PopUpListing, {\n        changeActiveListing: this.changeActiveListing,\n        display: this.state.popUpListing.display,\n        listing: this.state.popUpListing.listing,\n        togglePopUp: this.togglePopUp\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 708,\n        columnNumber: 46\n      }, this) : null, /*#__PURE__*/_jsxDEV(SearchBar, {\n        onChange: this.handleChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 709,\n        columnNumber: 11\n      }, this), this.state.landing ? /*#__PURE__*/_jsxDEV(Landing, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 712,\n        columnNumber: 33\n      }, this) : null, this.state.loading ? null : /*#__PURE__*/_jsxDEV(Results, {\n        Data: this.state.Data,\n        resultsDisplay: this.state.resultsDisplay,\n        toggleResults: this.toggleDisplay,\n        searchTerm: this.state.searchTerm,\n        search: this.handleChange,\n        togglePopUp: this.togglePopUp\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 713,\n        columnNumber: 40\n      }, this), this.state.loading ? /*#__PURE__*/_jsxDEV(LoadingPop, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 721,\n        columnNumber: 33\n      }, this) : /*#__PURE__*/_jsxDEV(\"p\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 721,\n        columnNumber: 50\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 707,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/joseph/Code/lomav2/src/App.js"],"names":["React","SearchBar","Results","Landing","LoadingPop","PopUpListing","imagePlaceholder","hotjar","appLoaded","Date","now","getEbayAccessToken","state","ExpiryDate","console","log","myHeaders","Headers","append","urlencoded","URLSearchParams","requestOptions","method","headers","body","redirect","fetch","then","response","json","jsonresponse","setState","AccessToken","access_token","expires_in","accessTokenSet","catch","error","App","Component","constructor","props","Data","resultsDisplay","searchTerm","loading","landing","popUpListing","display","listing","depopData","data","nothing","status","gumtreeData","facebookData","handleChange","bind","setData","toggleDisplay","reOrderDisplay","togglePopUp","changeActiveListing","componentDidMount","isNull","property","undefined","facebookPriceParsed","price","rawPrice","substring","includes","indexOf","isPriceNull","missingImagesFiltered","imageProp","getDepopData","depop_url","depopResponse","depopDataParsed","map","title","description","image","url","site","depopDataSetTime","getGumtreeData","gumtree_url","gumtreeResponse","gumtreeDataParsed","gumtreeDataSetTime","getFacebookData","facebook_url","facebookResponse","facebookDataParsed","facebookDataSetTime","initialize","toggleLanding","sortOrder","shuffleArray","array","i","length","j","Math","floor","random","temp","lowest","a","b","Number","highest","sort","searchQuery","alert","time","toLowerCase","getTime","ebayPriceParsed","currency","convertedFromValue","value","tnmissingImagesFiltered","photos","eBayMissingImagesFiltered","hasOwnProperty","thumbnailImages","imageUrl","ebayHeaders","ebayrequestOptions","ebayresponse","ebayDataParsed","itemSummaries","shortDescription","itemWebUrl","prevState","depopDataFiltered","filter","gumtreeDataFiltered","facebookDataFiltered","etsyRaw","etsyJson","etsyDataResults","results","etsyData","Images","url_570xN","trashnothingRaw","tnJson","tnResults","posts","trashNothingData","content","timeEnd","direction","currentActiveListingIndex","render"],"mappings":";;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAO,0BAAP;AAEA,SAASC,SAAT,QAA0B,wBAA1B;AACA,SAASC,OAAT,QAAwB,sBAAxB;AACA,SAASC,OAAT,QAAwB,sBAAxB;AACA,SAASC,UAAT,QAA2B,yBAA3B;AACA,SAASC,YAAT,QAA6B,2BAA7B;AAGA,OAAOC,gBAAP,MAA6B,sBAA7B;AAEA,SAASC,MAAT,QAAuB,cAAvB;AAEA,MAAMC,SAAS,GAAGC,IAAI,CAACC,GAAL,EAAlB;;AACA,SAASC,kBAAT,GAA8B;AAC5B,MAAIF,IAAI,CAACC,GAAL,KAAa,KAAKE,KAAL,CAAWC,UAA5B,EAAwC;AACtCC,IAAAA,OAAO,CAACC,GAAR,CAAY,8DAAZ;AAEA,QAAIC,SAAS,GAAG,IAAIC,OAAJ,EAAhB;AACAD,IAAAA,SAAS,CAACE,MAAV,CAAiB,eAAjB,EAAkC,4GAAlC;AACAF,IAAAA,SAAS,CAACE,MAAV,CAAiB,cAAjB,EAAiC,mCAAjC;AACAF,IAAAA,SAAS,CAACE,MAAV,CAAiB,QAAjB,EAA2B,0DAA3B;AAEA,QAAIC,UAAU,GAAG,IAAIC,eAAJ,EAAjB;AACAD,IAAAA,UAAU,CAACD,MAAX,CAAkB,YAAlB,EAAgC,oBAAhC;AACAC,IAAAA,UAAU,CAACD,MAAX,CAAkB,OAAlB,EAA2B,sCAA3B;AAEA,QAAIG,cAAc,GAAG;AACnBC,MAAAA,MAAM,EAAE,MADW;AAEnBC,MAAAA,OAAO,EAAEP,SAFU;AAGnBQ,MAAAA,IAAI,EAAEL,UAHa;AAInBM,MAAAA,QAAQ,EAAE;AAJS,KAArB;AAOAC,IAAAA,KAAK,CAAC,+EAAD,EAAkFL,cAAlF,CAAL,CACKM,IADL,CACUC,QAAQ,IAAIA,QAAQ,CAACC,IAAT,EADtB,EAEKF,IAFL,CAEUG,YAAY,IAAI;AACpB,WAAKC,QAAL,CAAc;AACZC,QAAAA,WAAW,EAAEF,YAAY,CAACG,YADd;AAEZpB,QAAAA,UAAU,EAAEJ,IAAI,CAACC,GAAL,KAAaoB,YAAY,CAACI,UAAb,GAA0B;AAFvC,OAAd;AAIA,UAAIC,cAAc,GAAG1B,IAAI,CAACC,GAAL,KAAaF,SAAlC;AACAM,MAAAA,OAAO,CAACC,GAAR,CAAa,oBAAmB,KAAKH,KAAL,CAAWoB,WAAY,UAASG,cAAe,eAA/E;AACD,KATL,EAUKC,KAVL,CAUWC,KAAK,IAAIvB,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAqBsB,KAArB,CAVpB;AAWG;AACJ;;AAGH,MAAMC,GAAN,SAAkBtC,KAAK,CAACuC,SAAxB,CAAkC;AAChCC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;AACA,SAAK7B,KAAL,GAAa;AACX8B,MAAAA,IAAI,EAAE,EADK;AAEXV,MAAAA,WAAW,EAAE,MAFF;AAGXnB,MAAAA,UAAU,EAAE,CAHD;AAIX8B,MAAAA,cAAc,EAAE,gBAJL;AAKXC,MAAAA,UAAU,EAAE,EALD;AAMXC,MAAAA,OAAO,EAAE,KANE;AAOXC,MAAAA,OAAO,EAAE,IAPE;AAQXC,MAAAA,YAAY,EAAE;AACZC,QAAAA,OAAO,EAAE,KADG;AAEZC,QAAAA,OAAO,EAAE;AAFG,OARH;AAYXC,MAAAA,SAAS,EAAE;AACTC,QAAAA,IAAI,EAAE,CAAC;AAACC,UAAAA,OAAO,EAAG;AAAX,SAAD,CADG;AAETC,QAAAA,MAAM,EAAE;AAFC,OAZA;AAgBXC,MAAAA,WAAW,EAAE;AACXH,QAAAA,IAAI,EAAE,CAAC;AAACC,UAAAA,OAAO,EAAG;AAAX,SAAD,CADK;AAEXC,QAAAA,MAAM,EAAE;AAFG,OAhBF;AAoBXE,MAAAA,YAAY,EAAE;AACZJ,QAAAA,IAAI,EAAE,CAAC;AAACC,UAAAA,OAAO,EAAG;AAAX,SAAD,CADM;AAEZC,QAAAA,MAAM,EAAE;AAFI;AApBH,KAAb;AAyBA,SAAKG,YAAL,GAAoB,KAAKA,YAAL,CAAkBC,IAAlB,CAAuB,IAAvB,CAApB;AACA,SAAKC,OAAL,GAAe,KAAKA,OAAL,CAAaD,IAAb,CAAkB,IAAlB,CAAf;AACA,SAAKE,aAAL,GAAqB,KAAKA,aAAL,CAAmBF,IAAnB,CAAwB,IAAxB,CAArB;AACA,SAAKG,cAAL,GAAsB,KAAKA,cAAL,CAAoBH,IAApB,CAAyB,IAAzB,CAAtB;AACA,SAAKI,WAAL,GAAmB,KAAKA,WAAL,CAAiBJ,IAAjB,CAAsB,IAAtB,CAAnB;AACA,SAAKK,mBAAL,GAA2B,KAAKA,mBAAL,CAAyBL,IAAzB,CAA8B,IAA9B,CAA3B;AACD;;AAEDM,EAAAA,iBAAiB,GAAG;AAClB,UAAMvD,SAAS,GAAGC,IAAI,CAACC,GAAL,EAAlB,CADkB,CAGlB;;AACA,UAAMsD,MAAM,GAAIC,QAAD,IAAc;AAC3B,UAAIA,QAAQ,KAAK,IAAb,IAAqBA,QAAQ,KAAKC,SAAtC,EAAiD;AAClD,eAAO,GAAP;AACC,OAFA,MAEM;AACL,eAAOD,QAAP;AACD;AACA,KANF;;AAQC,UAAME,mBAAmB,GAAIC,KAAD,IAAW;AACtC,UAAIC,QAAQ,GAAGD,KAAK,CAACE,SAAN,CAAgB,CAAhB,CAAf;;AACA,UAAI,CAACF,KAAD,IAAUA,KAAK,KAAK,MAAxB,EAAgC;AAC9B,eAAO,GAAP;AACD,OAFD,MAEO,IAAIA,KAAK,KAAK,sBAAd,EAAsC;AAC3C,eAAO,GAAP;AACD,OAFM,MAEA,IAAI,CAACC,QAAQ,CAACE,QAAT,CAAkB,GAAlB,CAAL,EAA4B;AACjC,eAAOF,QAAP;AACD,OAFM,MAEA,IAAIA,QAAQ,CAACE,QAAT,CAAkB,GAAlB,CAAJ,EAA4B;AACjC,eAAOF,QAAQ,CAACC,SAAT,CAAmB,CAAnB,EAAsBD,QAAQ,CAACG,OAAT,CAAiB,GAAjB,CAAtB,CAAP;AACD;AACF,KAXA;;AAcA,UAAMC,WAAW,GAAIL,KAAD,IAAW;AAC9B,UAAIA,KAAK,KAAKF,SAAV,IAAuBE,KAAK,KAAK,IAArC,EAA2C;AACzC,eAAO,GAAP;AACD,OAFD,MAEO;AACL,eAAOA,KAAK,CAACE,SAAN,CAAgB,CAAhB,CAAP;AACD;AACF,KANA;;AAQD,UAAMI,qBAAqB,GAAIC,SAAD,IAAe;AAC3C,UAAIA,SAAS,KAAK,IAAd,IAAsBA,SAAS,KAAKT,SAAxC,EAAmD;AACjD,eAAO5D,gBAAP;AACD,OAFD,MAEO;AACL,eAAOqE,SAAP;AACD;AACF,KAND,CAlCkB,CAyClB;;;AAEA,UAAMC,YAAY,GAAG,YAAY;AAC/B9D,MAAAA,OAAO,CAACC,GAAR,CAAY,oBAAZ;AAEF,YAAM8D,SAAS,GAAG,kFAAlB;AACA,YAAMC,aAAa,GAAG,MAAMpD,KAAK,CAACmD,SAAD,CAAjC;AACA,YAAM3B,SAAS,GAAG,MAAM4B,aAAa,CAACjD,IAAd,EAAxB;AAEA,YAAMkD,eAAe,GAAG,MAAM7B,SAAS,CAAC8B,GAAV,CAC3B/B,OAAD,IAAa;AACX,eAAO;AACLgC,UAAAA,KAAK,EAAEjB,MAAM,CAACf,OAAO,CAACgC,KAAT,CADR;AAELb,UAAAA,KAAK,EAAEK,WAAW,CAACxB,OAAO,CAACmB,KAAT,CAFb;AAGLc,UAAAA,WAAW,EAAElB,MAAM,CAACf,OAAO,CAACiC,WAAT,CAHd;AAILC,UAAAA,KAAK,EAAEnB,MAAM,CAACU,qBAAqB,CAACzB,OAAO,CAACkC,KAAT,CAAtB,CAJR;AAKLC,UAAAA,GAAG,EAAEpB,MAAM,CAACf,OAAO,CAACmC,GAAT,CALN;AAMLC,UAAAA,IAAI,EAAE;AAND,SAAP;AAQD,OAV2B,CAA9B;AAaA,WAAKtD,QAAL,CAAc;AACZmB,QAAAA,SAAS,EAAG;AACVC,UAAAA,IAAI,EAAE4B,eADI;AAEV1B,UAAAA,MAAM,EAAE;AAFE;AADA,OAAd;AAOA,UAAIiC,gBAAgB,GAAG7E,IAAI,CAACC,GAAL,KAAaF,SAApC;AAEAM,MAAAA,OAAO,CAACC,GAAR,CAAY,8DAA8DuE,gBAA1E;AAEC,KA/BD,CA3CkB,CA4EtB;;;AAEI,UAAMC,cAAc,GAAG,YAAY;AACjCzE,MAAAA,OAAO,CAACC,GAAR,CAAY,sBAAZ;AAEA,YAAMyE,WAAW,GAAG,+EAApB;AACA,YAAMC,eAAe,GAAG,MAAM/D,KAAK,CAAC8D,WAAD,CAAnC;AACA,YAAMlC,WAAW,GAAG,MAAMmC,eAAe,CAAC5D,IAAhB,EAA1B;AAEA,YAAM6D,iBAAiB,GAAG,MAAMpC,WAAW,CAAC0B,GAAZ,CAC9B/B,OAAO,IAAI;AACT,eAAO;AACLgC,UAAAA,KAAK,EAAEhC,OAAO,CAACgC,KADV;AAELb,UAAAA,KAAK,EAAEnB,OAAO,CAACmB,KAAR,CAAcE,SAAd,CAAwB,CAAxB,CAFF;AAGLY,UAAAA,WAAW,EAAEjC,OAAO,CAACiC,WAHhB;AAILC,UAAAA,KAAK,EAAET,qBAAqB,CAACzB,OAAO,CAACkC,KAAT,CAJvB;AAKLC,UAAAA,GAAG,EAAEnC,OAAO,CAACmC,GALR;AAMLC,UAAAA,IAAI,EAAE;AAND,SAAP;AAQD,OAV6B,CAAhC;AAaF,WAAKtD,QAAL,CAAc;AACZuB,QAAAA,WAAW,EAAG;AACZH,UAAAA,IAAI,EAAEuC,iBADM;AAEZrC,UAAAA,MAAM,EAAE;AAFI;AADF,OAAd;AAMA,UAAIsC,kBAAkB,GAAGlF,IAAI,CAACC,GAAL,KAAaF,SAAtC;AAEAM,MAAAA,OAAO,CAACC,GAAR,CAAY,gEAAgE4E,kBAA5E;AAEC,KA9BD,CA9EkB,CA+GlB;;;AAEA,UAAMC,eAAe,GAAG,YAAY;AAClC9E,MAAAA,OAAO,CAACC,GAAR,CAAY,uBAAZ;AAEA,YAAM8E,YAAY,GAAG,kFAArB;AACA,YAAMC,gBAAgB,GAAG,MAAMpE,KAAK,CAACmE,YAAD,CAApC;AACA,YAAMtC,YAAY,GAAG,MAAMuC,gBAAgB,CAACjE,IAAjB,EAA3B;AAEA,YAAMkE,kBAAkB,GAAGxC,YAAY,CAACyB,GAAb,CACzB/B,OAAO,IAAI;AACT,eAAO;AACLgC,UAAAA,KAAK,EAAE,KAAKjB,MAAM,CAACf,OAAO,CAACgC,KAAT,CADb;AAELb,UAAAA,KAAK,EAAE,KAAKD,mBAAmB,CAAClB,OAAO,CAACmB,KAAT,CAF1B;AAGLc,UAAAA,WAAW,EAAE,KAAKlB,MAAM,CAACf,OAAO,CAACiC,WAAT,CAHnB;AAILC,UAAAA,KAAK,EAAE,KAAKT,qBAAqB,CAACzB,OAAO,CAACkC,KAAT,CAJ5B;AAKLC,UAAAA,GAAG,EAAE,KAAKpB,MAAM,CAACf,OAAO,CAACmC,GAAT,CALX;AAMLC,UAAAA,IAAI,EAAE;AAND,SAAP;AAQD,OAVwB,CAA3B;AAeF,WAAKtD,QAAL,CAAc;AACZwB,QAAAA,YAAY,EAAG;AACbJ,UAAAA,IAAI,EAAE4C,kBADO;AAEb1C,UAAAA,MAAM,EAAE;AAFK;AADH,OAAd;AAOA,UAAI2C,mBAAmB,GAAGvF,IAAI,CAACC,GAAL,KAAaF,SAAvC;AAEAM,MAAAA,OAAO,CAACC,GAAR,CAAY,iEAAiEiF,mBAA7E;AAEC,KAjCD,CAjHkB,CAqJlB;;;AACArF,IAAAA,kBAAkB;AAClBiE,IAAAA,YAAY;AACZW,IAAAA,cAAc;AACdK,IAAAA,eAAe;AACfrF,IAAAA,MAAM,CAAC0F,UAAP,CAAkB,OAAlB,EAA0B,CAA1B;AACAnF,IAAAA,OAAO,CAACC,GAAR,CAAY,iBAAkB,KAAKH,KAAL,CAAWoB,WAAzC;AAED,GAjM+B,CAiM9B;;;AAEFkE,EAAAA,aAAa,GAAG;AACd,SAAKnE,QAAL,CAAc;AACZe,MAAAA,OAAO,EAAE;AADG,KAAd;AAGD;;AAEAa,EAAAA,aAAa,CAACwC,SAAD,EAAY;AACxB,SAAKpE,QAAL,CAAc;AAAEY,MAAAA,cAAc,EAAEwD;AAAlB,KAAd;AACArF,IAAAA,OAAO,CAACC,GAAR,CAAYoF,SAAZ;AACArF,IAAAA,OAAO,CAACC,GAAR,CAAY,4BAA4B,KAAKH,KAAL,CAAW+B,cAAnD;AACA,SAAKiB,cAAL;AACD;;AAEDA,EAAAA,cAAc,GAAG;AACf;AAEA,aAASwC,YAAT,CAAsBC,KAAtB,EAA6B;AAC3B,WAAK,IAAIC,CAAC,GAAGD,KAAK,CAACE,MAAN,GAAe,CAA5B,EAA+BD,CAAC,GAAG,CAAnC,EAAsCA,CAAC,EAAvC,EAA2C;AACvC,YAAIE,CAAC,GAAGC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,MAAiBL,CAAC,GAAG,CAArB,CAAX,CAAR;AACA,YAAIM,IAAI,GAAGP,KAAK,CAACC,CAAD,CAAhB;AACAD,QAAAA,KAAK,CAACC,CAAD,CAAL,GAAWD,KAAK,CAACG,CAAD,CAAhB;AACAH,QAAAA,KAAK,CAACG,CAAD,CAAL,GAAWI,IAAX;AACH;;AACD,aAAOP,KAAP;AACH;;AAED,aAASQ,MAAT,CAAiBC,CAAjB,EAAoBC,CAApB,EAAwB;AACtB,UAAKC,MAAM,CAACF,CAAC,CAAC1C,KAAH,CAAN,GAAkB4C,MAAM,CAACD,CAAC,CAAC3C,KAAH,CAA7B,EAAwC;AACtC,eAAO,CAAP;AACD;;AACD,UAAK4C,MAAM,CAACF,CAAC,CAAC1C,KAAH,CAAN,GAAkB4C,MAAM,CAACD,CAAC,CAAC3C,KAAH,CAA7B,EAAwC;AACtC,eAAO,CAAC,CAAR;AACD;;AACD,aAAO,CAAP;AACD;;AAED,aAAS6C,OAAT,CAAkBH,CAAlB,EAAqBC,CAArB,EAAyB;AACvB,UAAKC,MAAM,CAACF,CAAC,CAAC1C,KAAH,CAAN,GAAkB4C,MAAM,CAACD,CAAC,CAAC3C,KAAH,CAA7B,EAAwC;AACtC,eAAO,CAAC,CAAR;AACD;;AACD,UAAK4C,MAAM,CAACF,CAAC,CAAC1C,KAAH,CAAN,GAAkB4C,MAAM,CAACD,CAAC,CAAC3C,KAAH,CAA7B,EAAwC;AACtC,eAAO,CAAP;AACD;;AACD,aAAO,CAAP;AACD;;AAGD,QAAI,KAAKxD,KAAL,CAAW8B,IAAf,EAAqB;AACjB,UAAI,KAAK9B,KAAL,CAAW+B,cAAX,KAA8B,gBAAlC,EAAoD;AAClD,aAAKZ,QAAL,CAAc;AAACW,UAAAA,IAAI,EAAE0D,YAAY,CAAC,KAAKxF,KAAL,CAAW8B,IAAZ;AAAnB,SAAd;AACD,OAFD,MAEO,IAAI,KAAK9B,KAAL,CAAW+B,cAAX,KAA8B,uBAAlC,EAA2D;AAChE,aAAKZ,QAAL,CAAc;AAACW,UAAAA,IAAI,EAAE,KAAK9B,KAAL,CAAW8B,IAAX,CAAgBwE,IAAhB,CAAqBD,OAArB;AAAP,SAAd;AACD,OAFM,MAEA,IAAI,KAAKrG,KAAL,CAAW+B,cAAX,KAA8B,sBAAlC,EAA0D;AAC/D,aAAKZ,QAAL,CAAc;AAACW,UAAAA,IAAI,EAAE,KAAK9B,KAAL,CAAW8B,IAAX,CAAgBwE,IAAhB,CAAqBL,MAArB;AAAP,SAAd;AAAqD,OADhD,MAEA;AACH,aAAK9E,QAAL,CAAc,EAAd;AAAkB;AACnB;AACN;;AAED,QAAM2B,OAAN,CAAcyD,WAAd,EAA2B;AACzB,QAAI,CAACA,WAAL,EAAkB;AAChBC,MAAAA,KAAK,CAAC,4BAAD,CAAL;AACA;AACD;;AAEDtG,IAAAA,OAAO,CAACuG,IAAR,CAAa,iBAAb;AAEA,SAAKtF,QAAL,CAAc;AAACa,MAAAA,UAAU,EAAEuE,WAAW,CAACG,WAAZ,EAAb;AAAwCzE,MAAAA,OAAO,EAAE,IAAjD;AAAuDC,MAAAA,OAAO,EAAE;AAAhE,KAAd;;AAEA,QAAIrC,IAAI,CAACC,GAAL,KAAa,KAAKE,KAAL,CAAWC,UAA5B,EAAwC;AACtCC,MAAAA,OAAO,CAACC,GAAR,CAAY,8DAAZ;AAEA,UAAIC,SAAS,GAAG,IAAIC,OAAJ,EAAhB;AACAD,MAAAA,SAAS,CAACE,MAAV,CAAiB,eAAjB,EAAkC,4GAAlC;AACAF,MAAAA,SAAS,CAACE,MAAV,CAAiB,cAAjB,EAAiC,mCAAjC;AACAF,MAAAA,SAAS,CAACE,MAAV,CAAiB,QAAjB,EAA2B,0DAA3B;AAEA,UAAIC,UAAU,GAAG,IAAIC,eAAJ,EAAjB;AACAD,MAAAA,UAAU,CAACD,MAAX,CAAkB,YAAlB,EAAgC,oBAAhC;AACAC,MAAAA,UAAU,CAACD,MAAX,CAAkB,OAAlB,EAA2B,sCAA3B;AAEA,UAAIG,cAAc,GAAG;AACnBC,QAAAA,MAAM,EAAE,MADW;AAEnBC,QAAAA,OAAO,EAAEP,SAFU;AAGnBQ,QAAAA,IAAI,EAAEL,UAHa;AAInBM,QAAAA,QAAQ,EAAE;AAJS,OAArB;AAOAC,MAAAA,KAAK,CAAC,+EAAD,EAAkFL,cAAlF,CAAL,CACKM,IADL,CACUC,QAAQ,IAAIA,QAAQ,CAACC,IAAT,EADtB,EAEKF,IAFL,CAEUG,YAAY,IAAI;AACpB,aAAKC,QAAL,CAAc;AACZC,UAAAA,WAAW,EAAEF,YAAY,CAACG,YADd;AAEZpB,UAAAA,UAAU,EAAE,IAAIJ,IAAJ,GAAW8G,OAAX,KAAuBzF,YAAY,CAACI,UAAb,GAA0B;AAFjD,SAAd;AAID,OAPL,EAQKE,KARL,CAQWC,KAAK,IAAIvB,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAqBsB,KAArB,CARpB;AASD,KA5BD,MA4BO;AACLvB,MAAAA,OAAO,CAACC,GAAR,CAAY,6BAA6B,KAAKH,KAAL,CAAWoB,WAAX,CAAuBsC,SAAvB,CAAiC,EAAjC,EAAoC,EAApC,CAAzC;AACD,KAxCwB,CA0CzB;AACD;AACC;AAIA;;;AACA,UAAMN,MAAM,GAAIC,QAAD,IAAc;AAC3B,UAAIA,QAAQ,KAAK,IAAb,IAAqBA,QAAQ,KAAKC,SAAtC,EAAiD;AACjD,eAAO,GAAP;AACC,OAFD,MAEO;AACL,eAAOD,QAAP;AACD;AACF,KAND;;AAQA,UAAMQ,WAAW,GAAIL,KAAD,IAAW;AAC7B,UAAIA,KAAK,KAAKF,SAAV,IAAuBE,KAAK,KAAK,IAArC,EAA2C;AACzC,eAAO,GAAP;AACD,OAFD,MAEO;AACL,eAAOA,KAAK,CAACE,SAAN,CAAgB,CAAhB,CAAP;AACD;AACF,KAND;;AAQA,UAAMkD,eAAe,GAAIvE,OAAD,IAAa;AACnC,UAAIA,OAAO,CAACmB,KAAR,CAAcqD,QAAd,KAA2B,KAA/B,EAAsC;AACpC,eAAOxE,OAAO,CAACmB,KAAR,CAAcsD,kBAAd,GAAmCzE,OAAO,CAACmB,KAAR,CAAcsD,kBAAjD,GAAsEzE,OAAO,CAACmB,KAAR,CAAcuD,KAA3F;AACD,OAFD,MAEO;AACL,eAAO1E,OAAO,CAACmB,KAAR,CAAcuD,KAArB;AACD;AACF,KAND;;AAQA,UAAMxD,mBAAmB,GAAIC,KAAD,IAAW;AACrC,UAAIC,QAAQ,GAAGD,KAAK,CAACE,SAAN,CAAgB,CAAhB,CAAf;;AACA,UAAI,CAACF,KAAD,IAAUA,KAAK,KAAK,MAAxB,EAAgC;AAC9B,eAAO,GAAP;AACD,OAFD,MAEO,IAAIA,KAAK,KAAK,sBAAd,EAAsC;AAC3C,eAAO,GAAP;AACD,OAFM,MAEA,IAAI,CAACC,QAAQ,CAACE,QAAT,CAAkB,GAAlB,CAAL,EAA4B;AACjC,eAAOF,QAAP;AACD,OAFM,MAEA,IAAIA,QAAQ,CAACE,QAAT,CAAkB,GAAlB,CAAJ,EAA4B;AACjC,eAAOF,QAAQ,CAACC,SAAT,CAAmB,CAAnB,EAAsBD,QAAQ,CAACG,OAAT,CAAiB,GAAjB,CAAtB,CAAP;AACD;AACF,KAXD;;AAaA,UAAME,qBAAqB,GAAIC,SAAD,IAAe;AAC3C,UAAIA,SAAS,KAAK,IAAd,IAAsBA,SAAS,KAAKT,SAAxC,EAAmD;AACjD,eAAO5D,gBAAP;AACD,OAFD,MAEO;AACL,eAAOqE,SAAP;AACD;AACF,KAND;;AAQA,UAAMiD,uBAAuB,GAAI3E,OAAD,IAAa;AAC3C,UAAI,CAACA,OAAO,CAAC4E,MAAb,EAAqB;AACnB,eAAOvH,gBAAP;AACD,OAFD,MAEO;AACL,eAAO2C,OAAO,CAAC4E,MAAR,CAAe,CAAf,EAAkBzC,GAAzB;AACD;AACF,KAND;;AAQA,UAAM0C,yBAAyB,GAAI7E,OAAD,IAAa;AAC7C,UAAI,CAACA,OAAO,CAAC8E,cAAR,CAAuB,OAAvB,CAAD,IAAoC,CAAC9E,OAAO,CAACkC,KAAR,CAAc4C,cAAd,CAA6B,UAA7B,CAAzC,EAAmF;AACjF,eAAOzH,gBAAP;AACD,OAFD,MAEO;AACL,eAAO2C,OAAO,CAAC+E,eAAR,CAAwB,CAAxB,EAA2BC,QAAlC;AACD;AACF,KAND,CAtGyB,CA6GzB;AACA;;;AAEA,QAAIC,WAAW,GAAG,IAAIjH,OAAJ,EAAlB;AACAiH,IAAAA,WAAW,CAAChH,MAAZ,CAAmB,eAAnB,EAAqC,UAAS,KAAKN,KAAL,CAAWoB,WAAY,EAArE;AACAkG,IAAAA,WAAW,CAAChH,MAAZ,CAAmB,cAAnB,EAAmC,kBAAnC;AACAgH,IAAAA,WAAW,CAAChH,MAAZ,CAAmB,yBAAnB,EAA8C,SAA9C;AACAgH,IAAAA,WAAW,CAAChH,MAAZ,CAAmB,qBAAnB,EAA0C,wEAA1C;AAEA,QAAIiH,kBAAkB,GAAG;AACvB7G,MAAAA,MAAM,EAAE,KADe;AAEvBC,MAAAA,OAAO,EAAE2G,WAFc;AAGvBzG,MAAAA,QAAQ,EAAE;AAHa,KAAzB;AAOA,UAAM2G,YAAY,GAAG,MAAM1G,KAAK,CAAE,4FAA2FyF,WAAY,6FAAzG,EAAuMgB,kBAAvM,CAAhC;AACA,UAAMrG,YAAY,GAAG,MAAMsG,YAAY,CAACvG,IAAb,EAA3B;;AACA,UAAMwG,cAAc,GAAG,MAAM;AAC3B,UAAIvG,YAAY,CAACwG,aAAjB,EAAgC;AAC5B,eAAOxG,YAAY,CAACwG,aAAb,CAA2BtD,GAA3B,CACJ/B,OAAD,IAAa;AACT,iBAAO;AACHgC,YAAAA,KAAK,EAAEjB,MAAM,CAACf,OAAO,CAACgC,KAAT,CADV;AAEHC,YAAAA,WAAW,EAAElB,MAAM,CAACf,OAAO,CAACsF,gBAAT,CAFhB;AAGHnE,YAAAA,KAAK,EAAEJ,MAAM,CAACwD,eAAe,CAACvE,OAAD,CAAhB,CAHV;AAIHkC,YAAAA,KAAK,EAAE2C,yBAAyB,CAAC7E,OAAD,CAJ7B;AAKHmC,YAAAA,GAAG,EAAEpB,MAAM,CAACf,OAAO,CAACuF,UAAT,CALR;AAMHnD,YAAAA,IAAI,EAAE;AANH,WAAP;AAQH,SAVI,CAAP;AAYH,OAbD,MAaO;AACL,eAAO,EAAP;AACD;AACF,KAjBD;;AAmBA,SAAKtD,QAAL,CAAc0G,SAAS,KAAK;AAAC/F,MAAAA,IAAI,EAAE,CAAC,GAAG+F,SAAS,CAAC/F,IAAd,EAAmB,GAAG2F,cAAc,EAApC;AAAP,KAAL,CAAvB,EAlJyB,CAoJzB;;AAEA,QAAI,KAAKzH,KAAL,CAAWsC,SAAX,CAAqBG,MAArB,KAAgC,YAApC,EAAkD;AAChD,YAAMwB,SAAS,GAAG,kFAAlB;AACA,YAAMC,aAAa,GAAG,MAAMpD,KAAK,CAACmD,SAAD,CAAjC;AACA,YAAM3B,SAAS,GAAG,MAAM4B,aAAa,CAACjD,IAAd,EAAxB;AACA,YAAM6G,iBAAiB,GAAGxF,SAAS,CAACyF,MAAV,CAAmB1F,OAAD,IAAa;AACvD,YAAIe,MAAM,CAACf,OAAO,CAACgC,KAAT,CAAN,CAAsBqC,WAAtB,GAAoC/C,QAApC,CAA6C,KAAK3D,KAAL,CAAWgC,UAAxD,CAAJ,EAAyE;AACvE,iBAAO,IAAP;AACD,SAFD,MAEO,IAAIoB,MAAM,CAACf,OAAO,CAACiC,WAAT,CAAN,CAA4BoC,WAA5B,GAA0C/C,QAA1C,CAAmD,KAAK3D,KAAL,CAAWgC,UAA9D,CAAJ,EAA+E;AACpF,iBAAO,IAAP;AACD,SAFM,MAEA;AACL,iBAAO,KAAP;AACD;AACF,OARyB,CAA1B,CAJgD,CAa9C;;AAEF,YAAMmC,eAAe,GAAG2D,iBAAiB,CAAC1D,GAAlB,CACrB/B,OAAD,IAAa;AACX,eAAO;AACLgC,UAAAA,KAAK,EAAEjB,MAAM,CAACf,OAAO,CAACgC,KAAT,CADR;AAELb,UAAAA,KAAK,EAAEK,WAAW,CAACxB,OAAO,CAACmB,KAAT,CAFb;AAGLc,UAAAA,WAAW,EAAElB,MAAM,CAACf,OAAO,CAACiC,WAAT,CAHd;AAILC,UAAAA,KAAK,EAAEnB,MAAM,CAACU,qBAAqB,CAACzB,OAAO,CAACkC,KAAT,CAAtB,CAJR;AAKLC,UAAAA,GAAG,EAAEpB,MAAM,CAACf,OAAO,CAACmC,GAAT,CALN;AAMLC,UAAAA,IAAI,EAAE;AAND,SAAP;AAQD,OAVqB,CAAxB;AAaA,WAAKtD,QAAL,CAAc;AACZmB,QAAAA,SAAS,EAAG;AACVC,UAAAA,IAAI,EAAE4B,eADI;AAEV1B,UAAAA,MAAM,EAAE;AAFE;AADA,OAAd;AAOA,WAAKtB,QAAL,CAAc0G,SAAS,KAAK;AAAC/F,QAAAA,IAAI,EAAE,CAAC,GAAG+F,SAAS,CAAC/F,IAAd,EAAmB,GAAGqC,eAAtB;AAAP,OAAL,CAAvB;AAED,KArCD,MAqCO,IAAI,KAAKnE,KAAL,CAAWsC,SAAX,CAAqBG,MAArB,KAAgC,UAApC,EAAgD;AACrD,YAAMqF,iBAAiB,GAAG,KAAK9H,KAAL,CAAWsC,SAAX,CAAqBC,IAArB,CAA0BwF,MAA1B,CAAkC1F,OAAD,IAAa;AACtE,YAAIe,MAAM,CAACf,OAAO,CAACgC,KAAT,CAAN,CAAsBqC,WAAtB,GAAoC/C,QAApC,CAA6C,KAAK3D,KAAL,CAAWgC,UAAxD,CAAJ,EAAyE;AACvE,iBAAO,IAAP;AACD,SAFD,MAEO,IAAIoB,MAAM,CAACf,OAAO,CAACiC,WAAT,CAAN,CAA4BoC,WAA5B,GAA0C/C,QAA1C,CAAmD,KAAK3D,KAAL,CAAWgC,UAA9D,CAAJ,EAA+E;AACpF,iBAAO,IAAP;AACD,SAFM,MAEA;AACL,iBAAO,KAAP;AACD;AACF,OARyB,CAA1B;AASA,WAAKb,QAAL,CAAc0G,SAAS,KAAK;AAAC/F,QAAAA,IAAI,EAAE,CAAC,GAAG+F,SAAS,CAAC/F,IAAd,EAAmB,GAAGgG,iBAAtB;AAAP,OAAL,CAAvB;AACD;;AAED,QAAI,KAAK9H,KAAL,CAAW0C,WAAX,CAAuBD,MAAvB,KAAkC,YAAtC,EAAoD;AAClD,YAAMmC,WAAW,GAAG,+EAApB;AACA,YAAMC,eAAe,GAAG,MAAM/D,KAAK,CAAC8D,WAAD,CAAnC;AACA,YAAMlC,WAAW,GAAG,MAAMmC,eAAe,CAAC5D,IAAhB,EAA1B;AACA,YAAM+G,mBAAmB,GAAGtF,WAAW,CAACqF,MAAZ,CAAoB1F,OAAO,IACrDA,OAAO,CAACgC,KAAR,CAAcqC,WAAd,GAA4B/C,QAA5B,CAAqC,KAAK3D,KAAL,CAAWgC,UAAhD,KAA+DK,OAAO,CAACiC,WAAR,CAAoBoC,WAApB,GAAkC/C,QAAlC,CAA2C,KAAK3D,KAAL,CAAWgC,UAAtD,CADrC,CAA5B;AAGA,YAAM8C,iBAAiB,GAAGkD,mBAAmB,CAAC5D,GAApB,CACxB/B,OAAO,IAAI;AACT,eAAO;AACLgC,UAAAA,KAAK,EAAEhC,OAAO,CAACgC,KADV;AAELb,UAAAA,KAAK,EAAEnB,OAAO,CAACmB,KAAR,CAAcE,SAAd,CAAwB,CAAxB,CAFF;AAGLY,UAAAA,WAAW,EAAEjC,OAAO,CAACiC,WAHhB;AAILC,UAAAA,KAAK,EAAET,qBAAqB,CAACzB,OAAO,CAACkC,KAAT,CAJvB;AAKLC,UAAAA,GAAG,EAAEnC,OAAO,CAACmC,GALR;AAMLC,UAAAA,IAAI,EAAE;AAND,SAAP;AAQD,OAVuB,CAA1B;AAaA,WAAKtD,QAAL,CAAc;AACZmB,QAAAA,SAAS,EAAG;AACVC,UAAAA,IAAI,EAAEuC,iBADI;AAEVrC,UAAAA,MAAM,EAAE;AAFE;AADA,OAAd;AAOA,WAAKtB,QAAL,CAAc0G,SAAS,KAAK;AAAC/F,QAAAA,IAAI,EAAE,CAAC,GAAG+F,SAAS,CAAC/F,IAAd,EAAmB,GAAGgD,iBAAtB;AAAP,OAAL,CAAvB;AAED,KA7BD,MA6BO;AACL,YAAMkD,mBAAmB,GAAG,KAAKhI,KAAL,CAAW0C,WAAX,CAAuBH,IAAvB,CAA4BwF,MAA5B,CAAoC1F,OAAD,IAAa;AAC1E,YAAIe,MAAM,CAACf,OAAO,CAACgC,KAAT,CAAN,CAAsBqC,WAAtB,GAAoC/C,QAApC,CAA6C,KAAK3D,KAAL,CAAWgC,UAAxD,CAAJ,EAAyE;AACvE,iBAAO,IAAP;AACD,SAFD,MAEO,IAAIoB,MAAM,CAACf,OAAO,CAACiC,WAAT,CAAN,CAA4BoC,WAA5B,GAA0C/C,QAA1C,CAAmD,KAAK3D,KAAL,CAAWgC,UAA9D,CAAJ,EAA+E;AACpF,iBAAO,IAAP;AACD,SAFM,MAEA;AACL,iBAAO,KAAP;AACD;AACF,OAR2B,CAA5B;AASA,WAAKb,QAAL,CAAc0G,SAAS,KAAK;AAAC/F,QAAAA,IAAI,EAAE,CAAC,GAAG+F,SAAS,CAAC/F,IAAd,EAAmB,GAAGkG,mBAAtB;AAAP,OAAL,CAAvB;AACD;;AAED,QAAI,KAAKhI,KAAL,CAAW2C,YAAX,CAAwBF,MAAxB,KAAmC,YAAvC,EAAqD;AACnD,YAAMwC,YAAY,GAAG,kFAArB;AACA,YAAMC,gBAAgB,GAAG,MAAMpE,KAAK,CAACmE,YAAD,CAApC;AACA,YAAMtC,YAAY,GAAG,MAAMuC,gBAAgB,CAACjE,IAAjB,EAA3B;AACA,YAAMgH,oBAAoB,GAAGtF,YAAY,CAACoF,MAAb,CAAqB1F,OAAO,IACvDA,OAAO,CAACgC,KAAR,CAAcqC,WAAd,GAA4B/C,QAA5B,CAAqC4C,WAAW,IAAIlE,OAAO,CAACiC,WAAR,CAAoBoC,WAApB,GAAkC/C,QAAlC,CAA2C4C,WAA3C,CAApD,CAD2B,CAA7B;AAGA,YAAMpB,kBAAkB,GAAG8C,oBAAoB,CAAC7D,GAArB,CACzB/B,OAAO,IAAI;AACT,eAAO;AACLgC,UAAAA,KAAK,EAAE,KAAKjB,MAAM,CAACf,OAAO,CAACgC,KAAT,CADb;AAELb,UAAAA,KAAK,EAAE,KAAKD,mBAAmB,CAAClB,OAAO,CAACmB,KAAT,CAF1B;AAGLc,UAAAA,WAAW,EAAE,KAAKlB,MAAM,CAACf,OAAO,CAACiC,WAAT,CAHnB;AAILC,UAAAA,KAAK,EAAE,KAAKT,qBAAqB,CAACzB,OAAO,CAACkC,KAAT,CAJ5B;AAKLC,UAAAA,GAAG,EAAE,KAAKpB,MAAM,CAACf,OAAO,CAACmC,GAAT,CALX;AAMLC,UAAAA,IAAI,EAAE;AAND,SAAP;AAQD,OAVwB,CAA3B;AAaA,WAAKtD,QAAL,CAAc;AACZwB,QAAAA,YAAY,EAAG;AACbJ,UAAAA,IAAI,EAAE4C,kBADO;AAEb1C,UAAAA,MAAM,EAAE;AAFK;AADH,OAAd;AAOA,WAAKtB,QAAL,CAAc0G,SAAS,KAAK;AAAC/F,QAAAA,IAAI,EAAE,CAAC,GAAG+F,SAAS,CAAC/F,IAAd,EAAmB,GAAGqD,kBAAtB;AAAP,OAAL,CAAvB;AAED,KA7BD,MA6BO;AACL,YAAM8C,oBAAoB,GAAG,KAAKjI,KAAL,CAAW2C,YAAX,CAAwBJ,IAAxB,CAA6BwF,MAA7B,CAAqC1F,OAAD,IAAa;AAC5E,YAAIe,MAAM,CAACf,OAAO,CAACgC,KAAT,CAAN,CAAsBqC,WAAtB,GAAoC/C,QAApC,CAA6C,KAAK3D,KAAL,CAAWgC,UAAxD,CAAJ,EAAyE;AACvE,iBAAO,IAAP;AACD,SAFD,MAEO,IAAIoB,MAAM,CAACf,OAAO,CAACiC,WAAT,CAAN,CAA4BoC,WAA5B,GAA0C/C,QAA1C,CAAmD,KAAK3D,KAAL,CAAWgC,UAA9D,CAAJ,EAA+E;AACpF,iBAAO,IAAP;AACD,SAFM,MAEA;AACL,iBAAO,KAAP;AACD;AACF,OAR4B,CAA7B;AASA,WAAKb,QAAL,CAAc0G,SAAS,KAAK;AAAC/F,QAAAA,IAAI,EAAE,CAAC,GAAG+F,SAAS,CAAC/F,IAAd,EAAmB,GAAGmG,oBAAtB;AAAP,OAAL,CAAvB;AACD;;AAED,UAAMC,OAAO,GAAG,MAAMpH,KAAK,CAAE,wFAAuFyF,WAAY,oFAArG,CAA3B;AACA,UAAM4B,QAAQ,GAAG,MAAMD,OAAO,CAACjH,IAAR,EAAvB;AACA,UAAMmH,eAAe,GAAGD,QAAQ,CAACE,OAAjC;AACA,UAAMC,QAAQ,GAAGF,eAAe,CAAChE,GAAhB,CAAqB/B,OAAO,IAAI;AAC/C,aAAO;AACLgC,QAAAA,KAAK,EAAEhC,OAAO,CAACgC,KADV;AAELb,QAAAA,KAAK,EAAEnB,OAAO,CAACmB,KAFV;AAGLc,QAAAA,WAAW,EAAEjC,OAAO,CAACiC,WAHhB;AAILC,QAAAA,KAAK,EAAET,qBAAqB,CAACzB,OAAO,CAACkG,MAAR,CAAe,CAAf,EAAkBC,SAAnB,CAJvB;AAKLhE,QAAAA,GAAG,EAAEnC,OAAO,CAACmC,GALR;AAMLC,QAAAA,IAAI,EAAE;AAND,OAAP;AAQD,KATgB,CAAjB;AAWA,SAAKtD,QAAL,CAAc0G,SAAS,KAAK;AAAC/F,MAAAA,IAAI,EAAE,CAAC,GAAG+F,SAAS,CAAC/F,IAAd,EAAmB,GAAGwG,QAAtB;AAAP,KAAL,CAAvB;AAEA,UAAMG,eAAe,GAAG,MAAM3H,KAAK,CAAE,yDAAwDyF,WAAY,mMAAtE,CAAnC;AACA,UAAMmC,MAAM,GAAG,MAAMD,eAAe,CAACxH,IAAhB,EAArB;AACA,UAAM0H,SAAS,GAAGD,MAAM,CAACE,KAAzB;AACA,UAAMC,gBAAgB,GAAGF,SAAS,CAACvE,GAAV,CAAe/B,OAAO,IAAI;AACjD,aAAO;AACLgC,QAAAA,KAAK,EAAEhC,OAAO,CAACgC,KADV;AAELb,QAAAA,KAAK,EAAE,CAFF;AAGLc,QAAAA,WAAW,EAAEjC,OAAO,CAACyG,OAHhB;AAILvE,QAAAA,KAAK,EAAEyC,uBAAuB,CAAC3E,OAAD,CAJzB;AAKLmC,QAAAA,GAAG,EAAEnC,OAAO,CAACmC,GALR;AAMLC,QAAAA,IAAI,EAAE;AAND,OAAP;AAQD,KATwB,CAAzB;AAWA,SAAKtD,QAAL,CAAc0G,SAAS,KAAK;AAAC/F,MAAAA,IAAI,EAAE,CAAC,GAAG+F,SAAS,CAAC/F,IAAd,EAAmB,GAAG+G,gBAAtB;AAAP,KAAL,CAAvB;;AAEA,aAASxC,OAAT,CAAkBH,CAAlB,EAAqBC,CAArB,EAAyB;AACvB,UAAKC,MAAM,CAACF,CAAC,CAAC1C,KAAH,CAAN,GAAkB4C,MAAM,CAACD,CAAC,CAAC3C,KAAH,CAA7B,EAAwC;AACtC,eAAO,CAAP;AACD;;AACD,UAAK4C,MAAM,CAACF,CAAC,CAAC1C,KAAH,CAAN,GAAkB4C,MAAM,CAACD,CAAC,CAAC3C,KAAH,CAA7B,EAAwC;AACtC,eAAO,CAAC,CAAR;AACD;;AACD,aAAO,CAAP;AACD;;AAED,aAASyC,MAAT,CAAiBC,CAAjB,EAAoBC,CAApB,EAAwB;AACtB,UAAKC,MAAM,CAACF,CAAC,CAAC1C,KAAH,CAAN,GAAkB4C,MAAM,CAACD,CAAC,CAAC3C,KAAH,CAA7B,EAAwC;AACtC,eAAO,CAAC,CAAR;AACD;;AACD,UAAK4C,MAAM,CAACF,CAAC,CAAC1C,KAAH,CAAN,GAAkB4C,MAAM,CAACD,CAAC,CAAC3C,KAAH,CAA7B,EAAwC;AACtC,eAAO,CAAP;AACD;;AACD,aAAO,CAAP;AACD;;AAED,aAASgC,YAAT,CAAsBC,KAAtB,EAA6B;AAC3B,WAAK,IAAIC,CAAC,GAAGD,KAAK,CAACE,MAAN,GAAe,CAA5B,EAA+BD,CAAC,GAAG,CAAnC,EAAsCA,CAAC,EAAvC,EAA2C;AACvC,YAAIE,CAAC,GAAGC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,MAAiBL,CAAC,GAAG,CAArB,CAAX,CAAR;AACA,YAAIM,IAAI,GAAGP,KAAK,CAACC,CAAD,CAAhB;AACAD,QAAAA,KAAK,CAACC,CAAD,CAAL,GAAWD,KAAK,CAACG,CAAD,CAAhB;AACAH,QAAAA,KAAK,CAACG,CAAD,CAAL,GAAWI,IAAX;AACH;;AACD,aAAOP,KAAP;AACH;;AACG,SAAKzF,KAAL,CAAW+B,cAAX,KAA8B,gBAA9B,GAAiD,KAAKZ,QAAL,CAAc0G,SAAS,KAAK;AAAC/F,MAAAA,IAAI,EAAE0D,YAAY,CAACqC,SAAS,CAAC/F,IAAX,CAAnB;AAAqCG,MAAAA,OAAO,EAAE;AAA9C,KAAL,CAAvB,CAAjD,GACC,KAAKjC,KAAL,CAAW+B,cAAX,KAA8B,uBAA9B,GAAwD,KAAKZ,QAAL,CAAc0G,SAAS,KAAK;AAAC/F,MAAAA,IAAI,EAAE+F,SAAS,CAAC/F,IAAV,CAAewE,IAAf,CAAoBD,OAApB,CAAP;AAAqCpE,MAAAA,OAAO,EAAE;AAA9C,KAAL,CAAvB,CAAxD,GACA,KAAKjC,KAAL,CAAW+B,cAAX,KAA8B,sBAA9B,GAAuD,KAAKZ,QAAL,CAAc0G,SAAS,KAAK;AAAC/F,MAAAA,IAAI,EAAE+F,SAAS,CAAC/F,IAAV,CAAewE,IAAf,CAAoBL,MAApB,CAAP;AAAoChE,MAAAA,OAAO,EAAE;AAA7C,KAAL,CAAvB,CAAvD,GACA,KAAKd,QAAL,CAAc0G,SAAS,KAAK;AAAC/F,MAAAA,IAAI,EAAE+F,SAAS,CAAC/F,IAAjB;AAAuBG,MAAAA,OAAO,EAAE;AAAhC,KAAL,CAAvB,CAHD;AAKJ/B,IAAAA,OAAO,CAAC6I,OAAR,CAAgB,iBAAhB;AACC;;AAEDnG,EAAAA,YAAY,CAAC2D,WAAD,EAAc;AACxB,SAAKpF,QAAL,CAAc;AAAEa,MAAAA,UAAU,EAAEuE;AAAd,KAAd;AACA,SAAKzD,OAAL,CAAayD,WAAb;AAED;;AAEDtD,EAAAA,WAAW,CAACZ,OAAD,EAAU;AACnB,QAAI,KAAKrC,KAAL,CAAWmC,YAAX,CAAwBC,OAAxB,KAAoC,IAAxC,EAA+C;AAC7C,WAAKjB,QAAL,CAAc;AACZgB,QAAAA,YAAY,EAAE;AACZC,UAAAA,OAAO,EAAE,KADG;AAEZC,UAAAA,OAAO,EAAE;AAFG;AADF,OAAd;AAMD,KAPD,MAOO;AACL,WAAKlB,QAAL,CAAc;AACZgB,QAAAA,YAAY,EAAE;AACZC,UAAAA,OAAO,EAAE,IADG;AAEZC,UAAAA,OAAO,EAAEA;AAFG;AADF,OAAd;AAMH;AACF;;AACDa,EAAAA,mBAAmB,CAACb,OAAD,EAAU2G,SAAV,EAAqB;AACpC,QAAIC,yBAAyB,GAAG,KAAKjJ,KAAL,CAAW8B,IAAX,CAAgB8B,OAAhB,CAAwBvB,OAAxB,CAAhC;;AAEA,QAAI2G,SAAS,KAAK,MAAlB,EAA0B;AACxB,WAAK7H,QAAL,CAAe0G,SAAD,KAAgB;AAC5B1F,QAAAA,YAAY,EAAE;AACZC,UAAAA,OAAO,EAAE,IADG;AAEZC,UAAAA,OAAO,EAAEwF,SAAS,CAAC/F,IAAV,CAAemH,yBAAyB,GAAG,CAA3C;AAFG;AADc,OAAhB,CAAd;AAMD,KAPD,MAOO,IAAID,SAAS,KAAK,UAAd,IAA4BC,yBAAyB,GAAG,CAA5D,EAA+D;AACpE,WAAK9H,QAAL,CAAe0G,SAAD,KAAgB;AAC5B1F,QAAAA,YAAY,EAAE;AACZC,UAAAA,OAAO,EAAE,IADG;AAEZC,UAAAA,OAAO,EAAEwF,SAAS,CAAC/F,IAAV,CAAemH,yBAAyB,GAAG,CAA3C;AAFG;AADc,OAAhB,CAAd;AAMD,KAPM,MAOA;AACL;AACD;AAGF;;AAEDC,EAAAA,MAAM,GAAG;AACP,wBACE;AAAK,MAAA,SAAS,EAAC,iDAAf;AAAA,iBACK,KAAKlJ,KAAL,CAAWmC,YAAX,CAAwBC,OAAxB,gBAAkC,QAAC,YAAD;AAAc,QAAA,mBAAmB,EAAE,KAAKc,mBAAxC;AAA6D,QAAA,OAAO,EAAE,KAAKlD,KAAL,CAAWmC,YAAX,CAAwBC,OAA9F;AAAuG,QAAA,OAAO,EAAE,KAAKpC,KAAL,CAAWmC,YAAX,CAAwBE,OAAxI;AAAiJ,QAAA,WAAW,EAAE,KAAKY;AAAnK;AAAA;AAAA;AAAA;AAAA,cAAlC,GAAsN,IAD3N,eAEI,QAAC,SAAD;AAAW,QAAA,QAAQ,EAAE,KAAKL;AAA1B;AAAA;AAAA;AAAA;AAAA,cAFJ,EAKK,KAAK5C,KAAL,CAAWkC,OAAX,gBAAqB,QAAC,OAAD;AAAA;AAAA;AAAA;AAAA,cAArB,GAAmC,IALxC,EAMK,KAAKlC,KAAL,CAAWiC,OAAX,GAAqB,IAArB,gBAA4B,QAAC,OAAD;AAAS,QAAA,IAAI,EAAE,KAAKjC,KAAL,CAAW8B,IAA1B;AACrB,QAAA,cAAc,EAAE,KAAK9B,KAAL,CAAW+B,cADN;AAErB,QAAA,aAAa,EAAE,KAAKgB,aAFC;AAGrB,QAAA,UAAU,EAAE,KAAK/C,KAAL,CAAWgC,UAHF;AAIrB,QAAA,MAAM,EAAE,KAAKY,YAJQ;AAKrB,QAAA,WAAW,EAAE,KAAKK;AALG;AAAA;AAAA;AAAA;AAAA,cANjC,EAcK,KAAKjD,KAAL,CAAWiC,OAAX,gBAAqB,QAAC,UAAD;AAAA;AAAA;AAAA;AAAA,cAArB,gBAAsC;AAAA;AAAA;AAAA;AAAA,cAd3C;AAAA;AAAA;AAAA;AAAA;AAAA,YADF;AAmBD;;AAlqB+B;;AAqqBlC,eAAeP,GAAf","sourcesContent":["import React from 'react';\nimport \"tailwindcss/tailwind.css\"\n\nimport { SearchBar } from './Components/SearchBar';\nimport { Results } from './Components/Results';\nimport { Landing } from './Components/Landing';\nimport { LoadingPop } from './Components/LoadingPop';\nimport { PopUpListing } from './Components/PopUpListing';\n\n\nimport imagePlaceholder from './assets/gallery.png';\n\nimport { hotjar } from 'react-hotjar';\n\nconst appLoaded = Date.now()\nfunction getEbayAccessToken() {\n  if (Date.now() > this.state.ExpiryDate) {\n    console.log(\"this app does not have an access token, getting access token\")\n\n    var myHeaders = new Headers();\n    myHeaders.append(\"Authorization\", \"Basic Sm9zZXBoVW4tTG9tYS1QUkQtMTk5YWQwZDkwLWY0Y2QyYjg4OlBSRC05OWFkMGQ5MDRiYjEtZjYzMS00OGMyLTkwNTQtYTQ5Yg==\");\n    myHeaders.append(\"Content-Type\", \"application/x-www-form-urlencoded\");\n    myHeaders.append(\"Cookie\", \"ebay=%5Esbf%3D%23%5E; dp1=bu1p/QEBfX0BAX19AQA**6379634c^\");\n    \n    var urlencoded = new URLSearchParams();\n    urlencoded.append(\"grant_type\", \"client_credentials\");\n    urlencoded.append(\"scope\", \"https://api.ebay.com/oauth/api_scope\");\n    \n    var requestOptions = {\n      method: 'POST',\n      headers: myHeaders,\n      body: urlencoded,\n      redirect: 'follow'\n    };\n    \n    fetch(\"https://loma-cors.herokuapp.com/https://api.ebay.com/identity/v1/oauth2/token\", requestOptions)\n        .then(response => response.json())\n        .then(jsonresponse => {\n          this.setState({\n            AccessToken: jsonresponse.access_token,\n            ExpiryDate: Date.now() + jsonresponse.expires_in * 1000\n          })\n          let accessTokenSet = Date.now() - appLoaded;\n          console.log(`apiAccessToken = ${this.state.AccessToken}, took ${accessTokenSet} milliseconds`);\n        })\n        .catch(error => console.log('error', error));\n      } \n  }\n\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      Data: [],\n      AccessToken: \"none\",\n      ExpiryDate: 0,\n      resultsDisplay: \"⚡️ Trending ⚡️\",\n      searchTerm: \"\",\n      loading: false,\n      landing: true,\n      popUpListing: {\n        display: false,\n        listing: {}\n      },\n      depopData: {\n        data: [{nothing : \"none\"}],\n        status: 'unresolved'\n      },\n      gumtreeData: {\n        data: [{nothing : \"none\"}],\n        status: 'unresolved'\n      },\n      facebookData: {\n        data: [{nothing : \"none\"}],\n        status: 'unresolved'\n      }\n    }\n    this.handleChange = this.handleChange.bind(this);\n    this.setData = this.setData.bind(this);\n    this.toggleDisplay = this.toggleDisplay.bind(this);\n    this.reOrderDisplay = this.reOrderDisplay.bind(this);\n    this.togglePopUp = this.togglePopUp.bind(this);\n    this.changeActiveListing = this.changeActiveListing.bind(this);\n  }\n\n  componentDidMount() {\n    const appLoaded = Date.now()\n    \n    ///////DATA CLEANERS\n    const isNull = (property) => {\n      if (property === null || property === undefined) {\n     return \" \";\n     } else {\n       return property;\n     }\n     };\n\n     const facebookPriceParsed = (price) => {\n      let rawPrice = price.substring(1);\n      if (!price || price === \"FREE\") {\n        return \"0\"\n      } else if (price === \"See listings near me\") {\n        return \"~\"\n      } else if (!rawPrice.includes(\"£\")){\n        return rawPrice;\n      } else if (rawPrice.includes(\"£\")) {\n        return rawPrice.substring(0, rawPrice.indexOf(\"£\"));\n      }\n    };\n     \n\n     const isPriceNull = (price) => {\n      if (price === undefined || price === null) {\n        return \"~\";\n      } else {\n        return price.substring(1)\n      }\n    };\n\n    const missingImagesFiltered = (imageProp) => {\n      if (imageProp === null || imageProp === undefined) {\n        return imagePlaceholder;\n      } else {\n        return imageProp;\n      }\n    }\n    //\n\n    const getDepopData = async () => {\n      console.log(\"getting depop data\")\n    \n    const depop_url = \"https://api.apify.com/v2/datasets/ml97NZifdmN1EFUSb/items?clean=true&format=json\";\n    const depopResponse = await fetch(depop_url);\n    const depopData = await depopResponse.json();\n\n    const depopDataParsed = await depopData.map(\n      (listing) => {\n        return {\n          title: isNull(listing.title),\n          price: isPriceNull(listing.price),\n          description: isNull(listing.description),\n          image: isNull(missingImagesFiltered(listing.image)),\n          url: isNull(listing.url),\n          site: \"depop\"\n        }\n      }\n    );\n\n    this.setState({\n      depopData : {\n        data: depopDataParsed,\n        status: 'resolved'\n      }\n    })\n\n    let depopDataSetTime = Date.now() - appLoaded\n\n    console.log(\"depop data has been set, it took this many milliseconds: \" + depopDataSetTime);\n\n    }\n\n///\n\n    const getGumtreeData = async () => {\n      console.log(\"getting gumtree data\")\n    \n      const gumtree_url = \"https://api.apify.com/v2/datasets/Dh5XzAb9fvidWw285/items?format=json&clean=1\"\n      const gumtreeResponse = await fetch(gumtree_url);\n      const gumtreeData = await gumtreeResponse.json();\n  \n      const gumtreeDataParsed = await gumtreeData.map(\n        listing => {\n          return {\n            title: listing.title,\n            price: listing.price.substring(1),\n            description: listing.description,\n            image: missingImagesFiltered(listing.image),\n            url: listing.url,\n            site: \"gumtree\"\n          }\n        }\n      )\n\n    this.setState({\n      gumtreeData : {\n        data: gumtreeDataParsed,\n        status: 'resolved'\n      }\n    })\n    let gumtreeDataSetTime = Date.now() - appLoaded\n\n    console.log(\"gumtree data has been set, it took this many milliseconds: \" + gumtreeDataSetTime);\n\n    }\n\n\n    ///\n\n    const getFacebookData = async () => {\n      console.log(\"getting facebook data\")\n    \n      const facebook_url = \"https://api.apify.com/v2/datasets/IitkxYE95yydtzFlk/items?clean=true&format=json\"\n      const facebookResponse = await fetch(facebook_url);\n      const facebookData = await facebookResponse.json();\n  \n      const facebookDataParsed = facebookData.map(\n        listing => {\n          return {\n            title: \"\" + isNull(listing.title),\n            price: \"\" + facebookPriceParsed(listing.price),\n            description: \"\" + isNull(listing.description),\n            image: \"\" + missingImagesFiltered(listing.image),\n            url: \"\" + isNull(listing.url),\n            site: \"facebook\"\n          }\n        }\n      )\n  \n  \n\n    this.setState({\n      facebookData : {\n        data: facebookDataParsed,\n        status: 'resolved'\n      }\n    })\n\n    let facebookDataSetTime = Date.now() - appLoaded\n\n    console.log(\"facebook data has been set, it took this many milliseconds: \" + facebookDataSetTime);\n\n    }\n\n\n    ///////\n    getEbayAccessToken();\n    getDepopData();\n    getGumtreeData();\n    getFacebookData();\n    hotjar.initialize(2123002,6);\n    console.log(\"access token\" +  this.state.AccessToken);\n    \n  } //COMPONENT MOUNT ENDS\n\n  toggleLanding() {\n    this.setState({\n      landing: true,\n    }) \n  }\n\n   toggleDisplay(sortOrder) {\n    this.setState({ resultsDisplay: sortOrder});\n    console.log(sortOrder)\n    console.log(\"the display mode is now\" + this.state.resultsDisplay);\n    this.reOrderDisplay();\n  }\n\n  reOrderDisplay() {\n    /// functions\n\n    function shuffleArray(array) {\n      for (var i = array.length - 1; i > 0; i--) {\n          var j = Math.floor(Math.random() * (i + 1));\n          var temp = array[i];\n          array[i] = array[j];\n          array[j] = temp;\n      }\n      return array;\n  }\n\n  function lowest( a, b ) {\n    if ( Number(a.price) < Number(b.price) ){\n      return 1;\n    }\n    if ( Number(a.price) > Number(b.price) ){\n      return -1;\n    }\n    return 0;\n  }\n\n  function highest( a, b ) {\n    if ( Number(a.price) < Number(b.price) ){\n      return -1;\n    }\n    if ( Number(a.price) > Number(b.price) ){\n      return 1;\n    }\n    return 0;\n  } \n\n\n  if (this.state.Data) {\n      if (this.state.resultsDisplay === \"⚡️ Trending ⚡️\") {\n        this.setState({Data: shuffleArray(this.state.Data)})\n      } else if (this.state.resultsDisplay === \"Highest price first ▲\") {\n        this.setState({Data: this.state.Data.sort(highest)})\n      } else if (this.state.resultsDisplay === \"Lowest price first ▼\") {\n        this.setState({Data: this.state.Data.sort(lowest)}) }\n        else {\n          this.setState({})}\n        }\n  }\n\n  async setData(searchQuery) {\n    if (!searchQuery) {\n      alert(\"Tell me what to search! 😁\");\n      return;\n    }\n\n    console.time(\"complete search\")\n\n    this.setState({searchTerm: searchQuery.toLowerCase(), loading: true, landing: false});\n    \n    if (Date.now() > this.state.ExpiryDate) {\n      console.log(\"this app does not have an access token! Getting access token\")\n\n      var myHeaders = new Headers();\n      myHeaders.append(\"Authorization\", \"Basic Sm9zZXBoVW4tTG9tYS1QUkQtMTk5YWQwZDkwLWY0Y2QyYjg4OlBSRC05OWFkMGQ5MDRiYjEtZjYzMS00OGMyLTkwNTQtYTQ5Yg==\");\n      myHeaders.append(\"Content-Type\", \"application/x-www-form-urlencoded\");\n      myHeaders.append(\"Cookie\", \"ebay=%5Esbf%3D%23%5E; dp1=bu1p/QEBfX0BAX19AQA**6379634c^\");\n      \n      var urlencoded = new URLSearchParams();\n      urlencoded.append(\"grant_type\", \"client_credentials\");\n      urlencoded.append(\"scope\", \"https://api.ebay.com/oauth/api_scope\");\n      \n      var requestOptions = {\n        method: 'POST',\n        headers: myHeaders,\n        body: urlencoded,\n        redirect: 'follow'\n      };\n      \n      fetch(\"https://loma-cors.herokuapp.com/https://api.ebay.com/identity/v1/oauth2/token\", requestOptions)\n          .then(response => response.json())\n          .then(jsonresponse => {\n            this.setState({\n              AccessToken: jsonresponse.access_token,\n              ExpiryDate: new Date().getTime() + jsonresponse.expires_in * 1000\n            })\n          })\n          .catch(error => console.log('error', error));\n    } else {\n      console.log(\"this has an access token\" + this.state.AccessToken.substring(10,25));\n    }\n\n    // console.log(\"access token\" + this.state.AccessToken);\n   // let formattedExpiryDate = this.state.ExpiryDate * 1000;\n    //console.log(formattedExpiryDate.toUTCString())\n\n\n\n    /////////////////////DATA CLEANERS///////////////////////////\n    const isNull = (property) => {\n      if (property === null || property === undefined) {\n      return \" \";\n      } else {\n        return property;\n      }\n    };\n\n    const isPriceNull = (price) => {\n      if (price === undefined || price === null) {\n        return \"~\";\n      } else {\n        return price.substring(1)\n      }\n    };\n\n    const ebayPriceParsed = (listing) => {\n      if (listing.price.currency === \"USD\") {\n        return listing.price.convertedFromValue ? listing.price.convertedFromValue : listing.price.value;\n      } else {\n        return listing.price.value;\n      }\n    };\n\n    const facebookPriceParsed = (price) => {\n      let rawPrice = price.substring(1);\n      if (!price || price === \"FREE\") {\n        return \"0\"\n      } else if (price === \"See listings near me\") {\n        return \"~\"\n      } else if (!rawPrice.includes(\"£\")){\n        return rawPrice;\n      } else if (rawPrice.includes(\"£\")) {\n        return rawPrice.substring(0, rawPrice.indexOf(\"£\"));\n      }\n    };\n\n    const missingImagesFiltered = (imageProp) => {\n      if (imageProp === null || imageProp === undefined) {\n        return imagePlaceholder;\n      } else {\n        return imageProp;\n      }\n    }\n\n    const tnmissingImagesFiltered = (listing) => {\n      if (!listing.photos) {\n        return imagePlaceholder\n      } else {\n        return listing.photos[0].url;\n      }\n    }\n\n    const eBayMissingImagesFiltered = (listing) => {\n      if (!listing.hasOwnProperty(\"image\") || !listing.image.hasOwnProperty(\"imageUrl\")) {\n        return imagePlaceholder;\n      } else {\n        return listing.thumbnailImages[0].imageUrl;\n      }\n    }\n    /////END OF CLEANER FUNCTIONS\n    /////GET EBAY DATA\n\n    var ebayHeaders = new Headers();\n    ebayHeaders.append(\"Authorization\", `Bearer ${this.state.AccessToken}`);\n    ebayHeaders.append(\"Content-Type\", \"application/json\");\n    ebayHeaders.append(\"X-EBAY-C-MARKETPLACE-ID\", \"EBAY_US\");\n    ebayHeaders.append(\"X-EBAY-C-ENDUSERCTX\", \"affiliateCampaignId=<ePNCampaignId>,affiliateReferenceId=<referenceId>\");\n    \n    var ebayrequestOptions = {\n      method: 'GET',\n      headers: ebayHeaders,\n      redirect: 'follow'\n    };   \n\n    \n    const ebayresponse = await fetch(`https://loma-cors.herokuapp.com/https://api.ebay.com/buy/browse/v1/item_summary/search?q=${searchQuery}&limit=200&filter=conditions:{UNSPECIFIED|USED},itemLocationCountry:GB&fieldgroups=EXTENDED`, ebayrequestOptions);\n    const jsonresponse = await ebayresponse.json();\n    const ebayDataParsed = () => {\n      if (jsonresponse.itemSummaries) {\n          return jsonresponse.itemSummaries.map(\n            (listing) => {\n                return {\n                    title: isNull(listing.title),\n                    description: isNull(listing.shortDescription),\n                    price: isNull(ebayPriceParsed(listing)),\n                    image: eBayMissingImagesFiltered(listing),\n                    url: isNull(listing.itemWebUrl),\n                    site: \"ebay\"\n                }\n            }\n        )\n      } else { \n        return [];\n      }\n    }\n\n    this.setState(prevState => ({Data: [...prevState.Data,...ebayDataParsed()]}));\n\n    /////////////GET DEPOP DATA\n\n    if (this.state.depopData.status === \"unresolved\") {\n      const depop_url = \"https://api.apify.com/v2/datasets/ml97NZifdmN1EFUSb/items?clean=true&format=json\";\n      const depopResponse = await fetch(depop_url);\n      const depopData = await depopResponse.json();\n      const depopDataFiltered = depopData.filter( (listing) => {\n        if (isNull(listing.title).toLowerCase().includes(this.state.searchTerm)) {\n          return true;\n        } else if (isNull(listing.description).toLowerCase().includes(this.state.searchTerm)) {\n          return true;\n        } else {\n          return false;\n        }\n      })\n        // || isNull(listing.description).includes(this.state.searchTerm));\n      \n      const depopDataParsed = depopDataFiltered.map(\n        (listing) => {\n          return {\n            title: isNull(listing.title),\n            price: isPriceNull(listing.price),\n            description: isNull(listing.description),\n            image: isNull(missingImagesFiltered(listing.image)),\n            url: isNull(listing.url),\n            site: \"depop\"\n          }\n        }\n      )\n\n      this.setState({\n        depopData : {\n          data: depopDataParsed,\n          status: 'resolved'\n        }\n      });\n\n      this.setState(prevState => ({Data: [...prevState.Data,...depopDataParsed]}));\n\n    } else if (this.state.depopData.status === \"resolved\") {\n      const depopDataFiltered = this.state.depopData.data.filter((listing) => {\n        if (isNull(listing.title).toLowerCase().includes(this.state.searchTerm)) {\n          return true;\n        } else if (isNull(listing.description).toLowerCase().includes(this.state.searchTerm)) {\n          return true;\n        } else {\n          return false;\n        }\n      });\n      this.setState(prevState => ({Data: [...prevState.Data,...depopDataFiltered]}));\n    }\n    \n    if (this.state.gumtreeData.status === \"unresolved\") {\n      const gumtree_url = \"https://api.apify.com/v2/datasets/Dh5XzAb9fvidWw285/items?format=json&clean=1\"\n      const gumtreeResponse = await fetch(gumtree_url);\n      const gumtreeData = await gumtreeResponse.json();\n      const gumtreeDataFiltered = gumtreeData.filter( listing =>\n        listing.title.toLowerCase().includes(this.state.searchTerm) || listing.description.toLowerCase().includes(this.state.searchTerm));\n  \n      const gumtreeDataParsed = gumtreeDataFiltered.map(\n        listing => {\n          return {\n            title: listing.title,\n            price: listing.price.substring(1),\n            description: listing.description,\n            image: missingImagesFiltered(listing.image),\n            url: listing.url,\n            site: \"gumtree\"\n          }\n        }\n      )\n\n      this.setState({\n        depopData : {\n          data: gumtreeDataParsed,\n          status: 'resolved'\n        }\n      });\n\n      this.setState(prevState => ({Data: [...prevState.Data,...gumtreeDataParsed]}));\n\n    } else {\n      const gumtreeDataFiltered = this.state.gumtreeData.data.filter((listing) => {\n        if (isNull(listing.title).toLowerCase().includes(this.state.searchTerm)) {\n          return true;\n        } else if (isNull(listing.description).toLowerCase().includes(this.state.searchTerm)) {\n          return true;\n        } else {\n          return false;\n        }\n      });\n      this.setState(prevState => ({Data: [...prevState.Data,...gumtreeDataFiltered]}));\n    }\n\n    if (this.state.facebookData.status === \"unresolved\") {\n      const facebook_url = \"https://api.apify.com/v2/datasets/IitkxYE95yydtzFlk/items?clean=true&format=json\"\n      const facebookResponse = await fetch(facebook_url);\n      const facebookData = await facebookResponse.json();\n      const facebookDataFiltered = facebookData.filter( listing =>\n        listing.title.toLowerCase().includes(searchQuery || listing.description.toLowerCase().includes(searchQuery)));\n  \n      const facebookDataParsed = facebookDataFiltered.map(\n        listing => {\n          return {\n            title: \"\" + isNull(listing.title),\n            price: \"\" + facebookPriceParsed(listing.price),\n            description: \"\" + isNull(listing.description),\n            image: \"\" + missingImagesFiltered(listing.image),\n            url: \"\" + isNull(listing.url),\n            site: \"facebook\"\n          }\n        }\n      )\n\n      this.setState({\n        facebookData : {\n          data: facebookDataParsed,\n          status: 'resolved'\n        }\n      });\n      \n      this.setState(prevState => ({Data: [...prevState.Data,...facebookDataParsed]}));\n\n    } else {\n      const facebookDataFiltered = this.state.facebookData.data.filter((listing) => {\n        if (isNull(listing.title).toLowerCase().includes(this.state.searchTerm)) {\n          return true;\n        } else if (isNull(listing.description).toLowerCase().includes(this.state.searchTerm)) {\n          return true;\n        } else {\n          return false;\n        }\n      });\n      this.setState(prevState => ({Data: [...prevState.Data,...facebookDataFiltered]}));\n    }\n\n    const etsyRaw = await fetch(`https://loma-cors.herokuapp.com/https://openapi.etsy.com/v2/listings/active?keywords=${searchQuery}&tags=vintage&limit=200&region=GB&api_key=sh1n3isgj6bax7eotlor7m4s&includes=Images`);\n    const etsyJson = await etsyRaw.json();\n    const etsyDataResults = etsyJson.results;\n    const etsyData = etsyDataResults.map( listing => {\n      return {\n        title: listing.title,\n        price: listing.price,\n        description: listing.description,\n        image: missingImagesFiltered(listing.Images[0].url_570xN),\n        url: listing.url,\n        site: \"etsy\"\n      }\n    });\n\n    this.setState(prevState => ({Data: [...prevState.Data,...etsyData]}));\n\n    const trashnothingRaw = await fetch(`https://trashnothing.com/api/v1.2/posts/search?search=${searchQuery}&sort_by=relevance&types=offer&sources=trashnothing&per_page=50&page=4&device_pixel_ratio=1&latitude=51.507351&longitude=-0.127758&radius=200000&api_key=yr8sVaHEvbdkdunSFfPoDpqlwEjxIuqB3XhyFzx1`);\n    const tnJson = await trashnothingRaw.json();\n    const tnResults = tnJson.posts;\n    const trashNothingData = tnResults.map( listing => {\n      return {\n        title: listing.title,\n        price: 0,\n        description: listing.content,\n        image: tnmissingImagesFiltered(listing),\n        url: listing.url,\n        site: \"trashnothing\"\n      }\n    });\n\n    this.setState(prevState => ({Data: [...prevState.Data,...trashNothingData]}));\n\n    function highest( a, b ) {\n      if ( Number(a.price) < Number(b.price) ){\n        return 1;\n      }\n      if ( Number(a.price) > Number(b.price) ){\n        return -1;\n      }\n      return 0;\n    }\n\n    function lowest( a, b ) {\n      if ( Number(a.price) < Number(b.price) ){\n        return -1;\n      }\n      if ( Number(a.price) > Number(b.price) ){\n        return 1;\n      }\n      return 0;\n    } \n\n    function shuffleArray(array) {\n      for (var i = array.length - 1; i > 0; i--) {\n          var j = Math.floor(Math.random() * (i + 1));\n          var temp = array[i];\n          array[i] = array[j];\n          array[j] = temp;\n      }\n      return array;\n  }\n      this.state.resultsDisplay === \"⚡️ Trending ⚡️\" ? this.setState(prevState => ({Data: shuffleArray(prevState.Data), loading: false}))\n     : this.state.resultsDisplay === \"Highest price first ▲\" ? this.setState(prevState => ({Data: prevState.Data.sort(highest), loading: false}))\n     : this.state.resultsDisplay === \"Lowest price first ▼\" ? this.setState(prevState => ({Data: prevState.Data.sort(lowest), loading: false}))\n     : this.setState(prevState => ({Data: prevState.Data, loading: false}))\n\n  console.timeEnd(\"complete search\")\n  }\n\n  handleChange(searchQuery) {\n    this.setState({ searchTerm: searchQuery });\n    this.setData(searchQuery);\n\n  }\n\n  togglePopUp(listing) {\n    if (this.state.popUpListing.display === true ) {\n      this.setState({\n        popUpListing: {\n          display: false,\n          listing: {}\n        }\n      })\n    } else {\n      this.setState({\n        popUpListing: {\n          display: true,\n          listing: listing\n        }\n      })\n  }\n} \nchangeActiveListing(listing, direction) {\n    let currentActiveListingIndex = this.state.Data.indexOf(listing);\n\n    if (direction === \"next\") {\n      this.setState((prevState) => ({\n        popUpListing: {\n          display: true,\n          listing: prevState.Data[currentActiveListingIndex + 1]\n        }\n      }))\n    } else if (direction === \"previous\" && currentActiveListingIndex > 0) {\n      this.setState((prevState) => ({\n        popUpListing: {\n          display: true,\n          listing: prevState.Data[currentActiveListingIndex - 1]\n        }\n      }))\n    } else {\n      return;\n    }\n    \n\n  }\n  \n  render() {\n    return (\n      <div className=\"App w-100 h-full bg-white overflow-x-hidden z-0\">\n          {this.state.popUpListing.display ? <PopUpListing changeActiveListing={this.changeActiveListing} display={this.state.popUpListing.display} listing={this.state.popUpListing.listing} togglePopUp={this.togglePopUp}/> : null}\n          <SearchBar onChange={this.handleChange}/>\n          \n\n          {this.state.landing ? <Landing /> : null } \n          {this.state.loading ? null : <Results Data={this.state.Data}\n                  resultsDisplay={this.state.resultsDisplay}\n                  toggleResults={this.toggleDisplay}\n                  searchTerm={this.state.searchTerm}\n                  search={this.handleChange}\n                  togglePopUp={this.togglePopUp}\n                  />}\n         \n          {this.state.loading ? <LoadingPop /> : <p></p>}\n  \n      </div>\n    );\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}