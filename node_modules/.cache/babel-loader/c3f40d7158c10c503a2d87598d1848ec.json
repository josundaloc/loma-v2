{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _toConsumableArray from\"/Users/joseph/Code/lomav2/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"/Users/joseph/Code/lomav2/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/joseph/Code/lomav2/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/joseph/Code/lomav2/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/joseph/Code/lomav2/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/joseph/Code/lomav2/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/joseph/Code/lomav2/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/joseph/Code/lomav2/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import\"tailwindcss/tailwind.css\";import{SearchBar}from'./Components/SearchBar';import{Results}from'./Components/Results';import{Landing}from'./Components/Landing';import{LoadingPop}from'./Components/LoadingPop';import{PopUpListing}from'./Components/PopUpListing';import imagePlaceholder from'./assets/gallery.png';import{hotjar}from'react-hotjar';var App=/*#__PURE__*/function(_React$Component){_inherits(App,_React$Component);var _super=_createSuper(App);function App(props){var _this;_classCallCheck(this,App);_this=_super.call(this,props);_this.state={Data:[],AccessToken:\"none\",ExpiryDate:0,resultsDisplay:\"‚ö°Ô∏è Trending ‚ö°Ô∏è\",searchTerm:\"\",loading:false,landing:true,popUpListing:{display:false,listing:{}},depopData:{data:[{nothing:\"none\"}],status:'unresolved'},gumtreeData:{data:[{nothing:\"none\"}],status:'unresolved'},facebookData:{data:[{nothing:\"none\"}],status:'unresolved'}};_this.handleChange=_this.handleChange.bind(_assertThisInitialized(_this));_this.setData=_this.setData.bind(_assertThisInitialized(_this));_this.reOrderDisplay=_this.reOrderDisplay.bind(_assertThisInitialized(_this));_this.togglePopUp=_this.togglePopUp.bind(_assertThisInitialized(_this));_this.changeActiveListing=_this.changeActiveListing.bind(_assertThisInitialized(_this));return _this;}_createClass(App,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;/////////FUNCTIONS AND CONSTANTS\nvar appLoaded=Date.now();var getEbayAccessToken=function getEbayAccessToken(){if(Date.now()>_this2.state.ExpiryDate){console.log(\"this app does not have an access token, getting access token\");var myHeaders=new Headers();myHeaders.append(\"Authorization\",\"Basic Sm9zZXBoVW4tTG9tYS1QUkQtMTk5YWQwZDkwLWY0Y2QyYjg4OlBSRC05OWFkMGQ5MDRiYjEtZjYzMS00OGMyLTkwNTQtYTQ5Yg==\");myHeaders.append(\"Content-Type\",\"application/x-www-form-urlencoded\");myHeaders.append(\"Cookie\",\"ebay=%5Esbf%3D%23%5E; dp1=bu1p/QEBfX0BAX19AQA**6379634c^\");var urlencoded=new URLSearchParams();urlencoded.append(\"grant_type\",\"client_credentials\");urlencoded.append(\"scope\",\"https://api.ebay.com/oauth/api_scope\");var requestOptions={method:'POST',headers:myHeaders,body:urlencoded,redirect:'follow'};fetch(\"https://loma-cors.herokuapp.com/https://api.ebay.com/identity/v1/oauth2/token\",requestOptions).then(function(response){return response.json();}).then(function(jsonresponse){_this2.setState({AccessToken:jsonresponse.access_token,ExpiryDate:Date.now()+jsonresponse.expires_in*1000});var accessTokenSet=Date.now()-appLoaded;console.log(\"apiAccessToken = \".concat(_this2.state.AccessToken,\", took \").concat(accessTokenSet,\" milliseconds\"));}).catch(function(error){return console.log('error',error);});}};///////<DATA CLEANERS>\nvar isNull=function isNull(property){if(property===null||property===undefined){return\" \";}else{return property;}};var facebookPriceParsed=function facebookPriceParsed(price){var rawPrice=price.substring(1);if(!price||price===\"FREE\"){return\"0\";}else if(price===\"See listings near me\"){return\"~\";}else if(!rawPrice.includes(\"¬£\")){return rawPrice;}else if(rawPrice.includes(\"¬£\")){return rawPrice.substring(0,rawPrice.indexOf(\"¬£\"));}};var isPriceNull=function isPriceNull(price){if(price===undefined||price===null){return\"~\";}else{return price.substring(1);}};var missingImagesFiltered=function missingImagesFiltered(imageProp){if(imageProp===null||imageProp===undefined){return imagePlaceholder;}else{return imageProp;}};///////</DATA CLEANERS END>\nvar getDepopData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var depop_url,depopResponse,depopData,depopDataParsed,depopDataSetTime;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log(\"getting depop data\");depop_url=\"https://api.apify.com/v2/datasets/ml97NZifdmN1EFUSb/items?clean=true&format=json\";_context.next=4;return fetch(depop_url);case 4:depopResponse=_context.sent;_context.next=7;return depopResponse.json();case 7:depopData=_context.sent;_context.next=10;return depopData.map(function(listing){return{title:isNull(listing.title),price:isPriceNull(listing.price),description:isNull(listing.description),image:isNull(missingImagesFiltered(listing.image)),url:isNull(listing.url),site:\"depop\"};});case 10:depopDataParsed=_context.sent;_this2.setState({depopData:{data:depopDataParsed,status:'resolved'}});depopDataSetTime=Date.now()-appLoaded;console.log(\"depop data has been set, it took this many milliseconds: \"+depopDataSetTime);case 14:case\"end\":return _context.stop();}}},_callee);}));return function getDepopData(){return _ref.apply(this,arguments);};}();///\nvar getGumtreeData=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var gumtree_url,gumtreeResponse,gumtreeData,gumtreeDataParsed,gumtreeDataSetTime;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:console.log(\"getting gumtree data\");gumtree_url=\"https://api.apify.com/v2/datasets/Dh5XzAb9fvidWw285/items?format=json&clean=1\";_context2.next=4;return fetch(gumtree_url);case 4:gumtreeResponse=_context2.sent;_context2.next=7;return gumtreeResponse.json();case 7:gumtreeData=_context2.sent;_context2.next=10;return gumtreeData.map(function(listing){return{title:listing.title,price:listing.price.substring(1),description:listing.description,image:missingImagesFiltered(listing.image),url:listing.url,site:\"gumtree\"};});case 10:gumtreeDataParsed=_context2.sent;_this2.setState({gumtreeData:{data:gumtreeDataParsed,status:'resolved'}});gumtreeDataSetTime=Date.now()-appLoaded;console.log(\"gumtree data has been set, it took this many milliseconds: \"+gumtreeDataSetTime);case 14:case\"end\":return _context2.stop();}}},_callee2);}));return function getGumtreeData(){return _ref2.apply(this,arguments);};}();///\nvar getFacebookData=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var facebook_url,facebookResponse,facebookData,facebookDataParsed,facebookDataSetTime;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:console.log(\"getting facebook data\");facebook_url=\"https://api.apify.com/v2/datasets/IitkxYE95yydtzFlk/items?clean=true&format=json\";_context3.next=4;return fetch(facebook_url);case 4:facebookResponse=_context3.sent;_context3.next=7;return facebookResponse.json();case 7:facebookData=_context3.sent;facebookDataParsed=facebookData.map(function(listing){return{title:\"\"+isNull(listing.title),price:\"\"+facebookPriceParsed(listing.price),description:\"\"+isNull(listing.description),image:\"\"+missingImagesFiltered(listing.image),url:\"\"+isNull(listing.url),site:\"facebook\"};});_this2.setState({facebookData:{data:facebookDataParsed,status:'resolved'}});facebookDataSetTime=Date.now()-appLoaded;console.log(\"facebook data has been set, it took this many milliseconds: \"+facebookDataSetTime);case 12:case\"end\":return _context3.stop();}}},_callee3);}));return function getFacebookData(){return _ref3.apply(this,arguments);};}();///////\ngetEbayAccessToken();getDepopData();getGumtreeData();getFacebookData();hotjar.initialize(2123002,6);console.log(\"access token\"+this.state.AccessToken);}//COMPONENT MOUNT ENDS\n},{key:\"toggleLanding\",value:function toggleLanding(){this.setState({landing:true});}},{key:\"reOrderDisplay\",value:function(){var _reOrderDisplay=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(sortOrder){var shuffleArray,highest,lowest;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:lowest=function _lowest(a,b){if(Number(a.price)<Number(b.price)){return-1;}if(Number(a.price)>Number(b.price)){return 1;}return 0;};highest=function _highest(a,b){if(Number(a.price)<Number(b.price)){return 1;}if(Number(a.price)>Number(b.price)){return-1;}return 0;};shuffleArray=function _shuffleArray(array){for(var i=array.length-1;i>0;i--){var j=Math.floor(Math.random()*(i+1));var temp=array[i];array[i]=array[j];array[j]=temp;}return array;};/// functions\nconsole.log(\"Current results state:\"+this.state.resultsDisplay);console.log(\"value to be passed\"+sortOrder);_context4.next=7;return this.setState({resultsDisplay:sortOrder});case 7:console.log(\"sort order updated:\"+this.state.resultsDisplay);if(this.state.Data){if(this.state.resultsDisplay===\"‚ö°Ô∏è Trending ‚ö°Ô∏è\"){this.setState({Data:shuffleArray(this.state.Data)});}else if(this.state.resultsDisplay===\"Highest price first ‚ñº\"){this.setState({Data:this.state.Data.sort(highest)});}else if(this.state.resultsDisplay===\"Lowest price first ‚ñ≤\"){this.setState({Data:this.state.Data.sort(lowest)});}}case 9:case\"end\":return _context4.stop();}}},_callee4,this);}));function reOrderDisplay(_x){return _reOrderDisplay.apply(this,arguments);}return reOrderDisplay;}()},{key:\"setData\",value:function setData(searchQuery){var _this3=this;///<Functions and constants\nfunction shuffleArray(array){for(var i=array.length-1;i>0;i--){var j=Math.floor(Math.random()*(i+1));var temp=array[i];array[i]=array[j];array[j]=temp;}return array;}function seteBayAccessToken(){return _seteBayAccessToken.apply(this,arguments);}function _seteBayAccessToken(){_seteBayAccessToken=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee11(){var _this4=this;var myHeaders,urlencoded,requestOptions;return _regeneratorRuntime.wrap(function _callee11$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:myHeaders=new Headers();myHeaders.append(\"Authorization\",\"Basic Sm9zZXBoVW4tTG9tYS1QUkQtMTk5YWQwZDkwLWY0Y2QyYjg4OlBSRC05OWFkMGQ5MDRiYjEtZjYzMS00OGMyLTkwNTQtYTQ5Yg==\");myHeaders.append(\"Content-Type\",\"application/x-www-form-urlencoded\");myHeaders.append(\"Cookie\",\"ebay=%5Esbf%3D%23%5E; dp1=bu1p/QEBfX0BAX19AQA**6379634c^\");urlencoded=new URLSearchParams();urlencoded.append(\"grant_type\",\"client_credentials\");urlencoded.append(\"scope\",\"https://api.ebay.com/oauth/api_scope\");requestOptions={method:'POST',headers:myHeaders,body:urlencoded,redirect:'follow'};fetch(\"https://loma-cors.herokuapp.com/https://api.ebay.com/identity/v1/oauth2/token\",requestOptions).then(function(response){return response.json();}).then(function(jsonresponse){_this4.setState({AccessToken:jsonresponse.access_token,ExpiryDate:new Date().getTime()+jsonresponse.expires_in*1000});}).catch(function(error){return console.log('error',error);});case 9:case\"end\":return _context11.stop();}}},_callee11);}));return _seteBayAccessToken.apply(this,arguments);}var isNull=function isNull(property){if(property===null||property===undefined){return\" \";}else{return property;}};var isPriceNull=function isPriceNull(price){if(price===undefined||price===null){return\"~\";}else{return price.substring(1);}};var ebayPriceParsed=function ebayPriceParsed(listing){if(listing.price.currency===\"USD\"){return listing.price.convertedFromValue?listing.price.convertedFromValue:listing.price.value;}else{return listing.price.value;}};var facebookPriceParsed=function facebookPriceParsed(price){var rawPrice=price.substring(1);if(!price||price===\"FREE\"){return\"0\";}else if(price===\"See listings near me\"){return\"~\";}else if(!rawPrice.includes(\"¬£\")){return rawPrice;}else if(rawPrice.includes(\"¬£\")){return rawPrice.substring(0,rawPrice.indexOf(\"¬£\"));}};var missingImagesFiltered=function missingImagesFiltered(imageProp){if(imageProp===null||imageProp===undefined){return imagePlaceholder;}else{return imageProp;}};var tnmissingImagesFiltered=function tnmissingImagesFiltered(listing){if(!listing.photos){return imagePlaceholder;}else{return listing.photos[0].url;}};var eBayMissingImagesFiltered=function eBayMissingImagesFiltered(listing){if(!listing.hasOwnProperty(\"image\")||!listing.image.hasOwnProperty(\"imageUrl\")){return imagePlaceholder;}else{return listing.thumbnailImages[0].imageUrl;}};///<Data calls\nvar setEbayData=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var ebayHeaders,ebayrequestOptions,ebayresponse,jsonresponse,ebayDataParsed;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:ebayHeaders=new Headers();ebayHeaders.append(\"Authorization\",\"Bearer \".concat(_this3.state.AccessToken));ebayHeaders.append(\"Content-Type\",\"application/json\");ebayHeaders.append(\"X-EBAY-C-MARKETPLACE-ID\",\"EBAY_US\");ebayHeaders.append(\"X-EBAY-C-ENDUSERCTX\",\"affiliateCampaignId=<ePNCampaignId>,affiliateReferenceId=<referenceId>\");ebayrequestOptions={method:'GET',headers:ebayHeaders,redirect:'follow'};_context5.next=8;return fetch(\"https://loma-cors.herokuapp.com/https://api.ebay.com/buy/browse/v1/item_summary/search?q=\".concat(searchQuery,\"&limit=200&filter=conditions:{UNSPECIFIED|USED},itemLocationCountry:GB&fieldgroups=EXTENDED\"),ebayrequestOptions);case 8:ebayresponse=_context5.sent;_context5.next=11;return ebayresponse.json();case 11:jsonresponse=_context5.sent;ebayDataParsed=function ebayDataParsed(){if(jsonresponse.itemSummaries){return jsonresponse.itemSummaries.map(function(listing){return{title:isNull(listing.title),description:isNull(listing.shortDescription),price:isNull(ebayPriceParsed(listing)),image:eBayMissingImagesFiltered(listing),url:isNull(listing.itemWebUrl),site:\"ebay\"};});}else{return[];}};_this3.setState(function(prevState){return{loading:false,Data:shuffleArray([].concat(_toConsumableArray(prevState.Data),_toConsumableArray(ebayDataParsed())))};});case 14:case\"end\":return _context5.stop();}}},_callee5);}));return function setEbayData(){return _ref4.apply(this,arguments);};}();var setDepopData=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){var depop_url,depopResponse,depopData,depopDataFiltered,depopDataParsed,_depopDataFiltered;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:if(!(_this3.state.depopData.status===\"unresolved\")){_context6.next=14;break;}depop_url=\"https://api.apify.com/v2/datasets/ml97NZifdmN1EFUSb/items?clean=true&format=json\";_context6.next=4;return fetch(depop_url);case 4:depopResponse=_context6.sent;_context6.next=7;return depopResponse.json();case 7:depopData=_context6.sent;depopDataFiltered=depopData.filter(function(listing){if(isNull(listing.title).toLowerCase().includes(_this3.state.searchTerm)){return true;}else if(isNull(listing.description).toLowerCase().includes(_this3.state.searchTerm)){return true;}else{return false;}});depopDataParsed=depopDataFiltered.map(function(listing){return{title:isNull(listing.title),price:isPriceNull(listing.price),description:isNull(listing.description),image:isNull(missingImagesFiltered(listing.image)),url:isNull(listing.url),site:\"depop\"};});_this3.setState({depopData:{data:depopDataParsed,status:'resolved'}});_this3.setState(function(prevState){return{Data:[].concat(_toConsumableArray(prevState.Data),_toConsumableArray(depopDataParsed))};});_context6.next=15;break;case 14:if(_this3.state.depopData.status===\"resolved\"){_depopDataFiltered=_this3.state.depopData.data.filter(function(listing){if(isNull(listing.title).toLowerCase().includes(_this3.state.searchTerm)){return true;}else if(isNull(listing.description).toLowerCase().includes(_this3.state.searchTerm)){return true;}else{return false;}});_this3.setState(function(prevState){return{Data:shuffleArray([].concat(_toConsumableArray(prevState.Data),_toConsumableArray(_depopDataFiltered)))};});}case 15:case\"end\":return _context6.stop();}}},_callee6);}));return function setDepopData(){return _ref5.apply(this,arguments);};}();var setGumtreeData=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(){var gumtree_url,gumtreeResponse,gumtreeData,gumtreeDataFiltered,gumtreeDataParsed,_gumtreeDataFiltered;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:if(!(_this3.state.gumtreeData.status===\"unresolved\")){_context7.next=14;break;}gumtree_url=\"https://api.apify.com/v2/datasets/Dh5XzAb9fvidWw285/items?format=json&clean=1\";_context7.next=4;return fetch(gumtree_url);case 4:gumtreeResponse=_context7.sent;_context7.next=7;return gumtreeResponse.json();case 7:gumtreeData=_context7.sent;gumtreeDataFiltered=gumtreeData.filter(function(listing){return listing.title.toLowerCase().includes(_this3.state.searchTerm)||listing.description.toLowerCase().includes(_this3.state.searchTerm);});gumtreeDataParsed=gumtreeDataFiltered.map(function(listing){return{title:listing.title,price:listing.price.substring(1),description:listing.description,image:missingImagesFiltered(listing.image),url:listing.url,site:\"gumtree\"};});_this3.setState({depopData:{data:gumtreeDataParsed,status:'resolved'}});_this3.setState(function(prevState){return{Data:shuffleArray([].concat(_toConsumableArray(prevState.Data),_toConsumableArray(gumtreeDataFiltered)))};});_context7.next=16;break;case 14:_gumtreeDataFiltered=_this3.state.gumtreeData.data.filter(function(listing){if(isNull(listing.title).toLowerCase().includes(_this3.state.searchTerm)){return true;}else if(isNull(listing.description).toLowerCase().includes(_this3.state.searchTerm)){return true;}else{return false;}});_this3.setState(function(prevState){return{Data:shuffleArray([].concat(_toConsumableArray(prevState.Data),_toConsumableArray(_gumtreeDataFiltered)))};});case 16:case\"end\":return _context7.stop();}}},_callee7);}));return function setGumtreeData(){return _ref6.apply(this,arguments);};}();var setFacebookData=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(){var facebook_url,facebookResponse,facebookData,facebookDataFiltered,facebookDataParsed,_facebookDataFiltered;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:if(!(_this3.state.facebookData.status===\"unresolved\")){_context8.next=14;break;}facebook_url=\"https://api.apify.com/v2/datasets/IitkxYE95yydtzFlk/items?clean=true&format=json\";_context8.next=4;return fetch(facebook_url);case 4:facebookResponse=_context8.sent;_context8.next=7;return facebookResponse.json();case 7:facebookData=_context8.sent;facebookDataFiltered=facebookData.filter(function(listing){return listing.title.toLowerCase().includes(searchQuery||listing.description.toLowerCase().includes(searchQuery));});facebookDataParsed=facebookDataFiltered.map(function(listing){return{title:\"\"+isNull(listing.title),price:\"\"+facebookPriceParsed(listing.price),description:\"\"+isNull(listing.description),image:\"\"+missingImagesFiltered(listing.image),url:\"\"+isNull(listing.url),site:\"facebook\"};});_this3.setState({facebookData:{data:facebookDataParsed,status:'resolved'}});_this3.setState(function(prevState){return{Data:shuffleArray([].concat(_toConsumableArray(prevState.Data),_toConsumableArray(facebookDataFiltered)))};});_context8.next=16;break;case 14:_facebookDataFiltered=_this3.state.facebookData.data.filter(function(listing){if(isNull(listing.title).toLowerCase().includes(_this3.state.searchTerm)){return true;}else if(isNull(listing.description).toLowerCase().includes(_this3.state.searchTerm)){return true;}else{return false;}});_this3.setState(function(prevState){return{Data:shuffleArray([].concat(_toConsumableArray(prevState.Data),_toConsumableArray(_facebookDataFiltered)))};});case 16:case\"end\":return _context8.stop();}}},_callee8);}));return function setFacebookData(){return _ref7.apply(this,arguments);};}();var setEtsyData=/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(){var etsyRaw,etsyJson,etsyDataResults,etsyData;return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:_context9.next=2;return fetch(\"https://loma-cors.herokuapp.com/https://openapi.etsy.com/v2/listings/active?keywords=\".concat(searchQuery,\"&tags=vintage&limit=200&region=GB&api_key=sh1n3isgj6bax7eotlor7m4s&includes=Images\"));case 2:etsyRaw=_context9.sent;_context9.next=5;return etsyRaw.json();case 5:etsyJson=_context9.sent;etsyDataResults=etsyJson.results;etsyData=etsyDataResults.map(function(listing){return{title:listing.title,price:listing.price,description:listing.description,image:missingImagesFiltered(listing.Images[0].url_570xN),url:listing.url,site:\"etsy\"};});_this3.setState(function(prevState){return{Data:shuffleArray([].concat(_toConsumableArray(prevState.Data),_toConsumableArray(etsyData)))};});case 9:case\"end\":return _context9.stop();}}},_callee9);}));return function setEtsyData(){return _ref8.apply(this,arguments);};}();var setTrashNothingData=/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee10(){var trashnothingRaw,tnJson,tnResults,trashNothingData;return _regeneratorRuntime.wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:_context10.next=2;return fetch(\"https://trashnothing.com/api/v1.2/posts/search?search=\".concat(searchQuery,\"&sort_by=relevance&types=offer&sources=trashnothing&per_page=50&page=4&device_pixel_ratio=1&latitude=51.507351&longitude=-0.127758&radius=200000&api_key=yr8sVaHEvbdkdunSFfPoDpqlwEjxIuqB3XhyFzx1\"));case 2:trashnothingRaw=_context10.sent;_context10.next=5;return trashnothingRaw.json();case 5:tnJson=_context10.sent;tnResults=tnJson.posts;trashNothingData=tnResults.map(function(listing){return{title:listing.title,price:0,description:listing.content,image:tnmissingImagesFiltered(listing),url:listing.url,site:\"trashnothing\"};});_this3.setState(function(prevState){return{Data:shuffleArray([].concat(_toConsumableArray(prevState.Data),_toConsumableArray(trashNothingData)))};});case 9:case\"end\":return _context10.stop();}}},_callee10);}));return function setTrashNothingData(){return _ref9.apply(this,arguments);};}();///>Data calls\n////>Functions and constants\n///<Preliminary checks\nif(!searchQuery){alert(\"Tell me what to search! üòÅ\");return;}console.time(\"complete search\");this.setState({Data:[],searchTerm:searchQuery.toLowerCase(),loading:true,landing:false});if(Date.now()>this.state.ExpiryDate){console.log(\"this app does not have an access token! Getting access token\");seteBayAccessToken();}else{console.log(\"this has an access token\"+this.state.AccessToken.substring(10,25));}///>Preliminary checks\n///<The Timeline\nsetEbayData();setDepopData();setGumtreeData();setFacebookData();setEtsyData();setTrashNothingData();}},{key:\"handleChange\",value:function handleChange(searchQuery){this.setState({searchTerm:searchQuery});this.setData(searchQuery);}},{key:\"togglePopUp\",value:function togglePopUp(listing){if(this.state.popUpListing.display===true){this.setState({popUpListing:{display:false,listing:{}}});}else{this.setState({popUpListing:{display:true,listing:listing}});}}},{key:\"changeActiveListing\",value:function changeActiveListing(listing,direction){var currentActiveListingIndex=this.state.Data.indexOf(listing);if(direction===\"next\"){this.setState(function(prevState){return{popUpListing:{display:true,listing:prevState.Data[currentActiveListingIndex+1]}};});}else if(direction===\"previous\"&&currentActiveListingIndex>0){this.setState(function(prevState){return{popUpListing:{display:true,listing:prevState.Data[currentActiveListingIndex-1]}};});}else{return;}}},{key:\"render\",value:function render(){return/*#__PURE__*/_jsxs(\"div\",{className:\"App w-100 h-full bg-white overflow-x-hidden z-0\",children:[this.state.popUpListing.display?/*#__PURE__*/_jsx(PopUpListing,{changeActiveListing:this.changeActiveListing,display:this.state.popUpListing.display,listing:this.state.popUpListing.listing,togglePopUp:this.togglePopUp}):null,/*#__PURE__*/_jsx(SearchBar,{onChange:this.handleChange}),this.state.landing?/*#__PURE__*/_jsx(Landing,{}):null,this.state.loading?null:/*#__PURE__*/_jsx(Results,{Data:this.state.Data,resultsDisplay:this.state.resultsDisplay,reOrderDisplay:this.reOrderDisplay,searchTerm:this.state.searchTerm,search:this.handleChange,togglePopUp:this.togglePopUp}),this.state.loading?/*#__PURE__*/_jsx(LoadingPop,{}):/*#__PURE__*/_jsx(\"p\",{})]});}}]);return App;}(React.Component);export default App;","map":{"version":3,"sources":["/Users/joseph/Code/lomav2/src/App.js"],"names":["React","SearchBar","Results","Landing","LoadingPop","PopUpListing","imagePlaceholder","hotjar","App","props","state","Data","AccessToken","ExpiryDate","resultsDisplay","searchTerm","loading","landing","popUpListing","display","listing","depopData","data","nothing","status","gumtreeData","facebookData","handleChange","bind","setData","reOrderDisplay","togglePopUp","changeActiveListing","appLoaded","Date","now","getEbayAccessToken","console","log","myHeaders","Headers","append","urlencoded","URLSearchParams","requestOptions","method","headers","body","redirect","fetch","then","response","json","jsonresponse","setState","access_token","expires_in","accessTokenSet","catch","error","isNull","property","undefined","facebookPriceParsed","price","rawPrice","substring","includes","indexOf","isPriceNull","missingImagesFiltered","imageProp","getDepopData","depop_url","depopResponse","map","title","description","image","url","site","depopDataParsed","depopDataSetTime","getGumtreeData","gumtree_url","gumtreeResponse","gumtreeDataParsed","gumtreeDataSetTime","getFacebookData","facebook_url","facebookResponse","facebookDataParsed","facebookDataSetTime","initialize","sortOrder","shuffleArray","highest","lowest","a","b","Number","array","i","length","j","Math","floor","random","temp","sort","searchQuery","seteBayAccessToken","getTime","ebayPriceParsed","currency","convertedFromValue","value","tnmissingImagesFiltered","photos","eBayMissingImagesFiltered","hasOwnProperty","thumbnailImages","imageUrl","setEbayData","ebayHeaders","ebayrequestOptions","ebayresponse","ebayDataParsed","itemSummaries","shortDescription","itemWebUrl","prevState","setDepopData","depopDataFiltered","filter","toLowerCase","setGumtreeData","gumtreeDataFiltered","setFacebookData","facebookDataFiltered","setEtsyData","etsyRaw","etsyJson","etsyDataResults","results","etsyData","Images","url_570xN","setTrashNothingData","trashnothingRaw","tnJson","tnResults","posts","trashNothingData","content","alert","time","direction","currentActiveListingIndex","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport \"tailwindcss/tailwind.css\"\n\nimport { SearchBar } from './Components/SearchBar';\nimport { Results } from './Components/Results';\nimport { Landing } from './Components/Landing';\nimport { LoadingPop } from './Components/LoadingPop';\nimport { PopUpListing } from './Components/PopUpListing';\n\n\nimport imagePlaceholder from './assets/gallery.png';\n\nimport { hotjar } from 'react-hotjar';\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      Data: [],\n      AccessToken: \"none\",\n      ExpiryDate: 0,\n      resultsDisplay: \"‚ö°Ô∏è Trending ‚ö°Ô∏è\",\n      searchTerm: \"\",\n      loading: false,\n      landing: true,\n      popUpListing: {\n        display: false,\n        listing: {}\n      },\n      depopData: {\n        data: [{nothing : \"none\"}],\n        status: 'unresolved'\n      },\n      gumtreeData: {\n        data: [{nothing : \"none\"}],\n        status: 'unresolved'\n      },\n      facebookData: {\n        data: [{nothing : \"none\"}],\n        status: 'unresolved'\n      }\n    }\n    this.handleChange = this.handleChange.bind(this);\n    this.setData = this.setData.bind(this);\n    this.reOrderDisplay = this.reOrderDisplay.bind(this);\n    this.togglePopUp = this.togglePopUp.bind(this);\n    this.changeActiveListing = this.changeActiveListing.bind(this);\n  }\n\n  componentDidMount() {\n  /////////FUNCTIONS AND CONSTANTS\n    const appLoaded = Date.now()\n    const getEbayAccessToken = () => {\n    if (Date.now() > this.state.ExpiryDate) {\n      console.log(\"this app does not have an access token, getting access token\")\n\n      var myHeaders = new Headers();\n      myHeaders.append(\"Authorization\", \"Basic Sm9zZXBoVW4tTG9tYS1QUkQtMTk5YWQwZDkwLWY0Y2QyYjg4OlBSRC05OWFkMGQ5MDRiYjEtZjYzMS00OGMyLTkwNTQtYTQ5Yg==\");\n      myHeaders.append(\"Content-Type\", \"application/x-www-form-urlencoded\");\n      myHeaders.append(\"Cookie\", \"ebay=%5Esbf%3D%23%5E; dp1=bu1p/QEBfX0BAX19AQA**6379634c^\");\n      \n      var urlencoded = new URLSearchParams();\n      urlencoded.append(\"grant_type\", \"client_credentials\");\n      urlencoded.append(\"scope\", \"https://api.ebay.com/oauth/api_scope\");\n      \n      var requestOptions = {\n        method: 'POST',\n        headers: myHeaders,\n        body: urlencoded,\n        redirect: 'follow'\n      };\n      \n      fetch(\"https://loma-cors.herokuapp.com/https://api.ebay.com/identity/v1/oauth2/token\", requestOptions)\n          .then(response => response.json())\n          .then(jsonresponse => {\n            this.setState({\n              AccessToken: jsonresponse.access_token,\n              ExpiryDate: Date.now() + jsonresponse.expires_in * 1000\n            })\n            let accessTokenSet = Date.now() - appLoaded;\n            console.log(`apiAccessToken = ${this.state.AccessToken}, took ${accessTokenSet} milliseconds`);\n          })\n          .catch(error => console.log('error', error));\n        } \n    }\n\n\n    ///////<DATA CLEANERS>\n    const isNull = (property) => {\n      if (property === null || property === undefined) {\n     return \" \";\n     } else {\n       return property;\n     }\n     };\n\n     const facebookPriceParsed = (price) => {\n      let rawPrice = price.substring(1);\n      if (!price || price === \"FREE\") {\n        return \"0\"\n      } else if (price === \"See listings near me\") {\n        return \"~\"\n      } else if (!rawPrice.includes(\"¬£\")){\n        return rawPrice;\n      } else if (rawPrice.includes(\"¬£\")) {\n        return rawPrice.substring(0, rawPrice.indexOf(\"¬£\"));\n      }\n    };\n     \n\n     const isPriceNull = (price) => {\n      if (price === undefined || price === null) {\n        return \"~\";\n      } else {\n        return price.substring(1)\n      }\n    };\n\n    const missingImagesFiltered = (imageProp) => {\n      if (imageProp === null || imageProp === undefined) {\n        return imagePlaceholder;\n      } else {\n        return imageProp;\n      }\n    }\n    ///////</DATA CLEANERS END>\n    const getDepopData = async () => {\n      console.log(\"getting depop data\")\n    \n    const depop_url = \"https://api.apify.com/v2/datasets/ml97NZifdmN1EFUSb/items?clean=true&format=json\";\n    const depopResponse = await fetch(depop_url);\n    const depopData = await depopResponse.json();\n\n    const depopDataParsed = await depopData.map(\n      (listing) => {\n        return {\n          title: isNull(listing.title),\n          price: isPriceNull(listing.price),\n          description: isNull(listing.description),\n          image: isNull(missingImagesFiltered(listing.image)),\n          url: isNull(listing.url),\n          site: \"depop\"\n        }\n      }\n    );\n\n    this.setState({\n      depopData : {\n        data: depopDataParsed,\n        status: 'resolved'\n      }\n    })\n\n    let depopDataSetTime = Date.now() - appLoaded\n\n    console.log(\"depop data has been set, it took this many milliseconds: \" + depopDataSetTime);\n\n    }\n\n///\n\n    const getGumtreeData = async () => {\n      console.log(\"getting gumtree data\")\n    \n      const gumtree_url = \"https://api.apify.com/v2/datasets/Dh5XzAb9fvidWw285/items?format=json&clean=1\"\n      const gumtreeResponse = await fetch(gumtree_url);\n      const gumtreeData = await gumtreeResponse.json();\n  \n      const gumtreeDataParsed = await gumtreeData.map(\n        listing => {\n          return {\n            title: listing.title,\n            price: listing.price.substring(1),\n            description: listing.description,\n            image: missingImagesFiltered(listing.image),\n            url: listing.url,\n            site: \"gumtree\"\n          }\n        }\n      )\n\n    this.setState({\n      gumtreeData : {\n        data: gumtreeDataParsed,\n        status: 'resolved'\n      }\n    })\n    let gumtreeDataSetTime = Date.now() - appLoaded\n\n    console.log(\"gumtree data has been set, it took this many milliseconds: \" + gumtreeDataSetTime);\n\n    }\n\n\n    ///\n\n    const getFacebookData = async () => {\n      console.log(\"getting facebook data\")\n    \n      const facebook_url = \"https://api.apify.com/v2/datasets/IitkxYE95yydtzFlk/items?clean=true&format=json\"\n      const facebookResponse = await fetch(facebook_url);\n      const facebookData = await facebookResponse.json();\n  \n      const facebookDataParsed = facebookData.map(\n        listing => {\n          return {\n            title: \"\" + isNull(listing.title),\n            price: \"\" + facebookPriceParsed(listing.price),\n            description: \"\" + isNull(listing.description),\n            image: \"\" + missingImagesFiltered(listing.image),\n            url: \"\" + isNull(listing.url),\n            site: \"facebook\"\n          }\n        }\n      )\n  \n  \n\n    this.setState({\n      facebookData : {\n        data: facebookDataParsed,\n        status: 'resolved'\n      }\n    })\n\n    let facebookDataSetTime = Date.now() - appLoaded\n\n    console.log(\"facebook data has been set, it took this many milliseconds: \" + facebookDataSetTime);\n\n    }\n\n\n    ///////\n    getEbayAccessToken();\n    getDepopData();\n    getGumtreeData();\n    getFacebookData();\n    hotjar.initialize(2123002,6);\n    console.log(\"access token\" +  this.state.AccessToken);\n    \n  } //COMPONENT MOUNT ENDS\n\n  toggleLanding() {\n    this.setState({\n      landing: true,\n    }) \n  }\n\n  async reOrderDisplay(sortOrder) {\n    /// functions\n    console.log(\"Current results state:\" + this.state.resultsDisplay);\n    console.log(\"value to be passed\" + sortOrder);\n    await this.setState({resultsDisplay: sortOrder});\n    console.log(\"sort order updated:\" + this.state.resultsDisplay)\n\n    function shuffleArray(array) {\n      for (var i = array.length - 1; i > 0; i--) {\n          var j = Math.floor(Math.random() * (i + 1));\n          var temp = array[i];\n          array[i] = array[j];\n          array[j] = temp;\n      }\n      return array;\n  }\n\n  function highest( a, b ) {\n    if ( Number(a.price) < Number(b.price) ){\n      return 1;\n    }\n    if ( Number(a.price) > Number(b.price) ){\n      return -1;\n    }\n    return 0;\n  }\n\n  function lowest( a, b ) {\n    if ( Number(a.price) < Number(b.price) ){\n      return -1;\n    }\n    if ( Number(a.price) > Number(b.price) ){\n      return 1;\n    }\n    return 0;\n  } \n\n\n  if (this.state.Data) {\n      if (this.state.resultsDisplay === \"‚ö°Ô∏è Trending ‚ö°Ô∏è\") {\n        this.setState({Data: shuffleArray(this.state.Data)})\n      } else if (this.state.resultsDisplay === \"Highest price first ‚ñº\") {\n        this.setState({Data: this.state.Data.sort(highest)})\n      } else if (this.state.resultsDisplay === \"Lowest price first ‚ñ≤\") {\n        this.setState({Data: this.state.Data.sort(lowest)}) }\n        }\n  \n \n  }\n  \n\nsetData(searchQuery) {\n ///<Functions and constants\n\n function shuffleArray(array) {\n  for (var i = array.length - 1; i > 0; i--) {\n      var j = Math.floor(Math.random() * (i + 1));\n      var temp = array[i];\n      array[i] = array[j];\n      array[j] = temp;\n  }\n  return array;\n}\n\n async function seteBayAccessToken() {\n  var myHeaders = new Headers();\n  myHeaders.append(\"Authorization\", \"Basic Sm9zZXBoVW4tTG9tYS1QUkQtMTk5YWQwZDkwLWY0Y2QyYjg4OlBSRC05OWFkMGQ5MDRiYjEtZjYzMS00OGMyLTkwNTQtYTQ5Yg==\");\n  myHeaders.append(\"Content-Type\", \"application/x-www-form-urlencoded\");\n  myHeaders.append(\"Cookie\", \"ebay=%5Esbf%3D%23%5E; dp1=bu1p/QEBfX0BAX19AQA**6379634c^\");\n  \n  var urlencoded = new URLSearchParams();\n  urlencoded.append(\"grant_type\", \"client_credentials\");\n  urlencoded.append(\"scope\", \"https://api.ebay.com/oauth/api_scope\");\n  \n  var requestOptions = {\n    method: 'POST',\n    headers: myHeaders,\n    body: urlencoded,\n    redirect: 'follow'\n  };\n  \n  fetch(\"https://loma-cors.herokuapp.com/https://api.ebay.com/identity/v1/oauth2/token\", requestOptions)\n      .then(response => response.json())\n      .then(jsonresponse => {\n        this.setState({\n          AccessToken: jsonresponse.access_token,\n          ExpiryDate: new Date().getTime() + jsonresponse.expires_in * 1000\n        })\n      })\n      .catch(error => console.log('error', error));\n }\n\n const isNull = (property) => {\n  if (property === null || property === undefined) {\n  return \" \";\n  } else {\n    return property;\n  }\n};\n\nconst isPriceNull = (price) => {\n  if (price === undefined || price === null) {\n    return \"~\";\n  } else {\n    return price.substring(1)\n  }\n};\n\nconst ebayPriceParsed = (listing) => {\n  if (listing.price.currency === \"USD\") {\n    return listing.price.convertedFromValue ? listing.price.convertedFromValue : listing.price.value;\n  } else {\n    return listing.price.value;\n  }\n};\n\nconst facebookPriceParsed = (price) => {\n  let rawPrice = price.substring(1);\n  if (!price || price === \"FREE\") {\n    return \"0\"\n  } else if (price === \"See listings near me\") {\n    return \"~\"\n  } else if (!rawPrice.includes(\"¬£\")){\n    return rawPrice;\n  } else if (rawPrice.includes(\"¬£\")) {\n    return rawPrice.substring(0, rawPrice.indexOf(\"¬£\"));\n  }\n};\n\nconst missingImagesFiltered = (imageProp) => {\n  if (imageProp === null || imageProp === undefined) {\n    return imagePlaceholder;\n  } else {\n    return imageProp;\n  }\n}\n\nconst tnmissingImagesFiltered = (listing) => {\n  if (!listing.photos) {\n    return imagePlaceholder\n  } else {\n    return listing.photos[0].url;\n  }\n}\n\nconst eBayMissingImagesFiltered = (listing) => {\n  if (!listing.hasOwnProperty(\"image\") || !listing.image.hasOwnProperty(\"imageUrl\")) {\n    return imagePlaceholder;\n  } else {\n    return listing.thumbnailImages[0].imageUrl;\n  }\n}\n\n\n///<Data calls\n\nconst setEbayData = async () => {\n  var ebayHeaders = new Headers();\n  ebayHeaders.append(\"Authorization\", `Bearer ${this.state.AccessToken}`);\n  ebayHeaders.append(\"Content-Type\", \"application/json\");\n  ebayHeaders.append(\"X-EBAY-C-MARKETPLACE-ID\", \"EBAY_US\");\n  ebayHeaders.append(\"X-EBAY-C-ENDUSERCTX\", \"affiliateCampaignId=<ePNCampaignId>,affiliateReferenceId=<referenceId>\");\n  \n  var ebayrequestOptions = {\n    method: 'GET',\n    headers: ebayHeaders,\n    redirect: 'follow'\n  };   \n\n  \n  const ebayresponse = await fetch(`https://loma-cors.herokuapp.com/https://api.ebay.com/buy/browse/v1/item_summary/search?q=${searchQuery}&limit=200&filter=conditions:{UNSPECIFIED|USED},itemLocationCountry:GB&fieldgroups=EXTENDED`, ebayrequestOptions);\n  const jsonresponse = await ebayresponse.json();\n  const ebayDataParsed = () => {\n    if (jsonresponse.itemSummaries) {\n        return jsonresponse.itemSummaries.map(\n          (listing) => {\n              return {\n                  title: isNull(listing.title),\n                  description: isNull(listing.shortDescription),\n                  price: isNull(ebayPriceParsed(listing)),\n                  image: eBayMissingImagesFiltered(listing),\n                  url: isNull(listing.itemWebUrl),\n                  site: \"ebay\"\n              }\n          }\n      )\n    } else { \n      return [];\n    }\n  }\n\n  this.setState(prevState => ({loading: false, Data: shuffleArray([...prevState.Data,...ebayDataParsed()])}));\n}\n\nconst setDepopData = async () => {\n  if (this.state.depopData.status === \"unresolved\") {\n    const depop_url = \"https://api.apify.com/v2/datasets/ml97NZifdmN1EFUSb/items?clean=true&format=json\";\n    const depopResponse = await fetch(depop_url);\n    const depopData = await depopResponse.json();\n    const depopDataFiltered = depopData.filter( (listing) => {\n      if (isNull(listing.title).toLowerCase().includes(this.state.searchTerm)) {\n        return true;\n      } else if (isNull(listing.description).toLowerCase().includes(this.state.searchTerm)) {\n        return true;\n      } else {\n        return false;\n      }\n    })\n    \n    const depopDataParsed = depopDataFiltered.map(\n      (listing) => {\n        return {\n          title: isNull(listing.title),\n          price: isPriceNull(listing.price),\n          description: isNull(listing.description),\n          image: isNull(missingImagesFiltered(listing.image)),\n          url: isNull(listing.url),\n          site: \"depop\"\n        }\n      }\n    )\n\n    this.setState({\n      depopData : {\n        data: depopDataParsed,\n        status: 'resolved'\n      }\n    });\n\n    this.setState(prevState => ({Data: [...prevState.Data,...depopDataParsed]}));\n\n  } else if (this.state.depopData.status === \"resolved\") {\n    const depopDataFiltered = this.state.depopData.data.filter((listing) => {\n      if (isNull(listing.title).toLowerCase().includes(this.state.searchTerm)) {\n        return true;\n      } else if (isNull(listing.description).toLowerCase().includes(this.state.searchTerm)) {\n        return true;\n      } else {\n        return false;\n      }\n    });\n    this.setState(prevState => ({Data: shuffleArray([...prevState.Data,...depopDataFiltered])}));\n  }\n} \n\nconst setGumtreeData = async () => {\n\n      \n  if (this.state.gumtreeData.status === \"unresolved\") {\n    const gumtree_url = \"https://api.apify.com/v2/datasets/Dh5XzAb9fvidWw285/items?format=json&clean=1\"\n    const gumtreeResponse = await fetch(gumtree_url);\n    const gumtreeData = await gumtreeResponse.json();\n    const gumtreeDataFiltered = gumtreeData.filter( listing =>\n      listing.title.toLowerCase().includes(this.state.searchTerm) || listing.description.toLowerCase().includes(this.state.searchTerm));\n\n    const gumtreeDataParsed = gumtreeDataFiltered.map(\n      listing => {\n        return {\n          title: listing.title,\n          price: listing.price.substring(1),\n          description: listing.description,\n          image: missingImagesFiltered(listing.image),\n          url: listing.url,\n          site: \"gumtree\"\n        }\n      }\n    )\n\n    this.setState({\n      depopData : {\n        data: gumtreeDataParsed,\n        status: 'resolved'\n      }\n    });\n\n    this.setState(prevState => ({Data: shuffleArray([...prevState.Data,...gumtreeDataFiltered])}));\n\n  } else {\n    const gumtreeDataFiltered = this.state.gumtreeData.data.filter((listing) => {\n      if (isNull(listing.title).toLowerCase().includes(this.state.searchTerm)) {\n        return true;\n      } else if (isNull(listing.description).toLowerCase().includes(this.state.searchTerm)) {\n        return true;\n      } else {\n        return false;\n      }\n    });\n    this.setState(prevState => ({Data: shuffleArray([...prevState.Data,...gumtreeDataFiltered])}));\n    \n  }\n}\n\nconst setFacebookData = async () => {\n\n\n  if (this.state.facebookData.status === \"unresolved\") {\n    const facebook_url = \"https://api.apify.com/v2/datasets/IitkxYE95yydtzFlk/items?clean=true&format=json\"\n    const facebookResponse = await fetch(facebook_url);\n    const facebookData = await facebookResponse.json();\n    const facebookDataFiltered = facebookData.filter( listing =>\n      listing.title.toLowerCase().includes(searchQuery || listing.description.toLowerCase().includes(searchQuery)));\n\n    const facebookDataParsed = facebookDataFiltered.map(\n      listing => {\n        return {\n          title: \"\" + isNull(listing.title),\n          price: \"\" + facebookPriceParsed(listing.price),\n          description: \"\" + isNull(listing.description),\n          image: \"\" + missingImagesFiltered(listing.image),\n          url: \"\" + isNull(listing.url),\n          site: \"facebook\"\n        }\n      }\n    )\n\n    this.setState({\n      facebookData : {\n        data: facebookDataParsed,\n        status: 'resolved'\n      }\n    });\n    \n    this.setState(prevState => ({Data: shuffleArray([...prevState.Data,...facebookDataFiltered])}));\n  } else {\n    const facebookDataFiltered = this.state.facebookData.data.filter((listing) => {\n      if (isNull(listing.title).toLowerCase().includes(this.state.searchTerm)) {\n        return true;\n      } else if (isNull(listing.description).toLowerCase().includes(this.state.searchTerm)) {\n        return true;\n      } else {\n        return false;\n      }\n    });\n    this.setState(prevState => ({Data: shuffleArray([...prevState.Data,...facebookDataFiltered])}));\n  }\n}\n\nconst setEtsyData = async () => {\n\n  const etsyRaw = await fetch(`https://loma-cors.herokuapp.com/https://openapi.etsy.com/v2/listings/active?keywords=${searchQuery}&tags=vintage&limit=200&region=GB&api_key=sh1n3isgj6bax7eotlor7m4s&includes=Images`);\n  const etsyJson = await etsyRaw.json();\n  const etsyDataResults = etsyJson.results;\n  const etsyData = etsyDataResults.map( listing => {\n    return {\n      title: listing.title,\n      price: listing.price,\n      description: listing.description,\n      image: missingImagesFiltered(listing.Images[0].url_570xN),\n      url: listing.url,\n      site: \"etsy\"\n    }\n  });\n\n  this.setState(prevState => ({Data: shuffleArray([...prevState.Data,...etsyData])}));\n}\n\nconst setTrashNothingData = async () => {\n\n  const trashnothingRaw = await fetch(`https://trashnothing.com/api/v1.2/posts/search?search=${searchQuery}&sort_by=relevance&types=offer&sources=trashnothing&per_page=50&page=4&device_pixel_ratio=1&latitude=51.507351&longitude=-0.127758&radius=200000&api_key=yr8sVaHEvbdkdunSFfPoDpqlwEjxIuqB3XhyFzx1`);\n  const tnJson = await trashnothingRaw.json();\n  const tnResults = tnJson.posts;\n  const trashNothingData = tnResults.map( listing => {\n    return {\n      title: listing.title,\n      price: 0,\n      description: listing.content,\n      image: tnmissingImagesFiltered(listing),\n      url: listing.url,\n      site: \"trashnothing\"\n    }\n  });\n\n  this.setState(prevState => ({Data: shuffleArray([...prevState.Data,...trashNothingData])}));\n}\n\n///>Data calls\n////>Functions and constants\n\n  ///<Preliminary checks\n  if (!searchQuery) {\n    alert(\"Tell me what to search! üòÅ\");\n    return;\n  }\n\n  console.time(\"complete search\")\n  this.setState({Data: [], searchTerm: searchQuery.toLowerCase(), loading: true, landing: false});\n  if (Date.now() > this.state.ExpiryDate) {\n    console.log(\"this app does not have an access token! Getting access token\")\n    seteBayAccessToken()\n  } else {\n    console.log(\"this has an access token\" + this.state.AccessToken.substring(10,25));\n  }\n  ///>Preliminary checks\n\n  ///<The Timeline\n  setEbayData();\n  setDepopData();\n  setGumtreeData();\n  setFacebookData();\n  setEtsyData();\n  setTrashNothingData();\n\n\n\n  }\n\n  handleChange(searchQuery) {\n    this.setState({ searchTerm: searchQuery });\n    this.setData(searchQuery);\n\n  }\n\n  togglePopUp(listing) {\n    if (this.state.popUpListing.display === true ) {\n      this.setState({\n        popUpListing: {\n          display: false,\n          listing: {}\n        }\n      })\n    } else {\n      this.setState({\n        popUpListing: {\n          display: true,\n          listing: listing\n        }\n      })\n  }\n} \n\nchangeActiveListing(listing, direction) {\n    let currentActiveListingIndex = this.state.Data.indexOf(listing);\n\n    if (direction === \"next\") {\n      this.setState((prevState) => ({\n        popUpListing: {\n          display: true,\n          listing: prevState.Data[currentActiveListingIndex + 1]\n        }\n      }))\n    } else if (direction === \"previous\" && currentActiveListingIndex > 0) {\n      this.setState((prevState) => ({\n        popUpListing: {\n          display: true,\n          listing: prevState.Data[currentActiveListingIndex - 1]\n        }\n      }))\n    } else {\n      return;\n    }\n    \n\n  }\n  \n  render() {\n    return (\n      <div className=\"App w-100 h-full bg-white overflow-x-hidden z-0\">\n          {this.state.popUpListing.display ? <PopUpListing changeActiveListing={this.changeActiveListing} display={this.state.popUpListing.display} listing={this.state.popUpListing.listing} togglePopUp={this.togglePopUp}/> : null}\n          <SearchBar onChange={this.handleChange}/>\n          \n\n          {this.state.landing ? <Landing /> : null } \n          {this.state.loading ? null : <Results Data={this.state.Data}\n                  resultsDisplay={this.state.resultsDisplay}\n                  reOrderDisplay={this.reOrderDisplay} \n                  searchTerm={this.state.searchTerm}\n                  search={this.handleChange}\n                  togglePopUp={this.togglePopUp}\n                  />}\n         \n          {this.state.loading ? <LoadingPop /> : <p></p>}\n  \n      </div>\n    );\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}