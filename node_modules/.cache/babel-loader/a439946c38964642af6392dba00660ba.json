{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _toConsumableArray from\"/Users/joseph/Code/lomav2/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"/Users/joseph/Code/lomav2/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/joseph/Code/lomav2/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/joseph/Code/lomav2/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/joseph/Code/lomav2/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/joseph/Code/lomav2/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/joseph/Code/lomav2/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/joseph/Code/lomav2/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import\"tailwindcss/tailwind.css\";import{SearchBar}from'./Components/SearchBar';import{Results}from'./Components/Results';import{Landing}from'./Components/Landing';import{LoadingPop}from'./Components/LoadingPop';import{PopUpListing}from'./Components/PopUpListing';import{PopUpSearchSettings}from'./Components/PopUpSearchSettings';import{PopUpLogSign}from'./Components/PopUpLogSign';import{Sidebar}from'./Components/Sidebar';import{UserLikes}from'./Components/UserLikes';import{Repairs}from'./Components/Repairs';import{UserAccount}from'./Components/UserAccount';import{Community}from'./Components/Community';import imagePlaceholder from'./assets/gallery.png';import{hotjar}from'react-hotjar';var App=/*#__PURE__*/function(_React$Component){_inherits(App,_React$Component);var _super=_createSuper(App);function App(props){var _this;_classCallCheck(this,App);_this=_super.call(this,props);_this.state={Data:[],AccessToken:\"none\",ExpiryDate:0,resultsDisplay:\"‚ö°Ô∏è Trending ‚ö°Ô∏è\",mainDisplay:\"Landing\",// \"Results\"  //  \"Loading\" // \"UserLikes\" // \"Landing\"// \"Repairs\" //\"UserAccount\" // Community\ngridView:\"Images Only\",// \"Image + Description\"\nfilters:{sites:{ebay:true,trashnothing:true,etsy:true,facebook:true,gumtree:true,depop:true},range:{min:0,max:100000000}},searchTerm:\"\",landing:true,popUpListing:{display:false,listing:{}},popUpGeneral:null,//\"PopUpLogSign\",\npopUpSearchSettings:{display:false,maxResultPrice:1000},depopData:{data:[{nothing:\"none\"}],status:'unresolved'},gumtreeData:{data:[{nothing:\"none\"}],status:'unresolved'},facebookData:{data:[{nothing:\"none\"}],status:'unresolved'}};_this.handleChange=_this.handleChange.bind(_assertThisInitialized(_this));_this.setData=_this.setData.bind(_assertThisInitialized(_this));_this.reOrderDisplay=_this.reOrderDisplay.bind(_assertThisInitialized(_this));_this.togglePopUp=_this.togglePopUp.bind(_assertThisInitialized(_this));_this.toggleLanding=_this.toggleLanding.bind(_assertThisInitialized(_this));_this.changeActiveListing=_this.changeActiveListing.bind(_assertThisInitialized(_this));_this.toggleSearchSettings=_this.toggleSearchSettings.bind(_assertThisInitialized(_this));_this.setSiteFilters=_this.setSiteFilters.bind(_assertThisInitialized(_this));_this.toggleMainDisplay=_this.toggleMainDisplay.bind(_assertThisInitialized(_this));return _this;}_createClass(App,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;/////////FUNCTIONS AND CONSTANTS\nvar appLoaded=Date.now();var getEbayAccessToken=function getEbayAccessToken(){if(Date.now()>_this2.state.ExpiryDate){console.log(\"this app does not have an access token, getting access token\");var myHeaders=new Headers();myHeaders.append(\"Authorization\",\"Basic Sm9zZXBoVW4tTG9tYS1QUkQtMTk5YWQwZDkwLWY0Y2QyYjg4OlBSRC05OWFkMGQ5MDRiYjEtZjYzMS00OGMyLTkwNTQtYTQ5Yg==\");myHeaders.append(\"Content-Type\",\"application/x-www-form-urlencoded\");myHeaders.append(\"Cookie\",\"ebay=%5Esbf%3D%23%5E; dp1=bu1p/QEBfX0BAX19AQA**6379634c^\");var urlencoded=new URLSearchParams();urlencoded.append(\"grant_type\",\"client_credentials\");urlencoded.append(\"scope\",\"https://api.ebay.com/oauth/api_scope\");var requestOptions={method:'POST',headers:myHeaders,body:urlencoded,redirect:'follow'};fetch(\"https://loma-cors.herokuapp.com/https://api.ebay.com/identity/v1/oauth2/token\",requestOptions).then(function(response){return response.json();}).then(function(jsonresponse){_this2.setState({AccessToken:jsonresponse.access_token,ExpiryDate:Date.now()+jsonresponse.expires_in*1000});var accessTokenSet=Date.now()-appLoaded;console.log(\"apiAccessToken = \".concat(_this2.state.AccessToken,\", took \").concat(accessTokenSet,\" milliseconds\"));}).catch(function(error){return console.log('error',error);});}};///////<DATA CLEANERS>\nvar isNull=function isNull(property){if(property===null||property===undefined){return\" \";}else{return property;}};var facebookPriceParsed=function facebookPriceParsed(price){var rawPrice=price.substring(1);if(!price||price===\"FREE\"){return\"0\";}else if(price===\"See listings near me\"){return\"~\";}else if(!rawPrice.includes(\"¬£\")){return rawPrice;}else if(rawPrice.includes(\"¬£\")){return rawPrice.substring(0,rawPrice.indexOf(\"¬£\"));}};var isPriceNull=function isPriceNull(price){if(price===undefined||price===null){return\"~\";}else{return price.substring(1);}};var missingImagesFiltered=function missingImagesFiltered(imageProp){if(imageProp===null||imageProp===undefined){return imagePlaceholder;}else{return imageProp;}};///////</DATA CLEANERS END>\nvar getDepopData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var depop_url,depopResponse,depopData,depopDataParsed,depopDataSetTime;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log(\"getting depop data\");depop_url=\"https://api.apify.com/v2/datasets/ml97NZifdmN1EFUSb/items?clean=true&format=json\";_context.next=4;return fetch(depop_url);case 4:depopResponse=_context.sent;_context.next=7;return depopResponse.json();case 7:depopData=_context.sent;_context.next=10;return depopData.map(function(listing){return{title:isNull(listing.title),price:isPriceNull(listing.price),description:isNull(listing.description),image:isNull(missingImagesFiltered(listing.image)),url:isNull(listing.url),site:\"depop\"};});case 10:depopDataParsed=_context.sent;_this2.setState({depopData:{data:depopDataParsed,status:'resolved'}});depopDataSetTime=Date.now()-appLoaded;console.log(\"depop data has been set, it took this many milliseconds: \"+depopDataSetTime);case 14:case\"end\":return _context.stop();}}},_callee);}));return function getDepopData(){return _ref.apply(this,arguments);};}();///\nvar getGumtreeData=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var gumtree_url,gumtreeResponse,gumtreeData,gumtreeDataParsed,gumtreeDataSetTime;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:console.log(\"getting gumtree data\");gumtree_url=\"https://api.apify.com/v2/datasets/Dh5XzAb9fvidWw285/items?format=json&clean=1\";_context2.next=4;return fetch(gumtree_url);case 4:gumtreeResponse=_context2.sent;_context2.next=7;return gumtreeResponse.json();case 7:gumtreeData=_context2.sent;_context2.next=10;return gumtreeData.map(function(listing){return{title:listing.title,price:listing.price.substring(1),description:listing.description,image:missingImagesFiltered(listing.image),url:listing.url,site:\"gumtree\"};});case 10:gumtreeDataParsed=_context2.sent;_this2.setState({gumtreeData:{data:gumtreeDataParsed,status:'resolved'}});gumtreeDataSetTime=Date.now()-appLoaded;console.log(\"gumtree data has been set, it took this many milliseconds: \"+gumtreeDataSetTime);case 14:case\"end\":return _context2.stop();}}},_callee2);}));return function getGumtreeData(){return _ref2.apply(this,arguments);};}();///\nvar getFacebookData=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var facebook_url,facebookResponse,facebookData,facebookDataParsed,facebookDataSetTime;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:console.log(\"getting facebook data\");facebook_url=\"https://api.apify.com/v2/datasets/IitkxYE95yydtzFlk/items?clean=true&format=json\";_context3.next=4;return fetch(facebook_url);case 4:facebookResponse=_context3.sent;_context3.next=7;return facebookResponse.json();case 7:facebookData=_context3.sent;facebookDataParsed=facebookData.map(function(listing){return{title:\"\"+isNull(listing.title),price:\"\"+facebookPriceParsed(listing.price),description:\"\"+isNull(listing.description),image:\"\"+missingImagesFiltered(listing.image),url:\"\"+isNull(listing.url),site:\"facebook\"};});_this2.setState({facebookData:{data:facebookDataParsed,status:'resolved'}});facebookDataSetTime=Date.now()-appLoaded;console.log(\"facebook data has been set, it took this many milliseconds: \"+facebookDataSetTime);case 12:case\"end\":return _context3.stop();}}},_callee3);}));return function getFacebookData(){return _ref3.apply(this,arguments);};}();///////\n// getEbayAccessToken();\n// getDepopData();\n// getGumtreeData();\n// getFacebookData();\n// hotjar.initialize(2123002,6);\n// console.log(\"access token\" +  this.state.AccessToken);\n}//COMPONENT MOUNT ENDS\n},{key:\"toggleMainDisplay\",value:function(){var _toggleMainDisplay=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(newDisplay){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return this.setState({mainDisplay:newDisplay});case 2:case\"end\":return _context4.stop();}}},_callee4,this);}));function toggleMainDisplay(_x){return _toggleMainDisplay.apply(this,arguments);}return toggleMainDisplay;}()},{key:\"setSiteFilters\",value:function(){var _setSiteFilters=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(newSearchTerm,eBayFilter,trashNothingFilter,etsyFilter,facebookFilter,gumtreeFilter,depopFilter,minRange,maxRange,sortOrder,gridView){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return this.setState(function(prevState){return{resultsDisplay:sortOrder,gridView:gridView,filters:{sites:{ebay:eBayFilter,trashnothing:trashNothingFilter,etsy:etsyFilter,facebook:facebookFilter,gumtree:gumtreeFilter,depop:depopFilter},range:{min:minRange,max:maxRange}},searchTerm:newSearchTerm,popUpSearchSettings:{display:!prevState.popUpSearchSettings.display,maxResultPrice:prevState.popUpSearchSettings.maxResultPrice}};});case 2:console.log(this.state.filters);this.setData(newSearchTerm);case 4:case\"end\":return _context5.stop();}}},_callee5,this);}));function setSiteFilters(_x2,_x3,_x4,_x5,_x6,_x7,_x8,_x9,_x10,_x11,_x12){return _setSiteFilters.apply(this,arguments);}return setSiteFilters;}()},{key:\"toggleSearchSettings\",value:function(){var _toggleSearchSettings=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){var highestPrice;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:console.log(\"search settings toggled\");if(!(this.state.popUpSearchSettings.display===true)){_context6.next=6;break;}_context6.next=4;return this.setState({popUpSearchSettings:{display:false}});case 4:_context6.next=12;break;case 6:if(!(this.state.popUpSearchSettings.display===false)){_context6.next=12;break;}_context6.next=9;return this.state.Data.reduce(function(current,item){if(item.price!==\"~\"){return current>Number(item.price)?current:Number(item.price);}else{return item.price;}},0);case 9:highestPrice=_context6.sent;console.log(highestPrice);this.setState({popUpSearchSettings:{display:true,maxResultPrice:highestPrice}});case 12:case\"end\":return _context6.stop();}}},_callee6,this);}));function toggleSearchSettings(){return _toggleSearchSettings.apply(this,arguments);}return toggleSearchSettings;}()},{key:\"handleChange\",value:function handleChange(searchQuery){this.setState({searchTerm:searchQuery});this.setData(searchQuery);}},{key:\"togglePopUp\",value:function togglePopUp(listing){if(this.state.popUpListing.display===true){this.setState({popUpListing:{display:false,listing:{}}});}else{this.setState({popUpListing:{display:true,listing:listing}});}}},{key:\"changeActiveListing\",value:function changeActiveListing(listing,direction){var currentActiveListingIndex=this.state.Data.indexOf(listing);if(direction===\"next\"){this.setState(function(prevState){return{popUpListing:{display:true,listing:prevState.Data[currentActiveListingIndex+1]}};});}else if(direction===\"previous\"&&currentActiveListingIndex>0){this.setState(function(prevState){return{popUpListing:{display:true,listing:prevState.Data[currentActiveListingIndex-1]}};});}else{return;}}},{key:\"toggleLanding\",value:function toggleLanding(){this.setState({landing:true});}},{key:\"reOrderDisplay\",value:function(){var _reOrderDisplay=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(sortOrder){var shuffleArray,highest,lowest;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:lowest=function _lowest(a,b){if(Number(a.price)<Number(b.price)){return-1;}if(Number(a.price)>Number(b.price)){return 1;}return 0;};highest=function _highest(a,b){if(Number(a.price)<Number(b.price)){return 1;}if(Number(a.price)>Number(b.price)){return-1;}return 0;};shuffleArray=function _shuffleArray(array){for(var i=array.length-1;i>0;i--){var j=Math.floor(Math.random()*(i+1));var temp=array[i];array[i]=array[j];array[j]=temp;}return array;};_context7.next=5;return this.setState({resultsDisplay:sortOrder});case 5:if(this.state.Data){if(this.state.resultsDisplay===\"‚ö°Ô∏è Trending ‚ö°Ô∏è\"){this.setState({Data:shuffleArray(this.state.Data)});}else if(this.state.resultsDisplay===\"Highest price first ‚ñ≤\"){this.setState({Data:this.state.Data.sort(highest)});}else if(this.state.resultsDisplay===\"Lowest price first ‚ñº\"){this.setState({Data:this.state.Data.sort(lowest)});}}case 6:case\"end\":return _context7.stop();}}},_callee7,this);}));function reOrderDisplay(_x13){return _reOrderDisplay.apply(this,arguments);}return reOrderDisplay;}()},{key:\"setData\",value:function setData(searchQuery){var _this3=this;///<Functions and constants\nfunction shuffleArray(array){for(var i=array.length-1;i>0;i--){var j=Math.floor(Math.random()*(i+1));var temp=array[i];array[i]=array[j];array[j]=temp;}return array;}var isNull=function isNull(property){if(property===null||property===undefined){return\" \";}else{return property;}};var isPriceNull=function isPriceNull(price){if(price===undefined||price===null){return\"~\";}else{return price.substring(1);}};var ebayPriceParsed=function ebayPriceParsed(listing){if(listing.price.currency===\"USD\"){return listing.price.convertedFromValue?listing.price.convertedFromValue:listing.price.value;}else{return listing.price.value;}};var facebookPriceParsed=function facebookPriceParsed(price){var rawPrice=price.substring(1);if(!price||price===\"FREE\"){return\"0\";}else if(price===\"See listings near me\"){return\"~\";}else if(!rawPrice.includes(\"¬£\")){return rawPrice;}else if(rawPrice.includes(\"¬£\")){return rawPrice.substring(0,rawPrice.indexOf(\"¬£\"));}};var missingImagesFiltered=function missingImagesFiltered(imageProp){if(imageProp===null||imageProp===undefined){return imagePlaceholder;}else{return imageProp;}};var tnmissingImagesFiltered=function tnmissingImagesFiltered(listing){if(!listing.photos){return imagePlaceholder;}else{return listing.photos[0].url;}};var eBayMissingImagesFiltered=function eBayMissingImagesFiltered(listing){if(!listing.hasOwnProperty(\"image\")||!listing.image.hasOwnProperty(\"imageUrl\")){return imagePlaceholder;}else{return listing.thumbnailImages[0].imageUrl;}};///<Data calls\nvar setEbayData=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(){var myHeaders,urlencoded,requestOptions,tokenResponse,jsonToken,accessToken,ebayHeaders,ebayrequestOptions,ebayresponse,jsonresponse,ebayDataParsed;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:if(!(_this3.state.AccessToken===\"none\")){_context8.next=19;break;}console.log(\"this does not have an access token\");myHeaders=new Headers();myHeaders.append(\"Authorization\",\"Basic Sm9zZXBoVW4tTG9tYS1QUkQtMTk5YWQwZDkwLWY0Y2QyYjg4OlBSRC05OWFkMGQ5MDRiYjEtZjYzMS00OGMyLTkwNTQtYTQ5Yg==\");myHeaders.append(\"Content-Type\",\"application/x-www-form-urlencoded\");myHeaders.append(\"Cookie\",\"ebay=%5Esbf%3D%23%5E; dp1=bu1p/QEBfX0BAX19AQA**6379634c^\");urlencoded=new URLSearchParams();urlencoded.append(\"grant_type\",\"client_credentials\");urlencoded.append(\"scope\",\"https://api.ebay.com/oauth/api_scope\");requestOptions={method:'POST',headers:myHeaders,body:urlencoded,redirect:'follow'};_context8.next=12;return fetch(\"https://loma-cors.herokuapp.com/https://api.ebay.com/identity/v1/oauth2/token\",requestOptions);case 12:tokenResponse=_context8.sent;_context8.next=15;return tokenResponse.json();case 15:jsonToken=_context8.sent;accessToken=jsonToken.access_token;_context8.next=19;return _this3.setState({AccessToken:accessToken,ExpiryDate:Date.now()+accessToken.expires_in*1000});case 19:console.log(\"fetching ebay data\");ebayHeaders=new Headers();ebayHeaders.append(\"Authorization\",\"Bearer \".concat(_this3.state.AccessToken));ebayHeaders.append(\"Content-Type\",\"application/json\");ebayHeaders.append(\"X-EBAY-C-MARKETPLACE-ID\",\"EBAY_US\");ebayHeaders.append(\"X-EBAY-C-ENDUSERCTX\",\"affiliateCampaignId=<ePNCampaignId>,affiliateReferenceId=<referenceId>\");ebayrequestOptions={method:'GET',headers:ebayHeaders,redirect:'follow'};_context8.next=28;return fetch(\"https://loma-cors.herokuapp.com/https://api.ebay.com/buy/browse/v1/item_summary/search?q=\".concat(searchQuery,\"&limit=200&filter=price:[\").concat(_this3.state.filters.range.min,\"..\").concat(_this3.state.filters.range.max,\"],priceCurrency:GBP,conditions:{UNSPECIFIED|USED},itemLocationCountry:GB&fieldgroups=EXTENDED\"),ebayrequestOptions);case 28:ebayresponse=_context8.sent;_context8.next=31;return ebayresponse.json();case 31:jsonresponse=_context8.sent;ebayDataParsed=function ebayDataParsed(){if(jsonresponse.itemSummaries){return jsonresponse.itemSummaries.map(function(listing){return{title:isNull(listing.title),description:isNull(listing.shortDescription),price:isNull(ebayPriceParsed(listing)),image:eBayMissingImagesFiltered(listing),url:isNull(listing.itemWebUrl),site:\"ebay\"};});}else{return[];}};_this3.setState(function(prevState){return{mainDisplay:\"Results\",Data:[].concat(_toConsumableArray(prevState.Data),_toConsumableArray(ebayDataParsed()))};});_this3.reOrderDisplay(_this3.state.resultsDisplay);case 35:case\"end\":return _context8.stop();}}},_callee8);}));return function setEbayData(){return _ref4.apply(this,arguments);};}();var setDepopData=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(){var depop_url,depopResponse,depopData,depopDataFiltered,depopDataParsed,_depopDataFiltered;return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:if(!(_this3.state.depopData.status===\"unresolved\")){_context9.next=15;break;}depop_url=\"https://api.apify.com/v2/datasets/ml97NZifdmN1EFUSb/items?clean=true&format=json\";_context9.next=4;return fetch(depop_url);case 4:depopResponse=_context9.sent;_context9.next=7;return depopResponse.json();case 7:depopData=_context9.sent;depopDataFiltered=depopData.filter(function(listing){if(isNull(listing.title).toLowerCase().includes(_this3.state.searchTerm)&&listing.price>=_this3.state.filters.range.min&&listing.price<=_this3.state.filters.range.max){return true;}else if(isNull(listing.description).toLowerCase().includes(_this3.state.searchTerm)&&listing.price>=_this3.state.filters.range.min&&listing.price<=_this3.state.filters.range.max){return true;}else{return false;}});depopDataParsed=depopDataFiltered.map(function(listing){return{title:isNull(listing.title),price:isPriceNull(listing.price),description:isNull(listing.description),image:isNull(missingImagesFiltered(listing.image)),url:isNull(listing.url),site:\"depop\"};});_this3.setState({depopData:{data:depopDataParsed,status:'resolved'}});_this3.setState(function(prevState){return{loading:false,Data:[].concat(_toConsumableArray(prevState.Data),_toConsumableArray(depopDataParsed))};});_this3.reOrderDisplay(_this3.state.resultsDisplay);_context9.next=16;break;case 15:if(_this3.state.depopData.status===\"resolved\"){_depopDataFiltered=_this3.state.depopData.data.filter(function(listing){if(isNull(listing.title).toLowerCase().includes(_this3.state.searchTerm)&&listing.price>=_this3.state.filters.range.min&&listing.price<=_this3.state.filters.range.max){return true;}else if(isNull(listing.description).toLowerCase().includes(_this3.state.searchTerm)&&listing.price>=_this3.state.filters.range.min&&listing.price<=_this3.state.filters.range.max){return true;}else{return false;}});_this3.setState(function(prevState){return{Data:[].concat(_toConsumableArray(prevState.Data),_toConsumableArray(_depopDataFiltered))};});_this3.reOrderDisplay(_this3.state.resultsDisplay);}case 16:case\"end\":return _context9.stop();}}},_callee9);}));return function setDepopData(){return _ref5.apply(this,arguments);};}();var setGumtreeData=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee10(){var gumtree_url,gumtreeResponse,gumtreeData,gumtreeDataFiltered,gumtreeDataParsed,_gumtreeDataFiltered;return _regeneratorRuntime.wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:if(!(_this3.state.gumtreeData.status===\"unresolved\")){_context10.next=15;break;}gumtree_url=\"https://api.apify.com/v2/datasets/Dh5XzAb9fvidWw285/items?format=json&clean=1\";_context10.next=4;return fetch(gumtree_url);case 4:gumtreeResponse=_context10.sent;_context10.next=7;return gumtreeResponse.json();case 7:gumtreeData=_context10.sent;gumtreeDataFiltered=gumtreeData.filter(function(listing){if(isNull(listing.title).toLowerCase().includes(_this3.state.searchTerm)&&listing.price>=_this3.state.filters.range.min&&listing.price<=_this3.state.filters.range.max){return true;}else if(isNull(listing.description).toLowerCase().includes(_this3.state.searchTerm)&&listing.price>=_this3.state.filters.range.min&&listing.price<=_this3.state.filters.range.max){return true;}else{return false;}});gumtreeDataParsed=gumtreeDataFiltered.map(function(listing){return{title:listing.title,price:listing.price.substring(1),description:listing.description,image:missingImagesFiltered(listing.image),url:listing.url,site:\"gumtree\"};});_this3.setState({depopData:{data:gumtreeDataParsed,status:'resolved'}});_this3.setState(function(prevState){return{mainDisplay:\"Results\",Data:[].concat(_toConsumableArray(prevState.Data),_toConsumableArray(gumtreeDataFiltered))};});_this3.reOrderDisplay(_this3.state.resultsDisplay);_context10.next=18;break;case 15:_gumtreeDataFiltered=_this3.state.gumtreeData.data.filter(function(listing){if(isNull(listing.title).toLowerCase().includes(_this3.state.searchTerm)&&listing.price>=_this3.state.filters.range.min&&listing.price<=_this3.state.filters.range.max){return true;}else if(isNull(listing.description).toLowerCase().includes(_this3.state.searchTerm)&&listing.price>=_this3.state.filters.range.min&&listing.price<=_this3.state.filters.range.max){return true;}else{return false;}});_this3.setState(function(prevState){return{Data:[].concat(_toConsumableArray(prevState.Data),_toConsumableArray(_gumtreeDataFiltered))};});_this3.reOrderDisplay(_this3.state.resultsDisplay);case 18:case\"end\":return _context10.stop();}}},_callee10);}));return function setGumtreeData(){return _ref6.apply(this,arguments);};}();var setFacebookData=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee11(){var facebook_url,facebookResponse,facebookData,facebookDataFiltered,facebookDataParsed,_facebookDataFiltered;return _regeneratorRuntime.wrap(function _callee11$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:if(!(_this3.state.facebookData.status===\"unresolved\")){_context11.next=15;break;}facebook_url=\"https://api.apify.com/v2/datasets/IitkxYE95yydtzFlk/items?clean=true&format=json\";_context11.next=4;return fetch(facebook_url);case 4:facebookResponse=_context11.sent;_context11.next=7;return facebookResponse.json();case 7:facebookData=_context11.sent;facebookDataFiltered=facebookData.filter(function(listing){if(isNull(listing.title).toLowerCase().includes(_this3.state.searchTerm)&&listing.price>=_this3.state.filters.range.min&&listing.price<=_this3.state.filters.range.max){return true;}else if(isNull(listing.description).toLowerCase().includes(_this3.state.searchTerm)&&listing.price>=_this3.state.filters.range.min&&listing.price<=_this3.state.filters.range.max){return true;}else{return false;}});facebookDataParsed=facebookDataFiltered.map(function(listing){return{title:\"\"+isNull(listing.title),price:\"\"+facebookPriceParsed(listing.price),description:\"\"+isNull(listing.description),image:\"\"+missingImagesFiltered(listing.image),url:\"\"+isNull(listing.url),site:\"facebook\"};});_this3.setState({facebookData:{data:facebookDataParsed,status:'resolved'}});_this3.setState(function(prevState){return{mainDisplay:\"Results\",Data:[].concat(_toConsumableArray(prevState.Data),_toConsumableArray(facebookDataFiltered))};});_this3.reOrderDisplay(_this3.state.resultsDisplay);_context11.next=18;break;case 15:_facebookDataFiltered=_this3.state.facebookData.data.filter(function(listing){if(isNull(listing.title).toLowerCase().includes(_this3.state.searchTerm)&&listing.price>=_this3.state.filters.range.min&&listing.price<=_this3.state.filters.range.max){return true;}else if(isNull(listing.description).toLowerCase().includes(_this3.state.searchTerm)&&listing.price>=_this3.state.filters.range.min&&listing.price<=_this3.state.filters.range.max){return true;}else{return false;}});_this3.setState(function(prevState){return{Data:[].concat(_toConsumableArray(prevState.Data),_toConsumableArray(_facebookDataFiltered))};});_this3.reOrderDisplay(_this3.state.resultsDisplay);case 18:case\"end\":return _context11.stop();}}},_callee11);}));return function setFacebookData(){return _ref7.apply(this,arguments);};}();var setEtsyData=/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee12(){var etsyRaw,etsyJson,etsyDataResults,etsyData;return _regeneratorRuntime.wrap(function _callee12$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:_context12.next=2;return fetch(\"https://loma-cors.herokuapp.com/https://openapi.etsy.com/v2/listings/active?keywords=\".concat(searchQuery,\"&tags=vintage&limit=200&location=UK&api_key=sh1n3isgj6bax7eotlor7m4s&includes=Images&min_price=\").concat(_this3.state.filters.range.min,\"&max_price=\").concat(_this3.state.filters.range.max,\"&sort_on=score&sort_order=down\"));case 2:etsyRaw=_context12.sent;_context12.next=5;return etsyRaw.json();case 5:etsyJson=_context12.sent;etsyDataResults=etsyJson.results;etsyData=etsyDataResults.map(function(listing){var etsyFirstImage=listing.Images?missingImagesFiltered(listing.Images[0].url_570xN):imagePlaceholder;return{title:listing.title,price:listing.price,description:listing.description,image:etsyFirstImage,url:listing.url,site:\"etsy\"};});_this3.setState(function(prevState){return{mainDisplay:\"Results\",Data:[].concat(_toConsumableArray(prevState.Data),_toConsumableArray(etsyData))};});_this3.reOrderDisplay(_this3.state.resultsDisplay);case 10:case\"end\":return _context12.stop();}}},_callee12);}));return function setEtsyData(){return _ref8.apply(this,arguments);};}();var setTrashNothingData=/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee13(){var trashnothingRaw,tnJson,tnResults,trashNothingData;return _regeneratorRuntime.wrap(function _callee13$(_context13){while(1){switch(_context13.prev=_context13.next){case 0:_context13.next=2;return fetch(\"https://trashnothing.com/api/v1.2/posts/search?search=\".concat(searchQuery,\"&sort_by=relevance&types=offer&sources=trashnothing&per_page=50&page=4&device_pixel_ratio=1&latitude=51.507351&longitude=-0.127758&radius=200000&api_key=yr8sVaHEvbdkdunSFfPoDpqlwEjxIuqB3XhyFzx1\"));case 2:trashnothingRaw=_context13.sent;_context13.next=5;return trashnothingRaw.json();case 5:tnJson=_context13.sent;tnResults=tnJson.posts;trashNothingData=tnResults.map(function(listing){return{title:listing.title,price:0,description:listing.content,image:tnmissingImagesFiltered(listing),url:listing.url,site:\"trashnothing\"};});_this3.setState(function(prevState){return{mainDisplay:\"Results\",Data:[].concat(_toConsumableArray(prevState.Data),_toConsumableArray(trashNothingData))};});_this3.reOrderDisplay(_this3.state.resultsDisplay);case 10:case\"end\":return _context13.stop();}}},_callee13);}));return function setTrashNothingData(){return _ref9.apply(this,arguments);};}();///>Data calls\n////>Functions and constants\n///<Preliminary checks\nif(!searchQuery){alert(\"Tell me what to search! üòÅ\");return;}console.time(\"complete search\");this.setState({Data:[],searchTerm:searchQuery.toLowerCase(),mainDisplay:\"Loading\"});///>Preliminary checks\n///<The Timeline\nif(this.state.filters.sites.ebay){setEbayData();}if(this.state.filters.sites.depop){setDepopData();}if(this.state.filters.sites.gumtree){setGumtreeData();}if(this.state.filters.sites.facebook){setFacebookData();}if(this.state.filters.sites.etsy){setEtsyData();}if(this.state.filters.sites.trashnothing){setTrashNothingData();}}},{key:\"render\",value:function render(){return/*#__PURE__*/_jsxs(\"div\",{className:\"w-screen h-screen flex flex-row justify-center content-center mx-auto border\",children:[this.state.popUpListing.display?/*#__PURE__*/_jsx(PopUpListing,{changeActiveListing:this.changeActiveListing,display:this.state.popUpListing.display,listing:this.state.popUpListing.listing,togglePopUp:this.togglePopUp}):null,this.state.popUpSearchSettings.display?/*#__PURE__*/_jsx(PopUpSearchSettings,{toggleSearchSettings:this.toggleSearchSettings,filters:this.state.filters,maxResultPrice:this.state.popUpSearchSettings.maxResultPrice,searchTerm:this.state.searchTerm,display:this.state.resultsDisplay,gridView:this.state.gridView,setSiteFilters:this.setSiteFilters}):null,this.state.popUpGeneral===\"PopUpLogSign\"?/*#__PURE__*/_jsx(PopUpLogSign,{}):null,/*#__PURE__*/_jsxs(\"div\",{className:\"w-full flex flex-row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"se:hidden sm:block\",children:/*#__PURE__*/_jsx(Sidebar,{toggleMainDisplay:this.toggleMainDisplay})}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-full h-full bg-white overflow-x-hidden z-0\",children:[this.state.mainDisplay!==\"UserLikes\"&&this.state.mainDisplay!==\"Repairs\"&&this.state.mainDisplay!==\"UserAccount\"&&this.state.mainDisplay!==\"Community\"?/*#__PURE__*/_jsx(SearchBar,{onChange:this.handleChange,toggleMainDisplay:this.toggleMainDisplay,resultsDisplay:this.state.resultsDisplay,searchTerm:this.state.searchTerm}):null,this.state.mainDisplay===\"Landing\"?/*#__PURE__*/_jsx(Landing,{}):null,this.state.mainDisplay===\"Repairs\"?/*#__PURE__*/_jsx(Repairs,{toggleMainDisplay:this.toggleMainDisplay}):null,this.state.mainDisplay===\"Community\"?/*#__PURE__*/_jsx(Community,{toggleMainDisplay:this.toggleMainDisplay}):null,this.state.mainDisplay===\"UserLikes\"?/*#__PURE__*/_jsx(UserLikes,{toggleMainDisplay:this.toggleMainDisplay}):null,this.state.mainDisplay===\"UserAccount\"?/*#__PURE__*/_jsx(UserAccount,{toggleMainDisplay:this.toggleMainDisplay}):null,this.state.mainDisplay===\"Loading\"?/*#__PURE__*/_jsx(LoadingPop,{}):null,this.state.mainDisplay===\"Results\"?/*#__PURE__*/_jsx(Results,{Data:this.state.Data,resultsDisplay:this.state.resultsDisplay,reOrderDisplay:this.reOrderDisplay,searchTerm:this.state.searchTerm,search:this.handleChange,togglePopUp:this.togglePopUp,toggleSearchSettings:this.toggleSearchSettings,gridView:this.state.gridView}):null]})]})]});}}]);return App;}(React.Component);export default App;","map":{"version":3,"sources":["/Users/joseph/Code/lomav2/src/App.js"],"names":["React","SearchBar","Results","Landing","LoadingPop","PopUpListing","PopUpSearchSettings","PopUpLogSign","Sidebar","UserLikes","Repairs","UserAccount","Community","imagePlaceholder","hotjar","App","props","state","Data","AccessToken","ExpiryDate","resultsDisplay","mainDisplay","gridView","filters","sites","ebay","trashnothing","etsy","facebook","gumtree","depop","range","min","max","searchTerm","landing","popUpListing","display","listing","popUpGeneral","popUpSearchSettings","maxResultPrice","depopData","data","nothing","status","gumtreeData","facebookData","handleChange","bind","setData","reOrderDisplay","togglePopUp","toggleLanding","changeActiveListing","toggleSearchSettings","setSiteFilters","toggleMainDisplay","appLoaded","Date","now","getEbayAccessToken","console","log","myHeaders","Headers","append","urlencoded","URLSearchParams","requestOptions","method","headers","body","redirect","fetch","then","response","json","jsonresponse","setState","access_token","expires_in","accessTokenSet","catch","error","isNull","property","undefined","facebookPriceParsed","price","rawPrice","substring","includes","indexOf","isPriceNull","missingImagesFiltered","imageProp","getDepopData","depop_url","depopResponse","map","title","description","image","url","site","depopDataParsed","depopDataSetTime","getGumtreeData","gumtree_url","gumtreeResponse","gumtreeDataParsed","gumtreeDataSetTime","getFacebookData","facebook_url","facebookResponse","facebookDataParsed","facebookDataSetTime","newDisplay","newSearchTerm","eBayFilter","trashNothingFilter","etsyFilter","facebookFilter","gumtreeFilter","depopFilter","minRange","maxRange","sortOrder","prevState","reduce","current","item","Number","highestPrice","searchQuery","direction","currentActiveListingIndex","shuffleArray","highest","lowest","a","b","array","i","length","j","Math","floor","random","temp","sort","ebayPriceParsed","currency","convertedFromValue","value","tnmissingImagesFiltered","photos","eBayMissingImagesFiltered","hasOwnProperty","thumbnailImages","imageUrl","setEbayData","tokenResponse","jsonToken","accessToken","ebayHeaders","ebayrequestOptions","ebayresponse","ebayDataParsed","itemSummaries","shortDescription","itemWebUrl","setDepopData","depopDataFiltered","filter","toLowerCase","loading","setGumtreeData","gumtreeDataFiltered","setFacebookData","facebookDataFiltered","setEtsyData","etsyRaw","etsyJson","etsyDataResults","results","etsyData","etsyFirstImage","Images","url_570xN","setTrashNothingData","trashnothingRaw","tnJson","tnResults","posts","trashNothingData","content","alert","time","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport \"tailwindcss/tailwind.css\"\n\nimport { SearchBar } from './Components/SearchBar';\nimport { Results } from './Components/Results';\nimport { Landing } from './Components/Landing';\nimport { LoadingPop } from './Components/LoadingPop';\nimport { PopUpListing } from './Components/PopUpListing';\nimport { PopUpSearchSettings } from './Components/PopUpSearchSettings';\nimport { PopUpLogSign } from './Components/PopUpLogSign';\nimport { Sidebar } from './Components/Sidebar';\nimport { UserLikes } from './Components/UserLikes';\nimport { Repairs } from './Components/Repairs';\nimport { UserAccount } from './Components/UserAccount';\nimport { Community } from './Components/Community';\n\n\nimport imagePlaceholder from './assets/gallery.png';\n\nimport { hotjar } from 'react-hotjar';\n\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      Data: [],\n      AccessToken: \"none\",\n      ExpiryDate: 0,\n      resultsDisplay: \"‚ö°Ô∏è Trending ‚ö°Ô∏è\",\n      mainDisplay: \"Landing\", // \"Results\"  //  \"Loading\" // \"UserLikes\" // \"Landing\"// \"Repairs\" //\"UserAccount\" // Community\n      gridView: \"Images Only\", // \"Image + Description\"\n      filters: {\n        sites: {\n          ebay: true,\n          trashnothing: true,\n          etsy: true,\n          facebook: true,\n          gumtree: true,\n          depop: true,\n        },\n        range: {\n          min: 0,\n          max: 100000000,\n        }\n      },\n      searchTerm: \"\",\n      landing: true,\n      popUpListing: {\n        display: false,\n        listing: {}\n      },\n      popUpGeneral: null, //\"PopUpLogSign\",\n      popUpSearchSettings: {\n        display: false,\n        maxResultPrice: 1000\n      },\n      depopData: {\n        data: [{nothing : \"none\"}],\n        status: 'unresolved'\n      },\n      gumtreeData: {\n        data: [{nothing : \"none\"}],\n        status: 'unresolved'\n      },\n      facebookData: {\n        data: [{nothing : \"none\"}],\n        status: 'unresolved'\n      }\n    }\n    this.handleChange = this.handleChange.bind(this);\n    this.setData = this.setData.bind(this);\n    this.reOrderDisplay = this.reOrderDisplay.bind(this);\n    this.togglePopUp = this.togglePopUp.bind(this);\n    this.toggleLanding = this.toggleLanding.bind(this);\n    this.changeActiveListing = this.changeActiveListing.bind(this);\n    this.toggleSearchSettings = this.toggleSearchSettings.bind(this);\n    this.setSiteFilters = this.setSiteFilters.bind(this);\n    this.toggleMainDisplay = this.toggleMainDisplay.bind(this);\n  }\n\n  componentDidMount() {\n  /////////FUNCTIONS AND CONSTANTS\n    const appLoaded = Date.now()\n    const getEbayAccessToken = () => {\n    if (Date.now() > this.state.ExpiryDate) {\n      console.log(\"this app does not have an access token, getting access token\")\n\n      var myHeaders = new Headers();\n      myHeaders.append(\"Authorization\", \"Basic Sm9zZXBoVW4tTG9tYS1QUkQtMTk5YWQwZDkwLWY0Y2QyYjg4OlBSRC05OWFkMGQ5MDRiYjEtZjYzMS00OGMyLTkwNTQtYTQ5Yg==\");\n      myHeaders.append(\"Content-Type\", \"application/x-www-form-urlencoded\");\n      myHeaders.append(\"Cookie\", \"ebay=%5Esbf%3D%23%5E; dp1=bu1p/QEBfX0BAX19AQA**6379634c^\");\n      \n      var urlencoded = new URLSearchParams();\n      urlencoded.append(\"grant_type\", \"client_credentials\");\n      urlencoded.append(\"scope\", \"https://api.ebay.com/oauth/api_scope\");\n      \n      var requestOptions = {\n        method: 'POST',\n        headers: myHeaders,\n        body: urlencoded,\n        redirect: 'follow'\n      };\n      \n      fetch(\"https://loma-cors.herokuapp.com/https://api.ebay.com/identity/v1/oauth2/token\", requestOptions)\n          .then(response => response.json())\n          .then(jsonresponse => {\n            this.setState({\n              AccessToken: jsonresponse.access_token,\n              ExpiryDate: Date.now() + jsonresponse.expires_in * 1000\n            })\n            let accessTokenSet = Date.now() - appLoaded;\n            console.log(`apiAccessToken = ${this.state.AccessToken}, took ${accessTokenSet} milliseconds`);\n          })\n          .catch(error => console.log('error', error));\n        } \n    }\n\n\n    ///////<DATA CLEANERS>\n    const isNull = (property) => {\n      if (property === null || property === undefined) {\n     return \" \";\n     } else {\n       return property;\n     }\n     };\n\n     const facebookPriceParsed = (price) => {\n      let rawPrice = price.substring(1);\n      if (!price || price === \"FREE\") {\n        return \"0\"\n      } else if (price === \"See listings near me\") {\n        return \"~\"\n      } else if (!rawPrice.includes(\"¬£\")){\n        return rawPrice;\n      } else if (rawPrice.includes(\"¬£\")) {\n        return rawPrice.substring(0, rawPrice.indexOf(\"¬£\"));\n      }\n    };\n     \n\n     const isPriceNull = (price) => {\n      if (price === undefined || price === null) {\n        return \"~\";\n      } else {\n        return price.substring(1)\n      }\n    };\n\n    const missingImagesFiltered = (imageProp) => {\n      if (imageProp === null || imageProp === undefined) {\n        return imagePlaceholder;\n      } else {\n        return imageProp;\n      }\n    }\n    ///////</DATA CLEANERS END>\n    const getDepopData = async () => {\n      console.log(\"getting depop data\")\n    \n    const depop_url = \"https://api.apify.com/v2/datasets/ml97NZifdmN1EFUSb/items?clean=true&format=json\";\n    const depopResponse = await fetch(depop_url);\n    const depopData = await depopResponse.json();\n\n    const depopDataParsed = await depopData.map(\n      (listing) => {\n        return {\n          title: isNull(listing.title),\n          price: isPriceNull(listing.price),\n          description: isNull(listing.description),\n          image: isNull(missingImagesFiltered(listing.image)),\n          url: isNull(listing.url),\n          site: \"depop\"\n        }\n      }\n    );\n\n    this.setState({\n      depopData : {\n        data: depopDataParsed,\n        status: 'resolved'\n      }\n    })\n\n    let depopDataSetTime = Date.now() - appLoaded\n\n    console.log(\"depop data has been set, it took this many milliseconds: \" + depopDataSetTime);\n\n    }\n\n///\n\n    const getGumtreeData = async () => {\n      console.log(\"getting gumtree data\")\n    \n      const gumtree_url = \"https://api.apify.com/v2/datasets/Dh5XzAb9fvidWw285/items?format=json&clean=1\"\n      const gumtreeResponse = await fetch(gumtree_url);\n      const gumtreeData = await gumtreeResponse.json();\n  \n      const gumtreeDataParsed = await gumtreeData.map(\n        listing => {\n          return {\n            title: listing.title,\n            price: listing.price.substring(1),\n            description: listing.description,\n            image: missingImagesFiltered(listing.image),\n            url: listing.url,\n            site: \"gumtree\"\n          }\n        }\n      )\n\n    this.setState({\n      gumtreeData : {\n        data: gumtreeDataParsed,\n        status: 'resolved'\n      }\n    })\n    let gumtreeDataSetTime = Date.now() - appLoaded\n\n    console.log(\"gumtree data has been set, it took this many milliseconds: \" + gumtreeDataSetTime);\n\n    }\n\n\n    ///\n\n    const getFacebookData = async () => {\n      console.log(\"getting facebook data\")\n    \n      const facebook_url = \"https://api.apify.com/v2/datasets/IitkxYE95yydtzFlk/items?clean=true&format=json\"\n      const facebookResponse = await fetch(facebook_url);\n      const facebookData = await facebookResponse.json();\n  \n      const facebookDataParsed = facebookData.map(\n        listing => {\n          return {\n            title: \"\" + isNull(listing.title),\n            price: \"\" + facebookPriceParsed(listing.price),\n            description: \"\" + isNull(listing.description),\n            image: \"\" + missingImagesFiltered(listing.image),\n            url: \"\" + isNull(listing.url),\n            site: \"facebook\"\n          }\n        }\n      )\n  \n  \n\n    this.setState({\n      facebookData : {\n        data: facebookDataParsed,\n        status: 'resolved'\n      }\n    })\n\n    let facebookDataSetTime = Date.now() - appLoaded\n\n    console.log(\"facebook data has been set, it took this many milliseconds: \" + facebookDataSetTime);\n\n    }\n\n\n    ///////\n    // getEbayAccessToken();\n    // getDepopData();\n    // getGumtreeData();\n    // getFacebookData();\n    // hotjar.initialize(2123002,6);\n    // console.log(\"access token\" +  this.state.AccessToken);\n    \n  } //COMPONENT MOUNT ENDS\n\n  async toggleMainDisplay(newDisplay) {\n    await this.setState({\n      mainDisplay: newDisplay\n    })\n  } \n  async setSiteFilters(\n    newSearchTerm, \n    eBayFilter, \n    trashNothingFilter, \n    etsyFilter, \n    facebookFilter, \n    gumtreeFilter, \n    depopFilter, \n    minRange, \n    maxRange,\n    sortOrder,\n    gridView) {\n    await this.setState(prevState => ({\n      resultsDisplay: sortOrder,\n      gridView: gridView,\n      filters: {\n        sites: {\n          ebay: eBayFilter,\n          trashnothing: trashNothingFilter,\n          etsy: etsyFilter,\n          facebook: facebookFilter,\n          gumtree: gumtreeFilter,\n          depop: depopFilter,\n        },\n        range: {\n          min: minRange,\n          max: maxRange,\n        }\n      },\n      searchTerm: newSearchTerm,\n      popUpSearchSettings: {\n        display: !prevState.popUpSearchSettings.display,\n        maxResultPrice: prevState.popUpSearchSettings.maxResultPrice\n      }\n    })\n  )\n    console.log(this.state.filters)\n    this.setData(newSearchTerm)\n  }\n\n  async toggleSearchSettings() {\n    console.log(\"search settings toggled\")\n    if (this.state.popUpSearchSettings.display === true) {\n      await this.setState({\n        popUpSearchSettings: {\n          display: false\n        }\n      })\n    } else if (this.state.popUpSearchSettings.display === false) {\n\n      let highestPrice = await this.state.Data.reduce(function(current, item) {\n        if (item.price !== \"~\") {\n          return (current > Number(item.price) ? current : Number(item.price))\n        } else {\n          return item.price\n        }\n      }, 0)\n\n      console.log(highestPrice);\n      \n      this.setState({\n        popUpSearchSettings: {\n          display: true,\n          maxResultPrice: highestPrice\n        }\n      })\n\n    }\n  }\n\n\n  handleChange(searchQuery) {\n    this.setState({ searchTerm: searchQuery });\n    this.setData(searchQuery);\n\n  }\n\n  togglePopUp(listing) {\n    if (this.state.popUpListing.display === true ) {\n      this.setState({\n        popUpListing: {\n          display: false,\n          listing: {}\n        }\n      })\n    } else {\n      this.setState({\n        popUpListing: {\n          display: true,\n          listing: listing\n        }\n      })\n  }\n}  \n\nchangeActiveListing(listing, direction) {\n    let currentActiveListingIndex = this.state.Data.indexOf(listing);\n\n    if (direction === \"next\") {\n      this.setState((prevState) => ({\n        popUpListing: {\n          display: true,\n          listing: prevState.Data[currentActiveListingIndex + 1]\n        }\n      }))\n    } else if (direction === \"previous\" && currentActiveListingIndex > 0) {\n      this.setState((prevState) => ({\n        popUpListing: {\n          display: true,\n          listing: prevState.Data[currentActiveListingIndex - 1]\n        }\n      }))\n    } else {\n      return;\n    }\n    \n\n  }\n\n  toggleLanding() {\n    this.setState({\n      landing: true,\n    }) \n  }\n\n  async reOrderDisplay(sortOrder) {\n    /// functions\n    await this.setState({resultsDisplay: sortOrder});\n\n    function shuffleArray(array) {\n      for (var i = array.length - 1; i > 0; i--) {\n          var j = Math.floor(Math.random() * (i + 1));\n          var temp = array[i];\n          array[i] = array[j];\n          array[j] = temp;\n      }\n      return array;\n  }\n\n  function highest( a, b ) {\n    if ( Number(a.price) < Number(b.price) ){\n      return 1;\n    }\n    if ( Number(a.price) > Number(b.price) ){\n      return -1;\n    }\n    return 0;\n  }\n\n  function lowest( a, b ) {\n    if ( Number(a.price) < Number(b.price) ){\n      return -1;\n    }\n    if ( Number(a.price) > Number(b.price) ){\n      return 1;\n    }\n    return 0;\n  } \n\n\n  if (this.state.Data) {\n      if (this.state.resultsDisplay === \"‚ö°Ô∏è Trending ‚ö°Ô∏è\") {\n        this.setState({Data: shuffleArray(this.state.Data)})\n      } else if (this.state.resultsDisplay === \"Highest price first ‚ñ≤\") {\n        this.setState({Data: this.state.Data.sort(highest)})\n      } else if (this.state.resultsDisplay === \"Lowest price first ‚ñº\") {\n        this.setState({Data: this.state.Data.sort(lowest)}) }\n        }\n  \n \n  }\n  \n\nsetData(searchQuery) {\n ///<Functions and constants\n\n function shuffleArray(array) {\n  for (var i = array.length - 1; i > 0; i--) {\n      var j = Math.floor(Math.random() * (i + 1));\n      var temp = array[i];\n      array[i] = array[j];\n      array[j] = temp;\n  }\n  return array;\n}\n\n const isNull = (property) => {\n  if (property === null || property === undefined) {\n  return \" \";\n  } else {\n    return property;\n  }\n};\n\nconst isPriceNull = (price) => {\n  if (price === undefined || price === null) {\n    return \"~\";\n  } else {\n    return price.substring(1)\n  }\n};\n\nconst ebayPriceParsed = (listing) => {\n  if (listing.price.currency === \"USD\") {\n    return listing.price.convertedFromValue ? listing.price.convertedFromValue : listing.price.value;\n  } else {\n    return listing.price.value;\n  }\n};\n\nconst facebookPriceParsed = (price) => {\n  let rawPrice = price.substring(1);\n  if (!price || price === \"FREE\") {\n    return \"0\"\n  } else if (price === \"See listings near me\") {\n    return \"~\"\n  } else if (!rawPrice.includes(\"¬£\")){\n    return rawPrice;\n  } else if (rawPrice.includes(\"¬£\")) {\n    return rawPrice.substring(0, rawPrice.indexOf(\"¬£\"));\n  }\n};\n\nconst missingImagesFiltered = (imageProp) => {\n  if (imageProp === null || imageProp === undefined) {\n    return imagePlaceholder;\n  } else {\n    return imageProp;\n  }\n}\n\nconst tnmissingImagesFiltered = (listing) => {\n  if (!listing.photos) {\n    return imagePlaceholder\n  } else {\n    return listing.photos[0].url;\n  }\n}\n\nconst eBayMissingImagesFiltered = (listing) => {\n  if (!listing.hasOwnProperty(\"image\") || !listing.image.hasOwnProperty(\"imageUrl\")) {\n    return imagePlaceholder;\n  } else {\n    return listing.thumbnailImages[0].imageUrl;\n  }\n}\n\n\n///<Data calls\n\nconst setEbayData = async () => {\n\n if (this.state.AccessToken === \"none\") {\n   console.log(\"this does not have an access token\")\n\n   var myHeaders = new Headers();\n    myHeaders.append(\"Authorization\", \"Basic Sm9zZXBoVW4tTG9tYS1QUkQtMTk5YWQwZDkwLWY0Y2QyYjg4OlBSRC05OWFkMGQ5MDRiYjEtZjYzMS00OGMyLTkwNTQtYTQ5Yg==\");\n    myHeaders.append(\"Content-Type\", \"application/x-www-form-urlencoded\");\n    myHeaders.append(\"Cookie\", \"ebay=%5Esbf%3D%23%5E; dp1=bu1p/QEBfX0BAX19AQA**6379634c^\");\n    \n    var urlencoded = new URLSearchParams();\n    urlencoded.append(\"grant_type\", \"client_credentials\");\n    urlencoded.append(\"scope\", \"https://api.ebay.com/oauth/api_scope\");\n    \n    var requestOptions = {\n      method: 'POST',\n      headers: myHeaders,\n      body: urlencoded,\n      redirect: 'follow'\n    };\n\n   const tokenResponse = await fetch(\"https://loma-cors.herokuapp.com/https://api.ebay.com/identity/v1/oauth2/token\", requestOptions);\n   const jsonToken = await tokenResponse.json();\n   const accessToken = jsonToken.access_token;\n\n   await this.setState({\n    AccessToken: accessToken,\n    ExpiryDate: Date.now() + accessToken.expires_in * 1000\n   })\n }\n  console.log(\"fetching ebay data\")\n  var ebayHeaders = new Headers();\n  ebayHeaders.append(\"Authorization\", `Bearer ${this.state.AccessToken}`);\n  ebayHeaders.append(\"Content-Type\", \"application/json\");\n  ebayHeaders.append(\"X-EBAY-C-MARKETPLACE-ID\", \"EBAY_US\");\n  ebayHeaders.append(\"X-EBAY-C-ENDUSERCTX\", \"affiliateCampaignId=<ePNCampaignId>,affiliateReferenceId=<referenceId>\");\n  \n  var ebayrequestOptions = {\n    method: 'GET',\n    headers: ebayHeaders,\n    redirect: 'follow'\n  };   \n\n  \n  const ebayresponse = await fetch(`https://loma-cors.herokuapp.com/https://api.ebay.com/buy/browse/v1/item_summary/search?q=${searchQuery}&limit=200&filter=price:[${this.state.filters.range.min}..${this.state.filters.range.max}],priceCurrency:GBP,conditions:{UNSPECIFIED|USED},itemLocationCountry:GB&fieldgroups=EXTENDED`, ebayrequestOptions);\n  const jsonresponse = await ebayresponse.json();\n  const ebayDataParsed = () => {\n    if (jsonresponse.itemSummaries) {\n        return jsonresponse.itemSummaries.map(\n          (listing) => {\n              return {\n                  title: isNull(listing.title),\n                  description: isNull(listing.shortDescription),\n                  price: isNull(ebayPriceParsed(listing)),\n                  image: eBayMissingImagesFiltered(listing),\n                  url: isNull(listing.itemWebUrl),\n                  site: \"ebay\"\n              }\n          }\n      )\n    } else { \n      return [];\n    }\n  }\n\n  this.setState(prevState => ({mainDisplay: \"Results\", Data: [...prevState.Data,...ebayDataParsed()]}));\n  this.reOrderDisplay(this.state.resultsDisplay)\n\n}\n\nconst setDepopData = async () => {\n  if (this.state.depopData.status === \"unresolved\") {\n    const depop_url = \"https://api.apify.com/v2/datasets/ml97NZifdmN1EFUSb/items?clean=true&format=json\";\n    const depopResponse = await fetch(depop_url);\n    const depopData = await depopResponse.json();\n    const depopDataFiltered = depopData.filter( (listing) => {\n      if (isNull(listing.title).toLowerCase().includes(this.state.searchTerm) && \n      listing.price >= this.state.filters.range.min &&\n      listing.price <= this.state.filters.range.max) {\n        return true;\n      } else if (isNull(listing.description).toLowerCase().includes(this.state.searchTerm) && \n      listing.price >= this.state.filters.range.min &&\n      listing.price <= this.state.filters.range.max) {\n        return true;\n      } else {\n        return false;\n      }\n    })\n    \n    const depopDataParsed = depopDataFiltered.map(\n      (listing) => {\n        return {\n          title: isNull(listing.title),\n          price: isPriceNull(listing.price),\n          description: isNull(listing.description),\n          image: isNull(missingImagesFiltered(listing.image)),\n          url: isNull(listing.url),\n          site: \"depop\"\n        }\n      }\n    )\n\n    this.setState({\n      depopData : {\n        data: depopDataParsed,\n        status: 'resolved'\n      }\n    });\n\n    this.setState(prevState => ({loading: false, Data: [...prevState.Data,...depopDataParsed]}));\n    this.reOrderDisplay(this.state.resultsDisplay)\n\n  } else if (this.state.depopData.status === \"resolved\") {\n    const depopDataFiltered = this.state.depopData.data.filter((listing) => {\n      if (isNull(listing.title).toLowerCase().includes(this.state.searchTerm) && \n          listing.price >= this.state.filters.range.min &&\n          listing.price <= this.state.filters.range.max) {\n        return true;\n      } else if (isNull(listing.description).toLowerCase().includes(this.state.searchTerm) && \n      listing.price >= this.state.filters.range.min &&\n      listing.price <= this.state.filters.range.max) {\n        return true;\n      } else {\n        return false;\n      }\n    });\n    this.setState(prevState => ({Data: [...prevState.Data,...depopDataFiltered]}));\n    this.reOrderDisplay(this.state.resultsDisplay)\n  }\n} \n\nconst setGumtreeData = async () => {\n\n      \n  if (this.state.gumtreeData.status === \"unresolved\") {\n    const gumtree_url = \"https://api.apify.com/v2/datasets/Dh5XzAb9fvidWw285/items?format=json&clean=1\"\n    const gumtreeResponse = await fetch(gumtree_url);\n    const gumtreeData = await gumtreeResponse.json();\n    const gumtreeDataFiltered = gumtreeData.filter( (listing) => {\n      if (isNull(listing.title).toLowerCase().includes(this.state.searchTerm) && \n      listing.price >= this.state.filters.range.min &&\n      listing.price <= this.state.filters.range.max) {\n        return true;\n      } else if (isNull(listing.description).toLowerCase().includes(this.state.searchTerm) && \n      listing.price >= this.state.filters.range.min &&\n      listing.price <= this.state.filters.range.max) {\n        return true;\n      } else {\n        return false;\n      }\n    })\n\n    const gumtreeDataParsed = gumtreeDataFiltered.map(\n      listing => {\n        return {\n          title: listing.title,\n          price: listing.price.substring(1),\n          description: listing.description,\n          image: missingImagesFiltered(listing.image),\n          url: listing.url,\n          site: \"gumtree\"\n        }\n      }\n    )\n\n    this.setState({\n      depopData : {\n        data: gumtreeDataParsed,\n        status: 'resolved'\n      }\n    });\n\n    this.setState(prevState => ({mainDisplay: \"Results\", Data: [...prevState.Data,...gumtreeDataFiltered]}));\n    this.reOrderDisplay(this.state.resultsDisplay)\n\n  } else {\n    const gumtreeDataFiltered = this.state.gumtreeData.data.filter( (listing) => {\n      if (isNull(listing.title).toLowerCase().includes(this.state.searchTerm) && \n      listing.price >= this.state.filters.range.min &&\n      listing.price <= this.state.filters.range.max) {\n        return true;\n      } else if (isNull(listing.description).toLowerCase().includes(this.state.searchTerm) && \n      listing.price >= this.state.filters.range.min &&\n      listing.price <= this.state.filters.range.max) {\n        return true;\n      } else {\n        return false;\n      }\n    })\n    this.setState(prevState => ({Data: [...prevState.Data,...gumtreeDataFiltered]}));\n    this.reOrderDisplay(this.state.resultsDisplay)\n    \n  }\n}\n\nconst setFacebookData = async () => {\n\n\n  if (this.state.facebookData.status === \"unresolved\") {\n    const facebook_url = \"https://api.apify.com/v2/datasets/IitkxYE95yydtzFlk/items?clean=true&format=json\"\n    const facebookResponse = await fetch(facebook_url);\n    const facebookData = await facebookResponse.json();\n    const facebookDataFiltered = facebookData.filter( (listing) => {\n      if (isNull(listing.title).toLowerCase().includes(this.state.searchTerm) && \n      listing.price >= this.state.filters.range.min &&\n      listing.price <= this.state.filters.range.max) {\n        return true;\n      } else if (isNull(listing.description).toLowerCase().includes(this.state.searchTerm) && \n      listing.price >= this.state.filters.range.min &&\n      listing.price <= this.state.filters.range.max) {\n        return true;\n      } else {\n        return false;\n      }\n    })\n\n    const facebookDataParsed = facebookDataFiltered.map(\n      listing => {\n        return {\n          title: \"\" + isNull(listing.title),\n          price: \"\" + facebookPriceParsed(listing.price),\n          description: \"\" + isNull(listing.description),\n          image: \"\" + missingImagesFiltered(listing.image),\n          url: \"\" + isNull(listing.url),\n          site: \"facebook\"\n        }\n      }\n    )\n\n    this.setState({\n      facebookData : {\n        data: facebookDataParsed,\n        status: 'resolved'\n      }\n    });\n    \n    this.setState(prevState => ({mainDisplay: \"Results\", Data: [...prevState.Data,...facebookDataFiltered]}));\n    this.reOrderDisplay(this.state.resultsDisplay)\n  } else {\n    const facebookDataFiltered = this.state.facebookData.data.filter( (listing) => {\n      if (isNull(listing.title).toLowerCase().includes(this.state.searchTerm) && \n      listing.price >= this.state.filters.range.min &&\n      listing.price <= this.state.filters.range.max) {\n        return true;\n      } else if (isNull(listing.description).toLowerCase().includes(this.state.searchTerm) && \n      listing.price >= this.state.filters.range.min &&\n      listing.price <= this.state.filters.range.max) {\n        return true;\n      } else {\n        return false;\n      }\n    })\n    this.setState(prevState => ({Data: [...prevState.Data,...facebookDataFiltered]}));\n    this.reOrderDisplay(this.state.resultsDisplay)\n  }\n}\n\nconst setEtsyData = async () => {\n\n  const etsyRaw = await fetch(`https://loma-cors.herokuapp.com/https://openapi.etsy.com/v2/listings/active?keywords=${searchQuery}&tags=vintage&limit=200&location=UK&api_key=sh1n3isgj6bax7eotlor7m4s&includes=Images&min_price=${this.state.filters.range.min}&max_price=${this.state.filters.range.max}&sort_on=score&sort_order=down`);\n  const etsyJson = await etsyRaw.json();\n  const etsyDataResults = etsyJson.results;\n  const etsyData = etsyDataResults.map( listing => {\n\n    let etsyFirstImage = listing.Images ? missingImagesFiltered(listing.Images[0].url_570xN) : imagePlaceholder\n    return {\n      title: listing.title,\n      price: listing.price,\n      description: listing.description,\n      image: etsyFirstImage,\n      url: listing.url,\n      site: \"etsy\"\n    }\n  });\n\n  this.setState(prevState => ({mainDisplay: \"Results\", Data: [...prevState.Data,...etsyData]}));\n  this.reOrderDisplay(this.state.resultsDisplay)\n}\n\nconst setTrashNothingData = async () => {\n\n  const trashnothingRaw = await fetch(`https://trashnothing.com/api/v1.2/posts/search?search=${searchQuery}&sort_by=relevance&types=offer&sources=trashnothing&per_page=50&page=4&device_pixel_ratio=1&latitude=51.507351&longitude=-0.127758&radius=200000&api_key=yr8sVaHEvbdkdunSFfPoDpqlwEjxIuqB3XhyFzx1`);\n  const tnJson = await trashnothingRaw.json();\n  const tnResults = tnJson.posts;\n  const trashNothingData = tnResults.map( listing => {\n    return {\n      title: listing.title,\n      price: 0,\n      description: listing.content,\n      image: tnmissingImagesFiltered(listing),\n      url: listing.url,\n      site: \"trashnothing\"\n    }\n  });\n\n  this.setState(prevState => ({mainDisplay: \"Results\", Data: [...prevState.Data,...trashNothingData]}));\n  this.reOrderDisplay(this.state.resultsDisplay)\n}\n\n///>Data calls\n////>Functions and constants\n\n  ///<Preliminary checks\n  if (!searchQuery) {\n    alert(\"Tell me what to search! üòÅ\");\n    return;\n  }\n\n  console.time(\"complete search\")\n  this.setState({Data: [], searchTerm: searchQuery.toLowerCase(), mainDisplay: \"Loading\"});\n  ///>Preliminary checks\n\n  ///<The Timeline\n  if (this.state.filters.sites.ebay) {\n    setEbayData(); \n  }\n\n  if (this.state.filters.sites.depop) {\n    setDepopData();\n  }\n\n  if (this.state.filters.sites.gumtree) {\n    setGumtreeData();\n  }\n\n  if (this.state.filters.sites.facebook) {\n    setFacebookData();\n  }\n\n  if (this.state.filters.sites.etsy) {\n    setEtsyData();\n  }\n\n  if (this.state.filters.sites.trashnothing) {\n    setTrashNothingData();\n  }\n  }\n\n  render() {\n    return (\n      <div className=\"w-screen h-screen flex flex-row justify-center content-center mx-auto border\">\n        {/* Top layer for popups */}\n        {this.state.popUpListing.display ? <PopUpListing changeActiveListing={this.changeActiveListing} display={this.state.popUpListing.display} listing={this.state.popUpListing.listing} togglePopUp={this.togglePopUp}/> : null}\n        {this.state.popUpSearchSettings.display ? \n                <PopUpSearchSettings \n                  toggleSearchSettings={this.toggleSearchSettings} \n                  filters={this.state.filters}\n                  maxResultPrice={this.state.popUpSearchSettings.maxResultPrice}\n                  searchTerm={this.state.searchTerm}\n                  display={this.state.resultsDisplay}\n                  gridView={this.state.gridView}\n                  setSiteFilters={this.setSiteFilters}\n                  /> : null}\n        {this.state.popUpGeneral === \"PopUpLogSign\" ? <PopUpLogSign/>: null}\n        {/* Top layer for popups ends */}\n        <div className=\"w-full flex flex-row\">\n          <div className=\"se:hidden sm:block\"><Sidebar toggleMainDisplay={this.toggleMainDisplay} /></div>\n          <div className=\"w-full h-full bg-white overflow-x-hidden z-0\">\n              {this.state.mainDisplay !== \"UserLikes\" && this.state.mainDisplay !== \"Repairs\" && this.state.mainDisplay !== \"UserAccount\" && this.state.mainDisplay !== \"Community\"? <SearchBar onChange={this.handleChange} toggleMainDisplay={this.toggleMainDisplay} resultsDisplay={this.state.resultsDisplay} searchTerm={this.state.searchTerm}/> : null}\n              {this.state.mainDisplay === \"Landing\" ? <Landing /> : null}\n              {this.state.mainDisplay === \"Repairs\" ? <Repairs toggleMainDisplay={this.toggleMainDisplay} /> : null}\n              {this.state.mainDisplay === \"Community\" ? <Community toggleMainDisplay={this.toggleMainDisplay} /> : null}\n              {this.state.mainDisplay === \"UserLikes\" ? <UserLikes toggleMainDisplay={this.toggleMainDisplay} /> : null}\n              {this.state.mainDisplay === \"UserAccount\" ? <UserAccount toggleMainDisplay={this.toggleMainDisplay} /> : null}\n              {this.state.mainDisplay === \"Loading\" ? <LoadingPop /> : null}\n              {this.state.mainDisplay === \"Results\" ? <Results Data={this.state.Data}\n                      resultsDisplay={this.state.resultsDisplay}\n                      reOrderDisplay={this.reOrderDisplay} \n                      searchTerm={this.state.searchTerm}\n                      search={this.handleChange}\n                      togglePopUp={this.togglePopUp}\n                      toggleSearchSettings={this.toggleSearchSettings}\n                      gridView={this.state.gridView} /> : null}\n          </div>\n        </div>\n      </div> \n    );\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}