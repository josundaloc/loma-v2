{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/joseph/Code/lomav2/src/App.js\";\nimport React from 'react';\nimport \"tailwindcss/tailwind.css\";\nimport { SearchBar } from './Components/SearchBar';\nimport { Results } from './Components/Results';\nimport { Landing } from './Components/Landing';\nimport { LoadingPop } from './Components/LoadingPop';\nimport { PopUpListing } from './Components/PopUpListing';\nimport { PopUpSearchSettings } from './Components/PopUpSearchSettings';\nimport { PopUpLogSign } from './Components/PopUpLogSign';\nimport { Sidebar } from './Components/Sidebar';\nimport { UserLikes } from './Components/UserLikes';\nimport imagePlaceholder from './assets/gallery.png';\nimport { hotjar } from 'react-hotjar';\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      Data: [],\n      AccessToken: \"none\",\n      ExpiryDate: 0,\n      resultsDisplay: \"⚡️ Trending ⚡️\",\n      mainDisplay: \"UserLikes\",\n      // \"Results\"  //  \"Loading\" // \"UserLikes\" // \"Landing\"\n      gridView: \"Images Only\",\n      // \"Image + Description\"\n      filters: {\n        sites: {\n          ebay: true,\n          trashnothing: true,\n          etsy: true,\n          facebook: true,\n          gumtree: true,\n          depop: true\n        },\n        range: {\n          min: 0,\n          max: 100000000\n        }\n      },\n      searchTerm: \"\",\n      landing: true,\n      popUpListing: {\n        display: false,\n        listing: {}\n      },\n      popUpGeneral: null,\n      //\"PopUpLogSign\",\n      popUpSearchSettings: {\n        display: false,\n        maxResultPrice: 1000\n      },\n      depopData: {\n        data: [{\n          nothing: \"none\"\n        }],\n        status: 'unresolved'\n      },\n      gumtreeData: {\n        data: [{\n          nothing: \"none\"\n        }],\n        status: 'unresolved'\n      },\n      facebookData: {\n        data: [{\n          nothing: \"none\"\n        }],\n        status: 'unresolved'\n      }\n    };\n    this.handleChange = this.handleChange.bind(this);\n    this.setData = this.setData.bind(this);\n    this.reOrderDisplay = this.reOrderDisplay.bind(this);\n    this.togglePopUp = this.togglePopUp.bind(this);\n    this.toggleLanding = this.toggleLanding.bind(this);\n    this.changeActiveListing = this.changeActiveListing.bind(this);\n    this.toggleSearchSettings = this.toggleSearchSettings.bind(this);\n    this.setSiteFilters = this.setSiteFilters.bind(this);\n    this.toggleMainDisplay = this.toggleMainDisplay.bind(this);\n  }\n\n  componentDidMount() {\n    /////////FUNCTIONS AND CONSTANTS\n    const appLoaded = Date.now();\n\n    const getEbayAccessToken = () => {\n      if (Date.now() > this.state.ExpiryDate) {\n        console.log(\"this app does not have an access token, getting access token\");\n        var myHeaders = new Headers();\n        myHeaders.append(\"Authorization\", \"Basic Sm9zZXBoVW4tTG9tYS1QUkQtMTk5YWQwZDkwLWY0Y2QyYjg4OlBSRC05OWFkMGQ5MDRiYjEtZjYzMS00OGMyLTkwNTQtYTQ5Yg==\");\n        myHeaders.append(\"Content-Type\", \"application/x-www-form-urlencoded\");\n        myHeaders.append(\"Cookie\", \"ebay=%5Esbf%3D%23%5E; dp1=bu1p/QEBfX0BAX19AQA**6379634c^\");\n        var urlencoded = new URLSearchParams();\n        urlencoded.append(\"grant_type\", \"client_credentials\");\n        urlencoded.append(\"scope\", \"https://api.ebay.com/oauth/api_scope\");\n        var requestOptions = {\n          method: 'POST',\n          headers: myHeaders,\n          body: urlencoded,\n          redirect: 'follow'\n        };\n        fetch(\"https://loma-cors.herokuapp.com/https://api.ebay.com/identity/v1/oauth2/token\", requestOptions).then(response => response.json()).then(jsonresponse => {\n          this.setState({\n            AccessToken: jsonresponse.access_token,\n            ExpiryDate: Date.now() + jsonresponse.expires_in * 1000\n          });\n          let accessTokenSet = Date.now() - appLoaded;\n          console.log(`apiAccessToken = ${this.state.AccessToken}, took ${accessTokenSet} milliseconds`);\n        }).catch(error => console.log('error', error));\n      }\n    }; ///////<DATA CLEANERS>\n\n\n    const isNull = property => {\n      if (property === null || property === undefined) {\n        return \" \";\n      } else {\n        return property;\n      }\n    };\n\n    const facebookPriceParsed = price => {\n      let rawPrice = price.substring(1);\n\n      if (!price || price === \"FREE\") {\n        return \"0\";\n      } else if (price === \"See listings near me\") {\n        return \"~\";\n      } else if (!rawPrice.includes(\"£\")) {\n        return rawPrice;\n      } else if (rawPrice.includes(\"£\")) {\n        return rawPrice.substring(0, rawPrice.indexOf(\"£\"));\n      }\n    };\n\n    const isPriceNull = price => {\n      if (price === undefined || price === null) {\n        return \"~\";\n      } else {\n        return price.substring(1);\n      }\n    };\n\n    const missingImagesFiltered = imageProp => {\n      if (imageProp === null || imageProp === undefined) {\n        return imagePlaceholder;\n      } else {\n        return imageProp;\n      }\n    }; ///////</DATA CLEANERS END>\n\n\n    const getDepopData = async () => {\n      console.log(\"getting depop data\");\n      const depop_url = \"https://api.apify.com/v2/datasets/ml97NZifdmN1EFUSb/items?clean=true&format=json\";\n      const depopResponse = await fetch(depop_url);\n      const depopData = await depopResponse.json();\n      const depopDataParsed = await depopData.map(listing => {\n        return {\n          title: isNull(listing.title),\n          price: isPriceNull(listing.price),\n          description: isNull(listing.description),\n          image: isNull(missingImagesFiltered(listing.image)),\n          url: isNull(listing.url),\n          site: \"depop\"\n        };\n      });\n      this.setState({\n        depopData: {\n          data: depopDataParsed,\n          status: 'resolved'\n        }\n      });\n      let depopDataSetTime = Date.now() - appLoaded;\n      console.log(\"depop data has been set, it took this many milliseconds: \" + depopDataSetTime);\n    }; ///\n\n\n    const getGumtreeData = async () => {\n      console.log(\"getting gumtree data\");\n      const gumtree_url = \"https://api.apify.com/v2/datasets/Dh5XzAb9fvidWw285/items?format=json&clean=1\";\n      const gumtreeResponse = await fetch(gumtree_url);\n      const gumtreeData = await gumtreeResponse.json();\n      const gumtreeDataParsed = await gumtreeData.map(listing => {\n        return {\n          title: listing.title,\n          price: listing.price.substring(1),\n          description: listing.description,\n          image: missingImagesFiltered(listing.image),\n          url: listing.url,\n          site: \"gumtree\"\n        };\n      });\n      this.setState({\n        gumtreeData: {\n          data: gumtreeDataParsed,\n          status: 'resolved'\n        }\n      });\n      let gumtreeDataSetTime = Date.now() - appLoaded;\n      console.log(\"gumtree data has been set, it took this many milliseconds: \" + gumtreeDataSetTime);\n    }; ///\n\n\n    const getFacebookData = async () => {\n      console.log(\"getting facebook data\");\n      const facebook_url = \"https://api.apify.com/v2/datasets/IitkxYE95yydtzFlk/items?clean=true&format=json\";\n      const facebookResponse = await fetch(facebook_url);\n      const facebookData = await facebookResponse.json();\n      const facebookDataParsed = facebookData.map(listing => {\n        return {\n          title: \"\" + isNull(listing.title),\n          price: \"\" + facebookPriceParsed(listing.price),\n          description: \"\" + isNull(listing.description),\n          image: \"\" + missingImagesFiltered(listing.image),\n          url: \"\" + isNull(listing.url),\n          site: \"facebook\"\n        };\n      });\n      this.setState({\n        facebookData: {\n          data: facebookDataParsed,\n          status: 'resolved'\n        }\n      });\n      let facebookDataSetTime = Date.now() - appLoaded;\n      console.log(\"facebook data has been set, it took this many milliseconds: \" + facebookDataSetTime);\n    }; ///////\n    // getEbayAccessToken();\n    // getDepopData();\n    // getGumtreeData();\n    // getFacebookData();\n    // hotjar.initialize(2123002,6);\n    // console.log(\"access token\" +  this.state.AccessToken);\n\n  } //COMPONENT MOUNT ENDS\n\n\n  toggleMainDisplay() {}\n\n  async setSiteFilters(newSearchTerm, eBayFilter, trashNothingFilter, etsyFilter, facebookFilter, gumtreeFilter, depopFilter, minRange, maxRange, sortOrder, gridView) {\n    await this.setState(prevState => ({\n      resultsDisplay: sortOrder,\n      gridView: gridView,\n      filters: {\n        sites: {\n          ebay: eBayFilter,\n          trashnothing: trashNothingFilter,\n          etsy: etsyFilter,\n          facebook: facebookFilter,\n          gumtree: gumtreeFilter,\n          depop: depopFilter\n        },\n        range: {\n          min: minRange,\n          max: maxRange\n        }\n      },\n      searchTerm: newSearchTerm,\n      popUpSearchSettings: {\n        display: !prevState.popUpSearchSettings.display,\n        maxResultPrice: prevState.popUpSearchSettings.maxResultPrice\n      }\n    }));\n    console.log(this.state.filters);\n    this.setData(newSearchTerm);\n  }\n\n  async toggleSearchSettings() {\n    console.log(\"search settings toggled\");\n\n    if (this.state.popUpSearchSettings.display === true) {\n      await this.setState({\n        popUpSearchSettings: {\n          display: false\n        }\n      });\n    } else if (this.state.popUpSearchSettings.display === false) {\n      let highestPrice = await this.state.Data.reduce(function (current, item) {\n        if (item.price !== \"~\") {\n          return current > Number(item.price) ? current : Number(item.price);\n        } else {\n          return item.price;\n        }\n      }, 0);\n      console.log(highestPrice);\n      this.setState({\n        popUpSearchSettings: {\n          display: true,\n          maxResultPrice: highestPrice\n        }\n      });\n    }\n  }\n\n  handleChange(searchQuery) {\n    this.setState({\n      searchTerm: searchQuery\n    });\n    this.setData(searchQuery);\n  }\n\n  togglePopUp(listing) {\n    if (this.state.popUpListing.display === true) {\n      this.setState({\n        popUpListing: {\n          display: false,\n          listing: {}\n        }\n      });\n    } else {\n      this.setState({\n        popUpListing: {\n          display: true,\n          listing: listing\n        }\n      });\n    }\n  }\n\n  changeActiveListing(listing, direction) {\n    let currentActiveListingIndex = this.state.Data.indexOf(listing);\n\n    if (direction === \"next\") {\n      this.setState(prevState => ({\n        popUpListing: {\n          display: true,\n          listing: prevState.Data[currentActiveListingIndex + 1]\n        }\n      }));\n    } else if (direction === \"previous\" && currentActiveListingIndex > 0) {\n      this.setState(prevState => ({\n        popUpListing: {\n          display: true,\n          listing: prevState.Data[currentActiveListingIndex - 1]\n        }\n      }));\n    } else {\n      return;\n    }\n  }\n\n  toggleLanding() {\n    this.setState({\n      landing: true\n    });\n  }\n\n  async reOrderDisplay(sortOrder) {\n    /// functions\n    await this.setState({\n      resultsDisplay: sortOrder\n    });\n\n    function shuffleArray(array) {\n      for (var i = array.length - 1; i > 0; i--) {\n        var j = Math.floor(Math.random() * (i + 1));\n        var temp = array[i];\n        array[i] = array[j];\n        array[j] = temp;\n      }\n\n      return array;\n    }\n\n    function highest(a, b) {\n      if (Number(a.price) < Number(b.price)) {\n        return 1;\n      }\n\n      if (Number(a.price) > Number(b.price)) {\n        return -1;\n      }\n\n      return 0;\n    }\n\n    function lowest(a, b) {\n      if (Number(a.price) < Number(b.price)) {\n        return -1;\n      }\n\n      if (Number(a.price) > Number(b.price)) {\n        return 1;\n      }\n\n      return 0;\n    }\n\n    if (this.state.Data) {\n      if (this.state.resultsDisplay === \"⚡️ Trending ⚡️\") {\n        this.setState({\n          Data: shuffleArray(this.state.Data)\n        });\n      } else if (this.state.resultsDisplay === \"Highest price first ▲\") {\n        this.setState({\n          Data: this.state.Data.sort(highest)\n        });\n      } else if (this.state.resultsDisplay === \"Lowest price first ▼\") {\n        this.setState({\n          Data: this.state.Data.sort(lowest)\n        });\n      }\n    }\n  }\n\n  setData(searchQuery) {\n    ///<Functions and constants\n    function shuffleArray(array) {\n      for (var i = array.length - 1; i > 0; i--) {\n        var j = Math.floor(Math.random() * (i + 1));\n        var temp = array[i];\n        array[i] = array[j];\n        array[j] = temp;\n      }\n\n      return array;\n    }\n\n    const isNull = property => {\n      if (property === null || property === undefined) {\n        return \" \";\n      } else {\n        return property;\n      }\n    };\n\n    const isPriceNull = price => {\n      if (price === undefined || price === null) {\n        return \"~\";\n      } else {\n        return price.substring(1);\n      }\n    };\n\n    const ebayPriceParsed = listing => {\n      if (listing.price.currency === \"USD\") {\n        return listing.price.convertedFromValue ? listing.price.convertedFromValue : listing.price.value;\n      } else {\n        return listing.price.value;\n      }\n    };\n\n    const facebookPriceParsed = price => {\n      let rawPrice = price.substring(1);\n\n      if (!price || price === \"FREE\") {\n        return \"0\";\n      } else if (price === \"See listings near me\") {\n        return \"~\";\n      } else if (!rawPrice.includes(\"£\")) {\n        return rawPrice;\n      } else if (rawPrice.includes(\"£\")) {\n        return rawPrice.substring(0, rawPrice.indexOf(\"£\"));\n      }\n    };\n\n    const missingImagesFiltered = imageProp => {\n      if (imageProp === null || imageProp === undefined) {\n        return imagePlaceholder;\n      } else {\n        return imageProp;\n      }\n    };\n\n    const tnmissingImagesFiltered = listing => {\n      if (!listing.photos) {\n        return imagePlaceholder;\n      } else {\n        return listing.photos[0].url;\n      }\n    };\n\n    const eBayMissingImagesFiltered = listing => {\n      if (!listing.hasOwnProperty(\"image\") || !listing.image.hasOwnProperty(\"imageUrl\")) {\n        return imagePlaceholder;\n      } else {\n        return listing.thumbnailImages[0].imageUrl;\n      }\n    }; ///<Data calls\n\n\n    const setEbayData = async () => {\n      if (this.state.AccessToken === \"none\") {\n        console.log(\"this does not have an access token\");\n        var myHeaders = new Headers();\n        myHeaders.append(\"Authorization\", \"Basic Sm9zZXBoVW4tTG9tYS1QUkQtMTk5YWQwZDkwLWY0Y2QyYjg4OlBSRC05OWFkMGQ5MDRiYjEtZjYzMS00OGMyLTkwNTQtYTQ5Yg==\");\n        myHeaders.append(\"Content-Type\", \"application/x-www-form-urlencoded\");\n        myHeaders.append(\"Cookie\", \"ebay=%5Esbf%3D%23%5E; dp1=bu1p/QEBfX0BAX19AQA**6379634c^\");\n        var urlencoded = new URLSearchParams();\n        urlencoded.append(\"grant_type\", \"client_credentials\");\n        urlencoded.append(\"scope\", \"https://api.ebay.com/oauth/api_scope\");\n        var requestOptions = {\n          method: 'POST',\n          headers: myHeaders,\n          body: urlencoded,\n          redirect: 'follow'\n        };\n        const tokenResponse = await fetch(\"https://loma-cors.herokuapp.com/https://api.ebay.com/identity/v1/oauth2/token\", requestOptions);\n        const jsonToken = await tokenResponse.json();\n        const accessToken = jsonToken.access_token;\n        await this.setState({\n          AccessToken: accessToken,\n          ExpiryDate: Date.now() + accessToken.expires_in * 1000\n        });\n      }\n\n      console.log(\"fetching ebay data\");\n      var ebayHeaders = new Headers();\n      ebayHeaders.append(\"Authorization\", `Bearer ${this.state.AccessToken}`);\n      ebayHeaders.append(\"Content-Type\", \"application/json\");\n      ebayHeaders.append(\"X-EBAY-C-MARKETPLACE-ID\", \"EBAY_US\");\n      ebayHeaders.append(\"X-EBAY-C-ENDUSERCTX\", \"affiliateCampaignId=<ePNCampaignId>,affiliateReferenceId=<referenceId>\");\n      var ebayrequestOptions = {\n        method: 'GET',\n        headers: ebayHeaders,\n        redirect: 'follow'\n      };\n      const ebayresponse = await fetch(`https://loma-cors.herokuapp.com/https://api.ebay.com/buy/browse/v1/item_summary/search?q=${searchQuery}&limit=200&filter=price:[${this.state.filters.range.min}..${this.state.filters.range.max}],priceCurrency:GBP,conditions:{UNSPECIFIED|USED},itemLocationCountry:GB&fieldgroups=EXTENDED`, ebayrequestOptions);\n      const jsonresponse = await ebayresponse.json();\n\n      const ebayDataParsed = () => {\n        if (jsonresponse.itemSummaries) {\n          return jsonresponse.itemSummaries.map(listing => {\n            return {\n              title: isNull(listing.title),\n              description: isNull(listing.shortDescription),\n              price: isNull(ebayPriceParsed(listing)),\n              image: eBayMissingImagesFiltered(listing),\n              url: isNull(listing.itemWebUrl),\n              site: \"ebay\"\n            };\n          });\n        } else {\n          return [];\n        }\n      };\n\n      this.setState(prevState => ({\n        mainDisplay: \"Results\",\n        Data: [...prevState.Data, ...ebayDataParsed()]\n      }));\n      this.reOrderDisplay(this.state.resultsDisplay);\n    };\n\n    const setDepopData = async () => {\n      if (this.state.depopData.status === \"unresolved\") {\n        const depop_url = \"https://api.apify.com/v2/datasets/ml97NZifdmN1EFUSb/items?clean=true&format=json\";\n        const depopResponse = await fetch(depop_url);\n        const depopData = await depopResponse.json();\n        const depopDataFiltered = depopData.filter(listing => {\n          if (isNull(listing.title).toLowerCase().includes(this.state.searchTerm) && listing.price >= this.state.filters.range.min && listing.price <= this.state.filters.range.max) {\n            return true;\n          } else if (isNull(listing.description).toLowerCase().includes(this.state.searchTerm) && listing.price >= this.state.filters.range.min && listing.price <= this.state.filters.range.max) {\n            return true;\n          } else {\n            return false;\n          }\n        });\n        const depopDataParsed = depopDataFiltered.map(listing => {\n          return {\n            title: isNull(listing.title),\n            price: isPriceNull(listing.price),\n            description: isNull(listing.description),\n            image: isNull(missingImagesFiltered(listing.image)),\n            url: isNull(listing.url),\n            site: \"depop\"\n          };\n        });\n        this.setState({\n          depopData: {\n            data: depopDataParsed,\n            status: 'resolved'\n          }\n        });\n        this.setState(prevState => ({\n          loading: false,\n          Data: [...prevState.Data, ...depopDataParsed]\n        }));\n        this.reOrderDisplay(this.state.resultsDisplay);\n      } else if (this.state.depopData.status === \"resolved\") {\n        const depopDataFiltered = this.state.depopData.data.filter(listing => {\n          if (isNull(listing.title).toLowerCase().includes(this.state.searchTerm) && listing.price >= this.state.filters.range.min && listing.price <= this.state.filters.range.max) {\n            return true;\n          } else if (isNull(listing.description).toLowerCase().includes(this.state.searchTerm) && listing.price >= this.state.filters.range.min && listing.price <= this.state.filters.range.max) {\n            return true;\n          } else {\n            return false;\n          }\n        });\n        this.setState(prevState => ({\n          Data: [...prevState.Data, ...depopDataFiltered]\n        }));\n        this.reOrderDisplay(this.state.resultsDisplay);\n      }\n    };\n\n    const setGumtreeData = async () => {\n      if (this.state.gumtreeData.status === \"unresolved\") {\n        const gumtree_url = \"https://api.apify.com/v2/datasets/Dh5XzAb9fvidWw285/items?format=json&clean=1\";\n        const gumtreeResponse = await fetch(gumtree_url);\n        const gumtreeData = await gumtreeResponse.json();\n        const gumtreeDataFiltered = gumtreeData.filter(listing => {\n          if (isNull(listing.title).toLowerCase().includes(this.state.searchTerm) && listing.price >= this.state.filters.range.min && listing.price <= this.state.filters.range.max) {\n            return true;\n          } else if (isNull(listing.description).toLowerCase().includes(this.state.searchTerm) && listing.price >= this.state.filters.range.min && listing.price <= this.state.filters.range.max) {\n            return true;\n          } else {\n            return false;\n          }\n        });\n        const gumtreeDataParsed = gumtreeDataFiltered.map(listing => {\n          return {\n            title: listing.title,\n            price: listing.price.substring(1),\n            description: listing.description,\n            image: missingImagesFiltered(listing.image),\n            url: listing.url,\n            site: \"gumtree\"\n          };\n        });\n        this.setState({\n          depopData: {\n            data: gumtreeDataParsed,\n            status: 'resolved'\n          }\n        });\n        this.setState(prevState => ({\n          mainDisplay: \"Results\",\n          Data: [...prevState.Data, ...gumtreeDataFiltered]\n        }));\n        this.reOrderDisplay(this.state.resultsDisplay);\n      } else {\n        const gumtreeDataFiltered = this.state.gumtreeData.data.filter(listing => {\n          if (isNull(listing.title).toLowerCase().includes(this.state.searchTerm) && listing.price >= this.state.filters.range.min && listing.price <= this.state.filters.range.max) {\n            return true;\n          } else if (isNull(listing.description).toLowerCase().includes(this.state.searchTerm) && listing.price >= this.state.filters.range.min && listing.price <= this.state.filters.range.max) {\n            return true;\n          } else {\n            return false;\n          }\n        });\n        this.setState(prevState => ({\n          Data: [...prevState.Data, ...gumtreeDataFiltered]\n        }));\n        this.reOrderDisplay(this.state.resultsDisplay);\n      }\n    };\n\n    const setFacebookData = async () => {\n      if (this.state.facebookData.status === \"unresolved\") {\n        const facebook_url = \"https://api.apify.com/v2/datasets/IitkxYE95yydtzFlk/items?clean=true&format=json\";\n        const facebookResponse = await fetch(facebook_url);\n        const facebookData = await facebookResponse.json();\n        const facebookDataFiltered = facebookData.filter(listing => {\n          if (isNull(listing.title).toLowerCase().includes(this.state.searchTerm) && listing.price >= this.state.filters.range.min && listing.price <= this.state.filters.range.max) {\n            return true;\n          } else if (isNull(listing.description).toLowerCase().includes(this.state.searchTerm) && listing.price >= this.state.filters.range.min && listing.price <= this.state.filters.range.max) {\n            return true;\n          } else {\n            return false;\n          }\n        });\n        const facebookDataParsed = facebookDataFiltered.map(listing => {\n          return {\n            title: \"\" + isNull(listing.title),\n            price: \"\" + facebookPriceParsed(listing.price),\n            description: \"\" + isNull(listing.description),\n            image: \"\" + missingImagesFiltered(listing.image),\n            url: \"\" + isNull(listing.url),\n            site: \"facebook\"\n          };\n        });\n        this.setState({\n          facebookData: {\n            data: facebookDataParsed,\n            status: 'resolved'\n          }\n        });\n        this.setState(prevState => ({\n          mainDisplay: \"Results\",\n          Data: [...prevState.Data, ...facebookDataFiltered]\n        }));\n        this.reOrderDisplay(this.state.resultsDisplay);\n      } else {\n        const facebookDataFiltered = this.state.facebookData.data.filter(listing => {\n          if (isNull(listing.title).toLowerCase().includes(this.state.searchTerm) && listing.price >= this.state.filters.range.min && listing.price <= this.state.filters.range.max) {\n            return true;\n          } else if (isNull(listing.description).toLowerCase().includes(this.state.searchTerm) && listing.price >= this.state.filters.range.min && listing.price <= this.state.filters.range.max) {\n            return true;\n          } else {\n            return false;\n          }\n        });\n        this.setState(prevState => ({\n          Data: [...prevState.Data, ...facebookDataFiltered]\n        }));\n        this.reOrderDisplay(this.state.resultsDisplay);\n      }\n    };\n\n    const setEtsyData = async () => {\n      const etsyRaw = await fetch(`https://loma-cors.herokuapp.com/https://openapi.etsy.com/v2/listings/active?keywords=${searchQuery}&tags=vintage&limit=200&location=UK&api_key=sh1n3isgj6bax7eotlor7m4s&includes=Images&min_price=${this.state.filters.range.min}&max_price=${this.state.filters.range.max}&sort_on=score&sort_order=down`);\n      const etsyJson = await etsyRaw.json();\n      const etsyDataResults = etsyJson.results;\n      const etsyData = etsyDataResults.map(listing => {\n        let etsyFirstImage = listing.Images ? missingImagesFiltered(listing.Images[0].url_570xN) : imagePlaceholder;\n        return {\n          title: listing.title,\n          price: listing.price,\n          description: listing.description,\n          image: etsyFirstImage,\n          url: listing.url,\n          site: \"etsy\"\n        };\n      });\n      this.setState(prevState => ({\n        mainDisplay: \"Results\",\n        Data: [...prevState.Data, ...etsyData]\n      }));\n      this.reOrderDisplay(this.state.resultsDisplay);\n    };\n\n    const setTrashNothingData = async () => {\n      const trashnothingRaw = await fetch(`https://trashnothing.com/api/v1.2/posts/search?search=${searchQuery}&sort_by=relevance&types=offer&sources=trashnothing&per_page=50&page=4&device_pixel_ratio=1&latitude=51.507351&longitude=-0.127758&radius=200000&api_key=yr8sVaHEvbdkdunSFfPoDpqlwEjxIuqB3XhyFzx1`);\n      const tnJson = await trashnothingRaw.json();\n      const tnResults = tnJson.posts;\n      const trashNothingData = tnResults.map(listing => {\n        return {\n          title: listing.title,\n          price: 0,\n          description: listing.content,\n          image: tnmissingImagesFiltered(listing),\n          url: listing.url,\n          site: \"trashnothing\"\n        };\n      });\n      this.setState(prevState => ({\n        mainDisplay: \"Results\",\n        Data: [...prevState.Data, ...trashNothingData]\n      }));\n      this.reOrderDisplay(this.state.resultsDisplay);\n    }; ///>Data calls\n    ////>Functions and constants\n    ///<Preliminary checks\n\n\n    if (!searchQuery) {\n      alert(\"Tell me what to search! 😁\");\n      return;\n    }\n\n    console.time(\"complete search\");\n    this.setState({\n      Data: [],\n      searchTerm: searchQuery.toLowerCase(),\n      mainDisplay: \"Loading\"\n    }); ///>Preliminary checks\n    ///<The Timeline\n\n    if (this.state.filters.sites.ebay) {\n      setEbayData();\n    }\n\n    if (this.state.filters.sites.depop) {\n      setDepopData();\n    }\n\n    if (this.state.filters.sites.gumtree) {\n      setGumtreeData();\n    }\n\n    if (this.state.filters.sites.facebook) {\n      setFacebookData();\n    }\n\n    if (this.state.filters.sites.etsy) {\n      setEtsyData();\n    }\n\n    if (this.state.filters.sites.trashnothing) {\n      setTrashNothingData();\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"max-w-screen-lg h-screen flex flex-row mx-auto border\",\n      children: [this.state.popUpListing.display ? /*#__PURE__*/_jsxDEV(PopUpListing, {\n        changeActiveListing: this.changeActiveListing,\n        display: this.state.popUpListing.display,\n        listing: this.state.popUpListing.listing,\n        togglePopUp: this.togglePopUp\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 867,\n        columnNumber: 44\n      }, this) : null, this.state.popUpSearchSettings.display ? /*#__PURE__*/_jsxDEV(PopUpSearchSettings, {\n        toggleSearchSettings: this.toggleSearchSettings,\n        filters: this.state.filters,\n        maxResultPrice: this.state.popUpSearchSettings.maxResultPrice,\n        searchTerm: this.state.searchTerm,\n        display: this.state.resultsDisplay,\n        gridView: this.state.gridView,\n        setSiteFilters: this.setSiteFilters\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 869,\n        columnNumber: 17\n      }, this) : null, this.state.popUpGeneral === \"PopUpLogSign\" ? /*#__PURE__*/_jsxDEV(PopUpLogSign, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 878,\n        columnNumber: 55\n      }, this) : null, /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-full flex flex-row\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"se:hidden sm:block\",\n          children: /*#__PURE__*/_jsxDEV(Sidebar, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 881,\n            columnNumber: 47\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 881,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-full h-full bg-white overflow-x-hidden z-0\",\n          children: [this.state.mainDisplay !== \"UserLikes\" ? /*#__PURE__*/_jsxDEV(SearchBar, {\n            onChange: this.handleChange,\n            resultsDisplay: this.state.resultsDisplay,\n            searchTerm: this.state.searchTerm\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 883,\n            columnNumber: 57\n          }, this) : null, this.state.mainDisplay === \"Landing\" ? /*#__PURE__*/_jsxDEV(Landing, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 884,\n            columnNumber: 55\n          }, this) : null, this.state.mainDisplay === \"UserLikes\" ? /*#__PURE__*/_jsxDEV(UserLikes, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 885,\n            columnNumber: 57\n          }, this) : null, this.state.mainDisplay === \"Loading\" ? /*#__PURE__*/_jsxDEV(LoadingPop, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 886,\n            columnNumber: 55\n          }, this) : null, this.state.mainDisplay === \"Results\" ? /*#__PURE__*/_jsxDEV(Results, {\n            Data: this.state.Data,\n            resultsDisplay: this.state.resultsDisplay,\n            reOrderDisplay: this.reOrderDisplay,\n            searchTerm: this.state.searchTerm,\n            search: this.handleChange,\n            togglePopUp: this.togglePopUp,\n            toggleSearchSettings: this.toggleSearchSettings,\n            gridView: this.state.gridView\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 887,\n            columnNumber: 55\n          }, this) : null]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 882,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 880,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 865,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/joseph/Code/lomav2/src/App.js"],"names":["React","SearchBar","Results","Landing","LoadingPop","PopUpListing","PopUpSearchSettings","PopUpLogSign","Sidebar","UserLikes","imagePlaceholder","hotjar","App","Component","constructor","props","state","Data","AccessToken","ExpiryDate","resultsDisplay","mainDisplay","gridView","filters","sites","ebay","trashnothing","etsy","facebook","gumtree","depop","range","min","max","searchTerm","landing","popUpListing","display","listing","popUpGeneral","popUpSearchSettings","maxResultPrice","depopData","data","nothing","status","gumtreeData","facebookData","handleChange","bind","setData","reOrderDisplay","togglePopUp","toggleLanding","changeActiveListing","toggleSearchSettings","setSiteFilters","toggleMainDisplay","componentDidMount","appLoaded","Date","now","getEbayAccessToken","console","log","myHeaders","Headers","append","urlencoded","URLSearchParams","requestOptions","method","headers","body","redirect","fetch","then","response","json","jsonresponse","setState","access_token","expires_in","accessTokenSet","catch","error","isNull","property","undefined","facebookPriceParsed","price","rawPrice","substring","includes","indexOf","isPriceNull","missingImagesFiltered","imageProp","getDepopData","depop_url","depopResponse","depopDataParsed","map","title","description","image","url","site","depopDataSetTime","getGumtreeData","gumtree_url","gumtreeResponse","gumtreeDataParsed","gumtreeDataSetTime","getFacebookData","facebook_url","facebookResponse","facebookDataParsed","facebookDataSetTime","newSearchTerm","eBayFilter","trashNothingFilter","etsyFilter","facebookFilter","gumtreeFilter","depopFilter","minRange","maxRange","sortOrder","prevState","highestPrice","reduce","current","item","Number","searchQuery","direction","currentActiveListingIndex","shuffleArray","array","i","length","j","Math","floor","random","temp","highest","a","b","lowest","sort","ebayPriceParsed","currency","convertedFromValue","value","tnmissingImagesFiltered","photos","eBayMissingImagesFiltered","hasOwnProperty","thumbnailImages","imageUrl","setEbayData","tokenResponse","jsonToken","accessToken","ebayHeaders","ebayrequestOptions","ebayresponse","ebayDataParsed","itemSummaries","shortDescription","itemWebUrl","setDepopData","depopDataFiltered","filter","toLowerCase","loading","setGumtreeData","gumtreeDataFiltered","setFacebookData","facebookDataFiltered","setEtsyData","etsyRaw","etsyJson","etsyDataResults","results","etsyData","etsyFirstImage","Images","url_570xN","setTrashNothingData","trashnothingRaw","tnJson","tnResults","posts","trashNothingData","content","alert","time","render"],"mappings":"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","sourcesContent":["import React from 'react';\nimport \"tailwindcss/tailwind.css\"\n\nimport { SearchBar } from './Components/SearchBar';\nimport { Results } from './Components/Results';\nimport { Landing } from './Components/Landing';\nimport { LoadingPop } from './Components/LoadingPop';\nimport { PopUpListing } from './Components/PopUpListing';\nimport { PopUpSearchSettings } from './Components/PopUpSearchSettings';\nimport { PopUpLogSign } from './Components/PopUpLogSign';\nimport { Sidebar } from './Components/Sidebar';\nimport { UserLikes } from './Components/UserLikes';\n\n\nimport imagePlaceholder from './assets/gallery.png';\n\nimport { hotjar } from 'react-hotjar';\n\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      Data: [],\n      AccessToken: \"none\",\n      ExpiryDate: 0,\n      resultsDisplay: \"⚡️ Trending ⚡️\",\n      mainDisplay: \"UserLikes\", // \"Results\"  //  \"Loading\" // \"UserLikes\" // \"Landing\"\n      gridView: \"Images Only\", // \"Image + Description\"\n      filters: {\n        sites: {\n          ebay: true,\n          trashnothing: true,\n          etsy: true,\n          facebook: true,\n          gumtree: true,\n          depop: true,\n        },\n        range: {\n          min: 0,\n          max: 100000000,\n        }\n      },\n      searchTerm: \"\",\n      landing: true,\n      popUpListing: {\n        display: false,\n        listing: {}\n      },\n      popUpGeneral: null, //\"PopUpLogSign\",\n      popUpSearchSettings: {\n        display: false,\n        maxResultPrice: 1000\n      },\n      depopData: {\n        data: [{nothing : \"none\"}],\n        status: 'unresolved'\n      },\n      gumtreeData: {\n        data: [{nothing : \"none\"}],\n        status: 'unresolved'\n      },\n      facebookData: {\n        data: [{nothing : \"none\"}],\n        status: 'unresolved'\n      }\n    }\n    this.handleChange = this.handleChange.bind(this);\n    this.setData = this.setData.bind(this);\n    this.reOrderDisplay = this.reOrderDisplay.bind(this);\n    this.togglePopUp = this.togglePopUp.bind(this);\n    this.toggleLanding = this.toggleLanding.bind(this);\n    this.changeActiveListing = this.changeActiveListing.bind(this);\n    this.toggleSearchSettings = this.toggleSearchSettings.bind(this);\n    this.setSiteFilters = this.setSiteFilters.bind(this);\n    this.toggleMainDisplay = this.toggleMainDisplay.bind(this);\n  }\n\n  componentDidMount() {\n  /////////FUNCTIONS AND CONSTANTS\n    const appLoaded = Date.now()\n    const getEbayAccessToken = () => {\n    if (Date.now() > this.state.ExpiryDate) {\n      console.log(\"this app does not have an access token, getting access token\")\n\n      var myHeaders = new Headers();\n      myHeaders.append(\"Authorization\", \"Basic Sm9zZXBoVW4tTG9tYS1QUkQtMTk5YWQwZDkwLWY0Y2QyYjg4OlBSRC05OWFkMGQ5MDRiYjEtZjYzMS00OGMyLTkwNTQtYTQ5Yg==\");\n      myHeaders.append(\"Content-Type\", \"application/x-www-form-urlencoded\");\n      myHeaders.append(\"Cookie\", \"ebay=%5Esbf%3D%23%5E; dp1=bu1p/QEBfX0BAX19AQA**6379634c^\");\n      \n      var urlencoded = new URLSearchParams();\n      urlencoded.append(\"grant_type\", \"client_credentials\");\n      urlencoded.append(\"scope\", \"https://api.ebay.com/oauth/api_scope\");\n      \n      var requestOptions = {\n        method: 'POST',\n        headers: myHeaders,\n        body: urlencoded,\n        redirect: 'follow'\n      };\n      \n      fetch(\"https://loma-cors.herokuapp.com/https://api.ebay.com/identity/v1/oauth2/token\", requestOptions)\n          .then(response => response.json())\n          .then(jsonresponse => {\n            this.setState({\n              AccessToken: jsonresponse.access_token,\n              ExpiryDate: Date.now() + jsonresponse.expires_in * 1000\n            })\n            let accessTokenSet = Date.now() - appLoaded;\n            console.log(`apiAccessToken = ${this.state.AccessToken}, took ${accessTokenSet} milliseconds`);\n          })\n          .catch(error => console.log('error', error));\n        } \n    }\n\n\n    ///////<DATA CLEANERS>\n    const isNull = (property) => {\n      if (property === null || property === undefined) {\n     return \" \";\n     } else {\n       return property;\n     }\n     };\n\n     const facebookPriceParsed = (price) => {\n      let rawPrice = price.substring(1);\n      if (!price || price === \"FREE\") {\n        return \"0\"\n      } else if (price === \"See listings near me\") {\n        return \"~\"\n      } else if (!rawPrice.includes(\"£\")){\n        return rawPrice;\n      } else if (rawPrice.includes(\"£\")) {\n        return rawPrice.substring(0, rawPrice.indexOf(\"£\"));\n      }\n    };\n     \n\n     const isPriceNull = (price) => {\n      if (price === undefined || price === null) {\n        return \"~\";\n      } else {\n        return price.substring(1)\n      }\n    };\n\n    const missingImagesFiltered = (imageProp) => {\n      if (imageProp === null || imageProp === undefined) {\n        return imagePlaceholder;\n      } else {\n        return imageProp;\n      }\n    }\n    ///////</DATA CLEANERS END>\n    const getDepopData = async () => {\n      console.log(\"getting depop data\")\n    \n    const depop_url = \"https://api.apify.com/v2/datasets/ml97NZifdmN1EFUSb/items?clean=true&format=json\";\n    const depopResponse = await fetch(depop_url);\n    const depopData = await depopResponse.json();\n\n    const depopDataParsed = await depopData.map(\n      (listing) => {\n        return {\n          title: isNull(listing.title),\n          price: isPriceNull(listing.price),\n          description: isNull(listing.description),\n          image: isNull(missingImagesFiltered(listing.image)),\n          url: isNull(listing.url),\n          site: \"depop\"\n        }\n      }\n    );\n\n    this.setState({\n      depopData : {\n        data: depopDataParsed,\n        status: 'resolved'\n      }\n    })\n\n    let depopDataSetTime = Date.now() - appLoaded\n\n    console.log(\"depop data has been set, it took this many milliseconds: \" + depopDataSetTime);\n\n    }\n\n///\n\n    const getGumtreeData = async () => {\n      console.log(\"getting gumtree data\")\n    \n      const gumtree_url = \"https://api.apify.com/v2/datasets/Dh5XzAb9fvidWw285/items?format=json&clean=1\"\n      const gumtreeResponse = await fetch(gumtree_url);\n      const gumtreeData = await gumtreeResponse.json();\n  \n      const gumtreeDataParsed = await gumtreeData.map(\n        listing => {\n          return {\n            title: listing.title,\n            price: listing.price.substring(1),\n            description: listing.description,\n            image: missingImagesFiltered(listing.image),\n            url: listing.url,\n            site: \"gumtree\"\n          }\n        }\n      )\n\n    this.setState({\n      gumtreeData : {\n        data: gumtreeDataParsed,\n        status: 'resolved'\n      }\n    })\n    let gumtreeDataSetTime = Date.now() - appLoaded\n\n    console.log(\"gumtree data has been set, it took this many milliseconds: \" + gumtreeDataSetTime);\n\n    }\n\n\n    ///\n\n    const getFacebookData = async () => {\n      console.log(\"getting facebook data\")\n    \n      const facebook_url = \"https://api.apify.com/v2/datasets/IitkxYE95yydtzFlk/items?clean=true&format=json\"\n      const facebookResponse = await fetch(facebook_url);\n      const facebookData = await facebookResponse.json();\n  \n      const facebookDataParsed = facebookData.map(\n        listing => {\n          return {\n            title: \"\" + isNull(listing.title),\n            price: \"\" + facebookPriceParsed(listing.price),\n            description: \"\" + isNull(listing.description),\n            image: \"\" + missingImagesFiltered(listing.image),\n            url: \"\" + isNull(listing.url),\n            site: \"facebook\"\n          }\n        }\n      )\n  \n  \n\n    this.setState({\n      facebookData : {\n        data: facebookDataParsed,\n        status: 'resolved'\n      }\n    })\n\n    let facebookDataSetTime = Date.now() - appLoaded\n\n    console.log(\"facebook data has been set, it took this many milliseconds: \" + facebookDataSetTime);\n\n    }\n\n\n    ///////\n    // getEbayAccessToken();\n    // getDepopData();\n    // getGumtreeData();\n    // getFacebookData();\n    // hotjar.initialize(2123002,6);\n    // console.log(\"access token\" +  this.state.AccessToken);\n    \n  } //COMPONENT MOUNT ENDS\n\n  toggleMainDisplay() {\n\n  }\n  async setSiteFilters(\n    newSearchTerm, \n    eBayFilter, \n    trashNothingFilter, \n    etsyFilter, \n    facebookFilter, \n    gumtreeFilter, \n    depopFilter, \n    minRange, \n    maxRange,\n    sortOrder,\n    gridView) {\n    await this.setState(prevState => ({\n      resultsDisplay: sortOrder,\n      gridView: gridView,\n      filters: {\n        sites: {\n          ebay: eBayFilter,\n          trashnothing: trashNothingFilter,\n          etsy: etsyFilter,\n          facebook: facebookFilter,\n          gumtree: gumtreeFilter,\n          depop: depopFilter,\n        },\n        range: {\n          min: minRange,\n          max: maxRange,\n        }\n      },\n      searchTerm: newSearchTerm,\n      popUpSearchSettings: {\n        display: !prevState.popUpSearchSettings.display,\n        maxResultPrice: prevState.popUpSearchSettings.maxResultPrice\n      }\n    })\n  )\n    console.log(this.state.filters)\n    this.setData(newSearchTerm)\n  }\n\n  async toggleSearchSettings() {\n    console.log(\"search settings toggled\")\n    if (this.state.popUpSearchSettings.display === true) {\n      await this.setState({\n        popUpSearchSettings: {\n          display: false\n        }\n      })\n    } else if (this.state.popUpSearchSettings.display === false) {\n\n      let highestPrice = await this.state.Data.reduce(function(current, item) {\n        if (item.price !== \"~\") {\n          return (current > Number(item.price) ? current : Number(item.price))\n        } else {\n          return item.price\n        }\n      }, 0)\n\n      console.log(highestPrice);\n      \n      this.setState({\n        popUpSearchSettings: {\n          display: true,\n          maxResultPrice: highestPrice\n        }\n      })\n\n    }\n  }\n\n\n  handleChange(searchQuery) {\n    this.setState({ searchTerm: searchQuery });\n    this.setData(searchQuery);\n\n  }\n\n  togglePopUp(listing) {\n    if (this.state.popUpListing.display === true ) {\n      this.setState({\n        popUpListing: {\n          display: false,\n          listing: {}\n        }\n      })\n    } else {\n      this.setState({\n        popUpListing: {\n          display: true,\n          listing: listing\n        }\n      })\n  }\n}  \n\nchangeActiveListing(listing, direction) {\n    let currentActiveListingIndex = this.state.Data.indexOf(listing);\n\n    if (direction === \"next\") {\n      this.setState((prevState) => ({\n        popUpListing: {\n          display: true,\n          listing: prevState.Data[currentActiveListingIndex + 1]\n        }\n      }))\n    } else if (direction === \"previous\" && currentActiveListingIndex > 0) {\n      this.setState((prevState) => ({\n        popUpListing: {\n          display: true,\n          listing: prevState.Data[currentActiveListingIndex - 1]\n        }\n      }))\n    } else {\n      return;\n    }\n    \n\n  }\n\n  toggleLanding() {\n    this.setState({\n      landing: true,\n    }) \n  }\n\n  async reOrderDisplay(sortOrder) {\n    /// functions\n    await this.setState({resultsDisplay: sortOrder});\n\n    function shuffleArray(array) {\n      for (var i = array.length - 1; i > 0; i--) {\n          var j = Math.floor(Math.random() * (i + 1));\n          var temp = array[i];\n          array[i] = array[j];\n          array[j] = temp;\n      }\n      return array;\n  }\n\n  function highest( a, b ) {\n    if ( Number(a.price) < Number(b.price) ){\n      return 1;\n    }\n    if ( Number(a.price) > Number(b.price) ){\n      return -1;\n    }\n    return 0;\n  }\n\n  function lowest( a, b ) {\n    if ( Number(a.price) < Number(b.price) ){\n      return -1;\n    }\n    if ( Number(a.price) > Number(b.price) ){\n      return 1;\n    }\n    return 0;\n  } \n\n\n  if (this.state.Data) {\n      if (this.state.resultsDisplay === \"⚡️ Trending ⚡️\") {\n        this.setState({Data: shuffleArray(this.state.Data)})\n      } else if (this.state.resultsDisplay === \"Highest price first ▲\") {\n        this.setState({Data: this.state.Data.sort(highest)})\n      } else if (this.state.resultsDisplay === \"Lowest price first ▼\") {\n        this.setState({Data: this.state.Data.sort(lowest)}) }\n        }\n  \n \n  }\n  \n\nsetData(searchQuery) {\n ///<Functions and constants\n\n function shuffleArray(array) {\n  for (var i = array.length - 1; i > 0; i--) {\n      var j = Math.floor(Math.random() * (i + 1));\n      var temp = array[i];\n      array[i] = array[j];\n      array[j] = temp;\n  }\n  return array;\n}\n\n const isNull = (property) => {\n  if (property === null || property === undefined) {\n  return \" \";\n  } else {\n    return property;\n  }\n};\n\nconst isPriceNull = (price) => {\n  if (price === undefined || price === null) {\n    return \"~\";\n  } else {\n    return price.substring(1)\n  }\n};\n\nconst ebayPriceParsed = (listing) => {\n  if (listing.price.currency === \"USD\") {\n    return listing.price.convertedFromValue ? listing.price.convertedFromValue : listing.price.value;\n  } else {\n    return listing.price.value;\n  }\n};\n\nconst facebookPriceParsed = (price) => {\n  let rawPrice = price.substring(1);\n  if (!price || price === \"FREE\") {\n    return \"0\"\n  } else if (price === \"See listings near me\") {\n    return \"~\"\n  } else if (!rawPrice.includes(\"£\")){\n    return rawPrice;\n  } else if (rawPrice.includes(\"£\")) {\n    return rawPrice.substring(0, rawPrice.indexOf(\"£\"));\n  }\n};\n\nconst missingImagesFiltered = (imageProp) => {\n  if (imageProp === null || imageProp === undefined) {\n    return imagePlaceholder;\n  } else {\n    return imageProp;\n  }\n}\n\nconst tnmissingImagesFiltered = (listing) => {\n  if (!listing.photos) {\n    return imagePlaceholder\n  } else {\n    return listing.photos[0].url;\n  }\n}\n\nconst eBayMissingImagesFiltered = (listing) => {\n  if (!listing.hasOwnProperty(\"image\") || !listing.image.hasOwnProperty(\"imageUrl\")) {\n    return imagePlaceholder;\n  } else {\n    return listing.thumbnailImages[0].imageUrl;\n  }\n}\n\n\n///<Data calls\n\nconst setEbayData = async () => {\n\n if (this.state.AccessToken === \"none\") {\n   console.log(\"this does not have an access token\")\n\n   var myHeaders = new Headers();\n    myHeaders.append(\"Authorization\", \"Basic Sm9zZXBoVW4tTG9tYS1QUkQtMTk5YWQwZDkwLWY0Y2QyYjg4OlBSRC05OWFkMGQ5MDRiYjEtZjYzMS00OGMyLTkwNTQtYTQ5Yg==\");\n    myHeaders.append(\"Content-Type\", \"application/x-www-form-urlencoded\");\n    myHeaders.append(\"Cookie\", \"ebay=%5Esbf%3D%23%5E; dp1=bu1p/QEBfX0BAX19AQA**6379634c^\");\n    \n    var urlencoded = new URLSearchParams();\n    urlencoded.append(\"grant_type\", \"client_credentials\");\n    urlencoded.append(\"scope\", \"https://api.ebay.com/oauth/api_scope\");\n    \n    var requestOptions = {\n      method: 'POST',\n      headers: myHeaders,\n      body: urlencoded,\n      redirect: 'follow'\n    };\n\n   const tokenResponse = await fetch(\"https://loma-cors.herokuapp.com/https://api.ebay.com/identity/v1/oauth2/token\", requestOptions);\n   const jsonToken = await tokenResponse.json();\n   const accessToken = jsonToken.access_token;\n\n   await this.setState({\n    AccessToken: accessToken,\n    ExpiryDate: Date.now() + accessToken.expires_in * 1000\n   })\n }\n  console.log(\"fetching ebay data\")\n  var ebayHeaders = new Headers();\n  ebayHeaders.append(\"Authorization\", `Bearer ${this.state.AccessToken}`);\n  ebayHeaders.append(\"Content-Type\", \"application/json\");\n  ebayHeaders.append(\"X-EBAY-C-MARKETPLACE-ID\", \"EBAY_US\");\n  ebayHeaders.append(\"X-EBAY-C-ENDUSERCTX\", \"affiliateCampaignId=<ePNCampaignId>,affiliateReferenceId=<referenceId>\");\n  \n  var ebayrequestOptions = {\n    method: 'GET',\n    headers: ebayHeaders,\n    redirect: 'follow'\n  };   \n\n  \n  const ebayresponse = await fetch(`https://loma-cors.herokuapp.com/https://api.ebay.com/buy/browse/v1/item_summary/search?q=${searchQuery}&limit=200&filter=price:[${this.state.filters.range.min}..${this.state.filters.range.max}],priceCurrency:GBP,conditions:{UNSPECIFIED|USED},itemLocationCountry:GB&fieldgroups=EXTENDED`, ebayrequestOptions);\n  const jsonresponse = await ebayresponse.json();\n  const ebayDataParsed = () => {\n    if (jsonresponse.itemSummaries) {\n        return jsonresponse.itemSummaries.map(\n          (listing) => {\n              return {\n                  title: isNull(listing.title),\n                  description: isNull(listing.shortDescription),\n                  price: isNull(ebayPriceParsed(listing)),\n                  image: eBayMissingImagesFiltered(listing),\n                  url: isNull(listing.itemWebUrl),\n                  site: \"ebay\"\n              }\n          }\n      )\n    } else { \n      return [];\n    }\n  }\n\n  this.setState(prevState => ({mainDisplay: \"Results\", Data: [...prevState.Data,...ebayDataParsed()]}));\n  this.reOrderDisplay(this.state.resultsDisplay)\n\n}\n\nconst setDepopData = async () => {\n  if (this.state.depopData.status === \"unresolved\") {\n    const depop_url = \"https://api.apify.com/v2/datasets/ml97NZifdmN1EFUSb/items?clean=true&format=json\";\n    const depopResponse = await fetch(depop_url);\n    const depopData = await depopResponse.json();\n    const depopDataFiltered = depopData.filter( (listing) => {\n      if (isNull(listing.title).toLowerCase().includes(this.state.searchTerm) && \n      listing.price >= this.state.filters.range.min &&\n      listing.price <= this.state.filters.range.max) {\n        return true;\n      } else if (isNull(listing.description).toLowerCase().includes(this.state.searchTerm) && \n      listing.price >= this.state.filters.range.min &&\n      listing.price <= this.state.filters.range.max) {\n        return true;\n      } else {\n        return false;\n      }\n    })\n    \n    const depopDataParsed = depopDataFiltered.map(\n      (listing) => {\n        return {\n          title: isNull(listing.title),\n          price: isPriceNull(listing.price),\n          description: isNull(listing.description),\n          image: isNull(missingImagesFiltered(listing.image)),\n          url: isNull(listing.url),\n          site: \"depop\"\n        }\n      }\n    )\n\n    this.setState({\n      depopData : {\n        data: depopDataParsed,\n        status: 'resolved'\n      }\n    });\n\n    this.setState(prevState => ({loading: false, Data: [...prevState.Data,...depopDataParsed]}));\n    this.reOrderDisplay(this.state.resultsDisplay)\n\n  } else if (this.state.depopData.status === \"resolved\") {\n    const depopDataFiltered = this.state.depopData.data.filter((listing) => {\n      if (isNull(listing.title).toLowerCase().includes(this.state.searchTerm) && \n          listing.price >= this.state.filters.range.min &&\n          listing.price <= this.state.filters.range.max) {\n        return true;\n      } else if (isNull(listing.description).toLowerCase().includes(this.state.searchTerm) && \n      listing.price >= this.state.filters.range.min &&\n      listing.price <= this.state.filters.range.max) {\n        return true;\n      } else {\n        return false;\n      }\n    });\n    this.setState(prevState => ({Data: [...prevState.Data,...depopDataFiltered]}));\n    this.reOrderDisplay(this.state.resultsDisplay)\n  }\n} \n\nconst setGumtreeData = async () => {\n\n      \n  if (this.state.gumtreeData.status === \"unresolved\") {\n    const gumtree_url = \"https://api.apify.com/v2/datasets/Dh5XzAb9fvidWw285/items?format=json&clean=1\"\n    const gumtreeResponse = await fetch(gumtree_url);\n    const gumtreeData = await gumtreeResponse.json();\n    const gumtreeDataFiltered = gumtreeData.filter( (listing) => {\n      if (isNull(listing.title).toLowerCase().includes(this.state.searchTerm) && \n      listing.price >= this.state.filters.range.min &&\n      listing.price <= this.state.filters.range.max) {\n        return true;\n      } else if (isNull(listing.description).toLowerCase().includes(this.state.searchTerm) && \n      listing.price >= this.state.filters.range.min &&\n      listing.price <= this.state.filters.range.max) {\n        return true;\n      } else {\n        return false;\n      }\n    })\n\n    const gumtreeDataParsed = gumtreeDataFiltered.map(\n      listing => {\n        return {\n          title: listing.title,\n          price: listing.price.substring(1),\n          description: listing.description,\n          image: missingImagesFiltered(listing.image),\n          url: listing.url,\n          site: \"gumtree\"\n        }\n      }\n    )\n\n    this.setState({\n      depopData : {\n        data: gumtreeDataParsed,\n        status: 'resolved'\n      }\n    });\n\n    this.setState(prevState => ({mainDisplay: \"Results\", Data: [...prevState.Data,...gumtreeDataFiltered]}));\n    this.reOrderDisplay(this.state.resultsDisplay)\n\n  } else {\n    const gumtreeDataFiltered = this.state.gumtreeData.data.filter( (listing) => {\n      if (isNull(listing.title).toLowerCase().includes(this.state.searchTerm) && \n      listing.price >= this.state.filters.range.min &&\n      listing.price <= this.state.filters.range.max) {\n        return true;\n      } else if (isNull(listing.description).toLowerCase().includes(this.state.searchTerm) && \n      listing.price >= this.state.filters.range.min &&\n      listing.price <= this.state.filters.range.max) {\n        return true;\n      } else {\n        return false;\n      }\n    })\n    this.setState(prevState => ({Data: [...prevState.Data,...gumtreeDataFiltered]}));\n    this.reOrderDisplay(this.state.resultsDisplay)\n    \n  }\n}\n\nconst setFacebookData = async () => {\n\n\n  if (this.state.facebookData.status === \"unresolved\") {\n    const facebook_url = \"https://api.apify.com/v2/datasets/IitkxYE95yydtzFlk/items?clean=true&format=json\"\n    const facebookResponse = await fetch(facebook_url);\n    const facebookData = await facebookResponse.json();\n    const facebookDataFiltered = facebookData.filter( (listing) => {\n      if (isNull(listing.title).toLowerCase().includes(this.state.searchTerm) && \n      listing.price >= this.state.filters.range.min &&\n      listing.price <= this.state.filters.range.max) {\n        return true;\n      } else if (isNull(listing.description).toLowerCase().includes(this.state.searchTerm) && \n      listing.price >= this.state.filters.range.min &&\n      listing.price <= this.state.filters.range.max) {\n        return true;\n      } else {\n        return false;\n      }\n    })\n\n    const facebookDataParsed = facebookDataFiltered.map(\n      listing => {\n        return {\n          title: \"\" + isNull(listing.title),\n          price: \"\" + facebookPriceParsed(listing.price),\n          description: \"\" + isNull(listing.description),\n          image: \"\" + missingImagesFiltered(listing.image),\n          url: \"\" + isNull(listing.url),\n          site: \"facebook\"\n        }\n      }\n    )\n\n    this.setState({\n      facebookData : {\n        data: facebookDataParsed,\n        status: 'resolved'\n      }\n    });\n    \n    this.setState(prevState => ({mainDisplay: \"Results\", Data: [...prevState.Data,...facebookDataFiltered]}));\n    this.reOrderDisplay(this.state.resultsDisplay)\n  } else {\n    const facebookDataFiltered = this.state.facebookData.data.filter( (listing) => {\n      if (isNull(listing.title).toLowerCase().includes(this.state.searchTerm) && \n      listing.price >= this.state.filters.range.min &&\n      listing.price <= this.state.filters.range.max) {\n        return true;\n      } else if (isNull(listing.description).toLowerCase().includes(this.state.searchTerm) && \n      listing.price >= this.state.filters.range.min &&\n      listing.price <= this.state.filters.range.max) {\n        return true;\n      } else {\n        return false;\n      }\n    })\n    this.setState(prevState => ({Data: [...prevState.Data,...facebookDataFiltered]}));\n    this.reOrderDisplay(this.state.resultsDisplay)\n  }\n}\n\nconst setEtsyData = async () => {\n\n  const etsyRaw = await fetch(`https://loma-cors.herokuapp.com/https://openapi.etsy.com/v2/listings/active?keywords=${searchQuery}&tags=vintage&limit=200&location=UK&api_key=sh1n3isgj6bax7eotlor7m4s&includes=Images&min_price=${this.state.filters.range.min}&max_price=${this.state.filters.range.max}&sort_on=score&sort_order=down`);\n  const etsyJson = await etsyRaw.json();\n  const etsyDataResults = etsyJson.results;\n  const etsyData = etsyDataResults.map( listing => {\n\n    let etsyFirstImage = listing.Images ? missingImagesFiltered(listing.Images[0].url_570xN) : imagePlaceholder\n    return {\n      title: listing.title,\n      price: listing.price,\n      description: listing.description,\n      image: etsyFirstImage,\n      url: listing.url,\n      site: \"etsy\"\n    }\n  });\n\n  this.setState(prevState => ({mainDisplay: \"Results\", Data: [...prevState.Data,...etsyData]}));\n  this.reOrderDisplay(this.state.resultsDisplay)\n}\n\nconst setTrashNothingData = async () => {\n\n  const trashnothingRaw = await fetch(`https://trashnothing.com/api/v1.2/posts/search?search=${searchQuery}&sort_by=relevance&types=offer&sources=trashnothing&per_page=50&page=4&device_pixel_ratio=1&latitude=51.507351&longitude=-0.127758&radius=200000&api_key=yr8sVaHEvbdkdunSFfPoDpqlwEjxIuqB3XhyFzx1`);\n  const tnJson = await trashnothingRaw.json();\n  const tnResults = tnJson.posts;\n  const trashNothingData = tnResults.map( listing => {\n    return {\n      title: listing.title,\n      price: 0,\n      description: listing.content,\n      image: tnmissingImagesFiltered(listing),\n      url: listing.url,\n      site: \"trashnothing\"\n    }\n  });\n\n  this.setState(prevState => ({mainDisplay: \"Results\", Data: [...prevState.Data,...trashNothingData]}));\n  this.reOrderDisplay(this.state.resultsDisplay)\n}\n\n///>Data calls\n////>Functions and constants\n\n  ///<Preliminary checks\n  if (!searchQuery) {\n    alert(\"Tell me what to search! 😁\");\n    return;\n  }\n\n  console.time(\"complete search\")\n  this.setState({Data: [], searchTerm: searchQuery.toLowerCase(), mainDisplay: \"Loading\"});\n  ///>Preliminary checks\n\n  ///<The Timeline\n  if (this.state.filters.sites.ebay) {\n    setEbayData(); \n  }\n\n  if (this.state.filters.sites.depop) {\n    setDepopData();\n  }\n\n  if (this.state.filters.sites.gumtree) {\n    setGumtreeData();\n  }\n\n  if (this.state.filters.sites.facebook) {\n    setFacebookData();\n  }\n\n  if (this.state.filters.sites.etsy) {\n    setEtsyData();\n  }\n\n  if (this.state.filters.sites.trashnothing) {\n    setTrashNothingData();\n  }\n  }\n\n  render() {\n    return (\n      <div className=\"max-w-screen-lg h-screen flex flex-row mx-auto border\">\n        {/* Top layer for popups */}\n        {this.state.popUpListing.display ? <PopUpListing changeActiveListing={this.changeActiveListing} display={this.state.popUpListing.display} listing={this.state.popUpListing.listing} togglePopUp={this.togglePopUp}/> : null}\n        {this.state.popUpSearchSettings.display ? \n                <PopUpSearchSettings \n                  toggleSearchSettings={this.toggleSearchSettings} \n                  filters={this.state.filters}\n                  maxResultPrice={this.state.popUpSearchSettings.maxResultPrice}\n                  searchTerm={this.state.searchTerm}\n                  display={this.state.resultsDisplay}\n                  gridView={this.state.gridView}\n                  setSiteFilters={this.setSiteFilters}\n                  /> : null}\n        {this.state.popUpGeneral === \"PopUpLogSign\" ? <PopUpLogSign/>: null}\n        {/* Top layer for popups ends */}\n        <div className=\"w-full flex flex-row\">\n          <div className=\"se:hidden sm:block\"><Sidebar /></div>\n          <div className=\"w-full h-full bg-white overflow-x-hidden z-0\">\n              {this.state.mainDisplay !== \"UserLikes\" ? <SearchBar onChange={this.handleChange} resultsDisplay={this.state.resultsDisplay} searchTerm={this.state.searchTerm}/> : null}\n              {this.state.mainDisplay === \"Landing\" ? <Landing /> : null}\n              {this.state.mainDisplay === \"UserLikes\" ? <UserLikes /> : null}\n              {this.state.mainDisplay === \"Loading\" ? <LoadingPop /> : null}\n              {this.state.mainDisplay === \"Results\" ? <Results Data={this.state.Data}\n                      resultsDisplay={this.state.resultsDisplay}\n                      reOrderDisplay={this.reOrderDisplay} \n                      searchTerm={this.state.searchTerm}\n                      search={this.handleChange}\n                      togglePopUp={this.togglePopUp}\n                      toggleSearchSettings={this.toggleSearchSettings}\n                      gridView={this.state.gridView} /> : null}\n          </div>\n        </div>\n      </div> \n    );\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}